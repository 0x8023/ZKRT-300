C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE 8023
OBJECT MODULE PLACED IN .\output\8023.obj
COMPILER INVOKED BY: D:\MyProgram\keil\C51\BIN\C51.EXE program\8023.c LARGE OPTIMIZE(8,SPEED) DEBUG OBJECTEXTEND PRINT(.
                    -\8023.lst) OBJECT(.\output\8023.obj)

line level    source

   1          #include "./output/8023.h"
   2          struct str_state str_begin,str_now,str_next;//åˆ†åˆ«ä¸º:èµ·å§‹çŠ¶æ€/å½“å‰çŠ¶æ€/ç›®æ ‡çŠ¶æ€
   3          struct str_parameter str_cod={
   4              /*ui str_cod.mlinerqd*/25000,//é»˜è®¤ä¸»å‡½æ•°å·¡çº¿è½¯èµ·åŠ¨è·¯ç¨‹ä¸º25000
   5              /*ui str_cod.mlineqc*/200,   //é»˜è®¤ä¸»å‡½æ•°å·¡çº¿å‰å†²æ—¶é—´ä¸º500æ¯«ç§’
   6          
   7              /*ui str_cod.sj1bzw*/58,     //å‡é™æ ‡å‡†ä½å»¶æ—¶
   8              /*ui str_cod.sj1zjw*/800,    //å‡é™ä¸­é—´ä½å»¶æ—¶
   9          
  10              /*ui str_cod.py1bz*/45,      //fun_pyæ ‡å‡†ä½å»¶æ—¶
  11              /*ui str_cod.py1qkq*/600,    //fun_pyå‰åˆ°é å‰å»¶æ—¶å‚æ•°
  12              /*ui str_cod.py1kqz*/525,    //fun_pyé å‰åˆ°ä¸­é—´å»¶æ—¶
  13              /*ui str_cod.py1zkh*/525,    //fun_pyä¸­é—´åˆ°é åå»¶æ—¶
  14              /*ui str_cod.py1khh*/540,    //fun_pyé ååˆ°åå»¶æ—¶
  15              /*ui str_cod.py1qz*/1155,    //fun_pyå‰åˆ°ä¸­é—´å»¶æ—¶
  16              /*ui str_cod.py1zh*/1090,    //fun_pyä¸­é—´åˆ°åå»¶æ—¶
  17              /*ui str_cod.py1kqkh*/1105,  //fun_pyé å‰åˆ°é åå»¶æ—¶
  18              /*ui str_cod.py1khkq*/1050,  //fun_pyé ååˆ°é å‰å»¶æ—¶
  19              /*ui str_cod.py1qkh*/1735,   //fun_pyå‰åˆ°é åå»¶æ—¶
  20              /*ui str_cod.py1kqh*/1635,   //fun_pyé å‰åˆ°åå»¶æ—¶
  21          
  22              /*ui str_cod.hz1bz*/20,      //fun_hzæ ‡å‡†ä½å»¶æ—¶
  23          
  24              /*ui turn90;*/500,           //90åº¦è½¬å¼¯å±è”½å»¶æ—¶
  25              /*ui turn180;*/2000          //180åº¦è½¬å¼¯å±è”½å»¶æ—¶
  26          };
  27          struct str_timerfolline str_tfl;
  28          data ul var_timer=0;
  29          void fun_delay(ui par_value,enum varENU_del par_model){
  30   1          data ui loc_con=par_value;
  31   1          switch(par_model){
  32   2              case del_us://å¾®ç§’çº§å»¶æ—¶
  33   2                  #ifdef Debug
                              printf("fun_delay(%d,del_us);\n",par_value);
                          #else
  36   2                      while(loc_con-->0){
  37   3                          _nop_();
  38   3                          _nop_();
  39   3                      }
  40   2                  #endif
  41   2                  return;
  42   2              case del_ms://æ¯«ç§’çº§å»¶æ—¶
  43   2                  #ifdef Debug
                              printf("fun_delay(%d,del_ms);\n",par_value);
                          #else
  46   2                      while(loc_con-->0){
  47   3                          data uc loc_i, loc_j;
  48   3                          _nop_();
  49   3                          _nop_();
  50   3                          loc_i=12;
  51   3                          loc_j=168;
  52   3                          do{
  53   4                              while(--loc_j);
  54   4                          }while(--loc_i);
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 2   

  55   3                      }
  56   2                  #endif
  57   2                  return;
  58   2              case del_s://ç§’çº§å»¶æ—¶
  59   2                  #ifdef Debug
                              printf("fun_delay(%d,del_s);\n",par_value);
                          #else
  62   2                      while(loc_con-->0){
  63   3                          data uc loc_i, loc_j, loc_k;
  64   3                          loc_i=46;
  65   3                          loc_j=153;
  66   3                          loc_k=245;
  67   3                          do{
  68   4                              do{
  69   5                                  while(--loc_k);
  70   5                              }while(--loc_j);
  71   4                          }while(--loc_i);
  72   3                      }
  73   2                  #endif
  74   2                  return;
  75   2              default:return;
  76   2          }
  77   1      }//å»¶æ—¶
  78          void fun_timer0init(){
  79   1          #ifdef Debug
                      printf("fun_timer0init();\n");
                  #endif
  82   1          AUXR|=0x80;   //å®šæ—¶å™¨æ—¶é’Ÿ1Tæ¨¡å¼
  83   1          TMOD&=0xF0;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  84   1          TMOD|=0x01;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  85   1          TL0=0x20;     //å®šæ—¶åˆå€¼:1ms
  86   1          TH0=0xD1;     //å®šæ—¶åˆå€¼:1ms
  87   1          TF0=0;        //æ¸…é™¤TF0æ ‡å¿—
  88   1          ET0=1;
  89   1          EA=1;         //å¼€å¯æ€»ä¸­æ–­
  90   1      }//1æ¯«ç§’å®šæ—¶å™¨0åˆå§‹åŒ–
  91          void fun_timer1init(){
  92   1          #ifdef Debug
                      printf("fun_timer1init();\n");
                  #endif
  95   1          AUXR&=0xBF;     //å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
  96   1          TMOD&=0x0F;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  97   1          TMOD|=0x10;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  98   1          TL1=0xE0;       //å®šæ—¶åˆå€¼:20ms
  99   1          TH1=0xB1;       //å®šæ—¶åˆå€¼:20ms
 100   1          TF1=0;          //æ¸…é™¤TF1æ ‡å¿—
 101   1          ET1=1;
 102   1          EA=1;           //å¼€å¯æ€»ä¸­æ–­
 103   1      }//20æ¯«ç§’å®šæ—¶å™¨1åˆå§‹åŒ–
 104          void fun_timer0(){
 105   1          TL0=0x20;
 106   1          TH0=0xD1;//å®šæ—¶å™¨åˆå€¼æ¢å¤è‡³1ms
 107   1          var_timer++;//å…¨å±€è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶
 108   1          if(str_tfl.doing==tf_ture)//å¦‚æœæ­£åœ¨ç§»åŠ¨
 109   1              fun_timermove();//å®šæ—¶å™¨ç§»åŠ¨
 110   1      }//1æ¯«ç§’å®šæ—¶å™¨0å¤„ç†å‡½æ•°
 111          void fun_timer1(){
 112   1          TL1=0xE0;
 113   1          TH1=0xB1;
 114   1      }//20æ¯«ç§’å®šæ—¶å™¨1å¤„ç†å‡½æ•°
 115          void fun_wait(){
 116   1          #ifdef Debug
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 3   

                      printf("fun_wait();\n");
                  #else
 119   1              while(in_start==1);
 120   1              fun_delay(20,del_ms);
 121   1              while(in_start==0);
 122   1              fun_delay(256,del_ms);
 123   1          #endif
 124   1      }//ç­‰å¾…æŒ‰é”®
 125          void fun_pwminit(){
 126   1          #ifdef Debug
                      printf("fun_pwminit();\n");
                  #endif
 129   1          CCON=0x00;//PACå¯„å­˜æ§åˆ¶å™¨
 130   1          CH=0;//é‡ç½®PACè®¡æ—¶å™¨
 131   1          CL=0;
 132   1          CMOD=0x08;//ä¸åˆ†é¢‘
 133   1      }//PWMåˆå§‹åŒ–
 134          void fun_pwmr(uc par_value){
 135   1          CCAP0H=CCAP0L=par_value*25/10;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 136   1          CCAPM0=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 137   1          PCA_PWM0=0x00;
 138   1      }//å³è·¯PWMè¾“å‡º
 139          void fun_pwml(uc par_value){
 140   1          CCAP1H=CCAP1L=par_value*25/10;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 141   1          CCAPM1=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 142   1          PCA_PWM1=0x00;
 143   1      }//å·¦è·¯PWMè¾“å‡º
 144          void fun_motors(enum varENU_mot par_model,char par_speed){
 145   1          if(par_speed>100)
 146   1              par_speed=100;
 147   1          else if(par_speed<-100)
 148   1              par_speed=-100;//é€Ÿåº¦æœ€å¤š100,æœ€å°‘-100
 149   1          switch(par_model){
 150   2              case mot_l://å·¦è½®ç”µæœº
 151   2                  if(str_begin.leftsd==par_speed)
 152   2                      return;
 153   2                  else
 154   2                      str_begin.leftsd=par_speed;
 155   2                  if(par_speed==0){
 156   3                      fun_pwml(0);out_pwml=0;
 157   3                  }
 158   2                  else if(par_speed>0){
 159   3                      CR=1;fun_pwml(par_speed);out_pwml=0;
 160   3                  }
 161   2                  else if(par_speed<0){
 162   3                      CR=1;fun_pwml(cabs(par_speed));out_pwml=1;
 163   3                  }
 164   2                  break;
 165   2              case mot_r://å³è½®ç”µæœº
 166   2                  if(str_begin.rightsd==par_speed)
 167   2                      return;
 168   2                  else
 169   2                      str_begin.rightsd=par_speed;
 170   2                  if(par_speed==0){
 171   3                      fun_pwmr(0);out_pwmr=0;
 172   3                  }
 173   2                  else if(par_speed>0){
 174   3                      CR=1;fun_pwmr(par_speed);out_pwmr=0;
 175   3                  }
 176   2                  else if(par_speed<0){
 177   3                      CR=1;fun_pwmr(cabs(par_speed));out_pwmr=1;
 178   3                  }
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 4   

 179   2                  break;
 180   2              case mot_rl://å·¦å³è½®åŒæ­¥
 181   2                  if((str_begin.leftsd==par_speed)&&(str_begin.rightsd==par_speed))
 182   2                      return;
 183   2                  else
 184   2                      str_begin.leftsd=str_begin.rightsd=par_speed;
 185   2                  if(par_speed==0){
 186   3                      CR=0;
 187   3                      fun_pwmr(0);out_pwmr=0;
 188   3                      fun_pwml(0);out_pwml=0;
 189   3                  }
 190   2                  else if(par_speed>0){
 191   3                      CR=1;
 192   3                      fun_pwml(par_speed);out_pwml=0;
 193   3                      fun_pwmr(par_speed);out_pwmr=0;
 194   3                  }
 195   2                  else if(par_speed<0){
 196   3                      CR=1;
 197   3                      fun_pwml(cabs(par_speed));out_pwml=1;
 198   3                      fun_pwmr(cabs(par_speed));out_pwmr=1;
 199   3                  }
 200   2                  break;
 201   2              case mot_sz://æ­£è½¬ä¸ºæŠ“ç´§ï¼Œåè½¬ä¸ºæ¾å¼€
 202   2                  if(str_begin.szsd==par_speed)
 203   2                      return;
 204   2                  else
 205   2                      str_begin.szsd=par_speed;
 206   2                  if(par_speed==0){
 207   3                      out_motorselect=1;out_dir1=0;out_en1=1;
 208   3                  }
 209   2                  else if(par_speed>0){
 210   3                      out_motorselect=1;out_dir1=1;out_en1=0;
 211   3                  }
 212   2                  else if(par_speed<0){
 213   3                      out_motorselect=1;out_dir1=0;out_en1=0;
 214   3                  }
 215   2                  break;
 216   2              case mot_py://æ­£è½¬æ˜¯å‘æ— ç”µæœºä¸€æ–¹è½¬,åè½¬ä¸ºå‘æœ‰ç”µæœºä¸€æ–¹è½¬
 217   2                  if(str_begin.pysd==par_speed)
 218   2                      return;
 219   2                  else
 220   2                      str_begin.pysd=par_speed;
 221   2                  if(par_speed==0){
 222   3                      out_motorselect=1;out_dir2=0;out_en2=1;
 223   3                  }
 224   2                  else if(par_speed>0){
 225   3                      out_motorselect=1;out_dir2=1;out_en2=0;
 226   3                  }
 227   2                  else if(par_speed<0){
 228   3                      out_motorselect=1;out_dir2=0;out_en2=0;
 229   3                  }
 230   2                  break;
 231   2              case mot_sj://å‘ä¸Šä¸ºæ­£è½¬,å‘ä¸‹ä¸ºåè½¬
 232   2                  if(str_begin.sjsd==par_speed)
 233   2                      return;
 234   2                  else
 235   2                      str_begin.sjsd=par_speed;
 236   2                  if(par_speed==0){
 237   3                      out_motorselect=0;out_dir1=0;out_en1=1;
 238   3                  }
 239   2                  else if(par_speed>0){
 240   3                      out_motorselect=0;out_dir1=0;out_en1=0;
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 5   

 241   3                  }
 242   2                  else if(par_speed<0){
 243   3                      out_motorselect=0;out_dir1=1;out_en1=0;
 244   3                  }
 245   2                  break;
 246   2              case mot_hz://é¡ºæ—¶é’ˆä¸ºæ­£è½¬,é€†æ—¶é’ˆä¸ºåè½¬
 247   2                  if(str_begin.hzsd==par_speed)
 248   2                      return;
 249   2                  else
 250   2                      str_begin.hzsd=par_speed;
 251   2                  if(par_speed==0){
 252   3                      out_motorselect=0;out_dir2=0;out_en2=1;
 253   3                  }
 254   2                  else if(par_speed>0){
 255   3                      out_motorselect=0;out_dir2=0;out_en2=0;
 256   3                  }
 257   2                  else if(par_speed<0){
 258   3                      out_motorselect=0;out_dir2=1;out_en2=0;
 259   3                  }
 260   2                  break;
 261   2              default:
 262   2                  break;
 263   2          }
 264   1      }//ä¸»å‡½æ•°æ“ä½œç”µæœº
 265          void fun_motorsrl(enum varENU_mot par_model,char par_speed){
 266   1          if(par_speed>100)
 267   1              par_speed=100;
 268   1          else if(par_speed<-100)
 269   1              par_speed=-100;//é€Ÿåº¦æœ€å¤š100,æœ€å°‘-100
 270   1          switch(par_model){
 271   2              case mot_l://å·¦è½®ç”µæœº
 272   2                  if(str_begin.leftsd==par_speed)
 273   2                      return;
 274   2                  else
 275   2                      str_begin.leftsd=par_speed;
 276   2                  if(par_speed==0){
 277   3                      fun_pwml(0);out_pwml=0;
 278   3                  }
 279   2                  else if(par_speed>0){
 280   3                      CR=1;fun_pwml(par_speed);out_pwml=0;
 281   3                  }
 282   2                  else if(par_speed<0){
 283   3                      CR=1;fun_pwml(cabs(par_speed));out_pwml=1;
 284   3                  }
 285   2                  break;
 286   2              case mot_r://å³è½®ç”µæœº
 287   2                  if(str_begin.rightsd==par_speed)
 288   2                      return;
 289   2                  else
 290   2                      str_begin.rightsd=par_speed;
 291   2                  if(par_speed==0){
 292   3                      fun_pwmr(0);out_pwmr=0;
 293   3                  }
 294   2                  else if(par_speed>0){
 295   3                      CR=1;fun_pwmr(par_speed);out_pwmr=0;
 296   3                  }
 297   2                  else if(par_speed<0){
 298   3                      CR=1;fun_pwmr(cabs(par_speed));out_pwmr=1;
 299   3                  }
 300   2                  break;
 301   2              case mot_rl://å·¦å³è½®åŒæ­¥
 302   2                  if((str_begin.leftsd==par_speed)&&(str_begin.rightsd==par_speed))
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 6   

 303   2                      return;
 304   2                  else
 305   2                      str_begin.leftsd=str_begin.rightsd=par_speed;
 306   2                  if(par_speed==0){
 307   3                      CR=0;
 308   3                      fun_pwmr(0);out_pwmr=0;
 309   3                      fun_pwml(0);out_pwml=0;
 310   3                  }
 311   2                  else if(par_speed>0){
 312   3                      CR=1;
 313   3                      fun_pwml(par_speed);out_pwml=0;
 314   3                      fun_pwmr(par_speed);out_pwmr=0;
 315   3                  }
 316   2                  else if(par_speed<0){
 317   3                      CR=1;
 318   3                      fun_pwml(cabs(par_speed));out_pwml=1;
 319   3                      fun_pwmr(cabs(par_speed));out_pwmr=1;
 320   3                  }
 321   2                  break;
 322   2              default:
 323   2                  break;
 324   2          }
 325   1      }//å®šæ—¶å™¨æ“ä½œå·¦å³è½®
 326          void fun_sz(enum varENU_han par_model){
 327   1          if(str_begin.szzt==par_model)
 328   1              return;
 329   1          if(par_model==han_s){//æ‰‹æŠ“æ¾
 330   2              #ifdef Debug
                          printf("fun_sz(han_s);\n");
                      #else
 333   2                  fun_motors(mot_sz,-100);
 334   2                  while(in_s==1);
 335   2              #endif
 336   2          }
 337   1          else{//æ‰‹æŠ“ç´§
 338   2              #ifdef Debug
                          printf("fun_sz(han_j);\n");
                      #else
 341   2                  fun_motors(mot_sz,100);
 342   2                  while(in_j==1);
 343   2              #endif
 344   2          }
 345   1              fun_delay(20,del_ms);
 346   1              fun_motors(mot_sz,0);
 347   1          str_begin.szzt=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 348   1      }//æ‰‹æŠ“å•æ­¥è¿åŠ¨
 349          void fun_py(enum varENU_tra par_model){
 350   1          if(str_begin.pywz==par_model)
 351   1              return;
 352   1          switch(par_model){
 353   2              case tra_q://å‰å¹³ç§»(æ²¡æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 354   2                  #ifdef Debug
                              printf("fun_py(tra_q);\n");
                          #else
 357   2                      fun_motors(mot_py,100);
 358   2                      while(in_qpy==1);
 359   2                      fun_delay(str_cod.py1bz,del_ms);
 360   2                  #endif
 361   2                      break;
 362   2              case tra_kq://é å‰å¹³ç§»
 363   2                  #ifdef Debug
                              printf("fun_py(tra_kq);\n");
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 7   

                          #else
 366   2                      switch(str_begin.pywz){
 367   3                          case tra_q://ç°åœ¨åœ¨å‰é¢
 368   3                              fun_motors(mot_py,-100);
 369   3                              fun_delay(str_cod.py1qkq,del_ms);
 370   3                              break;
 371   3                          case tra_z://ç°åœ¨åœ¨ä¸­é—´
 372   3                              fun_motors(mot_py,100);
 373   3                              fun_delay(str_cod.py1kqz,del_ms);
 374   3                              break;
 375   3                          case tra_kh://ç°åœ¨åœ¨é å
 376   3                              fun_motors(mot_py,100);
 377   3                              fun_delay(str_cod.py1khkq,del_ms);
 378   3                              break;
 379   3                          case tra_h://ç°åœ¨åœ¨å
 380   3                              fun_motors(mot_py,100);
 381   3                              fun_delay(str_cod.py1kqh,del_ms);
 382   3                              break;
 383   3                      }
 384   2                  #endif
 385   2                      break;
 386   2              case tra_z://å¹³ç§»åˆ°ä¸­é—´
 387   2                  #ifdef Debug
                              printf("fun_py(tra_z);\n");
                          #else
 390   2                      switch(str_begin.pywz){
 391   3                          case tra_q://ç°åœ¨åœ¨å‰é¢
 392   3                              fun_motors(mot_py,-100);
 393   3                              fun_delay(str_cod.py1qz,del_ms);
 394   3                              break;
 395   3                          case tra_kq://ç°åœ¨åœ¨é å‰
 396   3                              fun_motors(mot_py,-100);
 397   3                              fun_delay(str_cod.py1kqz,del_ms);
 398   3                              break;
 399   3                          case tra_kh://ç°åœ¨åœ¨é å
 400   3                              fun_motors(mot_py,100);
 401   3                              fun_delay(str_cod.py1zkh,del_ms);
 402   3                              break;
 403   3                          case tra_h://ç°åœ¨åœ¨åé¢
 404   3                              fun_motors(mot_py,100);
 405   3                              fun_delay(str_cod.py1zh,del_ms);
 406   3                              break;
 407   3                      }
 408   2                  #endif
 409   2                      break;
 410   2              case tra_kh://å¹³ç§»åˆ°é å
 411   2                  #ifdef Debug
                              printf("fun_py(tra_kh);\n");
                          #else
 414   2                      switch(str_begin.pywz){
 415   3                          case tra_q://ç°åœ¨åœ¨å‰é¢
 416   3                              fun_motors(mot_py,-100);
 417   3                              fun_delay(str_cod.py1qkh,del_ms);
 418   3                              break;
 419   3                          case tra_kq://ç°åœ¨åœ¨é å‰
 420   3                              fun_motors(mot_py,-100);
 421   3                              fun_delay(str_cod.py1kqkh,del_ms);
 422   3                              break;
 423   3                          case tra_z://ç°åœ¨åœ¨ä¸­é—´
 424   3                              fun_motors(mot_py,-100);
 425   3                              fun_delay(str_cod.py1zkh,del_ms);
 426   3                              break;
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 8   

 427   3                          case tra_h://ç°åœ¨åœ¨åé¢
 428   3                              fun_motors(mot_py,100);
 429   3                              fun_delay(str_cod.py1khh,del_ms);
 430   3                              break;
 431   3                      }
 432   2                  #endif
 433   2                      break;
 434   2              case tra_h://åå¹³ç§»(æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 435   2                  #ifdef Debug
                              printf("fun_py(tra_h);\n");
                          #else
 438   2                      fun_motors(mot_py,-100);
 439   2                      while(in_hpy==1);
 440   2                      fun_delay(str_cod.py1bz,del_ms);
 441   2                  #endif
 442   2                      break;
 443   2              default:
 444   2                  break;
 445   2          }
 446   1          fun_motors(mot_py,0);
 447   1          str_begin.pywz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 448   1      }//å¹³ç§»å•æ­¥è¿åŠ¨
 449          void fun_sj(enum varENU_sjp par_model){
 450   1          if(str_begin.sjwz==par_model)
 451   1             return;
 452   1          def_select(sel_58)
 453   1          switch(par_model){
 454   2              case sjp_1://å‡é™ä½ç½®1(æœ€ä¸Šä½)
 455   2                  #ifdef Debug
                              printf("fun_sj(sjp_1);\n");
                          #else
 458   2                      fun_motors(mot_sj,100);
 459   2                      def_select(sel_58);
 460   2                      while(in_wz1==1);
 461   2                      fun_delay(str_cod.sj1bzw,del_ms);
 462   2                  #endif
 463   2                      break;
 464   2              case sjp_12:
 465   2                  #ifdef Debug
                              printf("fun_sj(sjp_12);\n");
                          #else
 468   2                      if(par_model>str_begin.sjwz){
 469   3                          fun_motors(mot_sj,-100);
 470   3                          fun_delay(str_cod.sj1zjw,del_ms);
 471   3                      }
 472   2                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 473   3                          fun_sj(sjp_2);
 474   3                          fun_motors(mot_sj,100);
 475   3                          fun_delay(str_cod.sj1zjw,del_ms);
 476   3                      }
 477   2                  #endif
 478   2                      break;
 479   2              case sjp_2://å‡é™ä½ç½®2
 480   2                  #ifdef Debug
                              printf("fun_sj(sjp_2);\n");
                          #else
 483   2                      fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 484   2                      def_select(sel_58);
 485   2                      while(in_wz2==1);
 486   2                      fun_delay(str_cod.sj1bzw,del_ms);
 487   2                  #endif
 488   2                      break;
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 9   

 489   2              case sjp_23:
 490   2                  #ifdef Debug
                              printf("fun_sj(sjp_23);\n");
                          #else
 493   2                      if(par_model>str_begin.sjwz){
 494   3                          fun_sj(sjp_2);
 495   3                          fun_motors(mot_sj,-100);
 496   3                          fun_delay(str_cod.sj1zjw,del_ms);
 497   3                      }
 498   2                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 499   3                          fun_sj(sjp_3);
 500   3                          fun_motors(mot_sj,100);
 501   3                          fun_delay(str_cod.sj1zjw,del_ms);
 502   3                      }
 503   2                  #endif
 504   2                      break;
 505   2              case sjp_3://å‡é™ä½ç½®3
 506   2                  #ifdef Debug
                              printf("fun_sj(sjp_3);\n");
                          #else
 509   2                      fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 510   2                      def_select(sel_58);
 511   2                      while(in_wz3==1);
 512   2                      fun_delay(str_cod.sj1bzw,del_ms);
 513   2                  #endif
 514   2                  break;
 515   2              case sjp_34:
 516   2                  #ifdef Debug
                              printf("fun_sj(sjp_34);\n");
                          #else
 519   2                      if(par_model>str_begin.sjwz){
 520   3                          fun_sj(sjp_3);
 521   3                          fun_motors(mot_sj,-100);
 522   3                          fun_delay(str_cod.sj1zjw,del_ms);
 523   3                      }
 524   2                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 525   3                          fun_sj(sjp_4);
 526   3                          fun_motors(mot_sj,100);
 527   3                          fun_delay(str_cod.sj1zjw,del_ms);
 528   3                      }
 529   2                  #endif
 530   2                      break;
 531   2              case sjp_4://å‡é™ä½ç½®4
 532   2                  #ifdef Debug
                              printf("fun_sj(sjp_4);\n");
                          #else
 535   2                      fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 536   2                      def_select(sel_58);
 537   2                      while(in_wz4==1);
 538   2                      fun_delay(str_cod.sj1bzw,del_ms);
 539   2                  #endif
 540   2                      break;
 541   2              case sjp_45:
 542   2                  #ifdef Debug
                              printf("fun_sj(sjp_45);\n");
                          #else
 545   2                      if(par_model>str_begin.sjwz){
 546   3                          fun_sj(sjp_4);
 547   3                          fun_motors(mot_sj,-100);
 548   3                          fun_delay(str_cod.sj1zjw,del_ms);
 549   3                      }
 550   2                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 10  

 551   3                          fun_motors(mot_sj,100);
 552   3                          fun_delay(str_cod.sj1zjw,del_ms);
 553   3                      }
 554   2                  #endif
 555   2                      break;
 556   2              case sjp_5://å‡é™ä½ç½®5
 557   2                  #ifdef Debug
                              printf("fun_sj(sjp_5);\n");
                          #else
 560   2                      fun_motors(mot_sj,-100);
 561   2                      def_select(sel_912);
 562   2                      while(in_wz5==1);
 563   2                      fun_delay(str_cod.sj1bzw,del_ms);
 564   2                  #endif
 565   2                      break;
 566   2              default:
 567   2                  break;
 568   2          }
 569   1          fun_motors(mot_sj,0);
 570   1          str_begin.sjwz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 571   1      }//å‡é™å•æ­¥è¿åŠ¨
 572          void fun_hz(enum varENU_dir par_model){
 573   1          if(str_begin.hzfx==par_model)
 574   1              return;
 575   1          def_select(sel_912);
 576   1          switch(par_model){
 577   2              case dir_up://å›è½¬è‡³å‰æ–¹
 578   2                  #ifdef Debug
                              printf("fun_hz(dir_up);\n");
                          #else
 581   2                      switch(str_begin.hzfx){
 582   3                          case dir_down://ç°åœ¨åœ¨ä¸‹æ–¹
 583   3                              fun_motors(mot_hz,-100);
 584   3                              fun_delay(1,del_s);
 585   3                              while(in_hz==1);
 586   3                              while(in_hz==0);
 587   3                              while(in_hz==1);
 588   3                              fun_delay(str_cod.hz1bz,del_ms);
 589   3                              break;
 590   3                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 591   3                              fun_motors(mot_hz,100);
 592   3                              fun_delay(1,del_s);
 593   3                              while(in_hz==1);
 594   3                              fun_delay(str_cod.hz1bz,del_ms);
 595   3                              break;
 596   3                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 597   3                              fun_motors(mot_hz,-100);
 598   3                              fun_delay(1,del_s);
 599   3                              while(in_hz==1);
 600   3                              fun_delay(str_cod.hz1bz,del_ms);
 601   3                              break;
 602   3                          default:
 603   3                              break;
 604   3                      }
 605   2                  #endif
 606   2                      break;
 607   2              case dir_down://è¦å»ä¸‹é¢
 608   2                  #ifdef Debug
                              printf("fun_hz(dir_down);\n");
                          #else
 611   2                      switch(str_begin.hzfx){
 612   3                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 11  

 613   3                              fun_motors(mot_hz,100);
 614   3                              fun_delay(1,del_s);
 615   3                              while(in_hz==1);
 616   3                              while(in_hz==0);
 617   3                              while(in_hz==1);
 618   3                              fun_delay(str_cod.hz1bz,del_ms);
 619   3                              break;
 620   3                          case dir_left://ç°åœ¨åœ¨å·¦é¢
 621   3                              fun_motors(mot_hz,-100);
 622   3                              fun_delay(1,del_s);
 623   3                              while(in_hz==1);
 624   3                              fun_delay(str_cod.hz1bz,del_ms);
 625   3                              break;
 626   3                          case dir_right://ç°åœ¨åœ¨å³é¢
 627   3                              fun_motors(mot_hz,100);
 628   3                              fun_delay(1,del_s);
 629   3                              while(in_hz==1);
 630   3                              fun_delay(str_cod.hz1bz,del_ms);
 631   3                              break;
 632   3                          default:
 633   3                              break;
 634   3                      }
 635   2                  #endif
 636   2                      break;
 637   2              case dir_left://è¦å»å·¦è¾¹
 638   2                  #ifdef Debug
                              printf("fun_hz(dir_left);\n");
                          #else
 641   2                      switch(str_begin.hzfx){
 642   3                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 643   3                              fun_motors(mot_hz,-100);
 644   3                              fun_delay(1,del_s);
 645   3                              while(in_hz==1);
 646   3                              fun_delay(str_cod.hz1bz,del_ms);
 647   3                              break;
 648   3                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 649   3                              fun_motors(mot_hz,100);
 650   3                              fun_delay(1,del_s);
 651   3                              while(in_hz==1);
 652   3                              fun_delay(str_cod.hz1bz,del_ms);
 653   3                              break;
 654   3                          case dir_right://ç°åœ¨åœ¨å³é¢
 655   3                              fun_motors(mot_hz,-100);
 656   3                              fun_delay(1,del_s);
 657   3                              while(in_hz==1);
 658   3                              while(in_hz==0);
 659   3                              while(in_hz==1);
 660   3                              fun_delay(str_cod.hz1bz,del_ms);
 661   3                              break;
 662   3                          default:
 663   3                              break;
 664   3                      }
 665   2                  #endif
 666   2                      break;
 667   2              case dir_right://è¦å»å³é¢
 668   2                  #ifdef Debug
                              printf("fun_hz(dir_right);\n");
                          #else
 671   2                      switch(str_begin.hzfx){
 672   3                          case dir_up://ç°åœ¨åœ¨å‰é¢
 673   3                              fun_motors(mot_hz,100);
 674   3                              fun_delay(1,del_s);
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 12  

 675   3                              while(in_hz==1);
 676   3                              fun_delay(str_cod.hz1bz,del_ms);
 677   3                              break;
 678   3                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 679   3                              fun_motors(mot_hz,-100);
 680   3                              fun_delay(1,del_s);
 681   3                              while(in_hz==1);
 682   3                              fun_delay(str_cod.hz1bz,del_ms);
 683   3                              break;
 684   3                          case dir_left://ç°åœ¨åœ¨å·¦é¢
 685   3                              fun_motors(mot_hz,100);
 686   3                              fun_delay(1,del_s);
 687   3                              while(in_hz==1);
 688   3                              while(in_hz==0);
 689   3                              while(in_hz==1);
 690   3                              fun_delay(str_cod.hz1bz,del_ms);
 691   3                              break;
 692   3                          default:
 693   3                              break;
 694   3                      }
 695   2                  #endif
 696   2                      break;
 697   2              default:
 698   2                  break;
 699   2          }
 700   1          fun_motors(mot_hz,0);
 701   1          str_begin.hzfx=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 702   1      }//å›è½¬å•æ­¥è¿åŠ¨
 703          void fun_pyhz(enum varENU_tra par_pymodel,enum varENU_dir par_hzmodel){
 704   1          switch(par_hzmodel){//è·å–æƒ³è¦åˆ°è¾¾çš„å›è½¬ä½ç½®
 705   2              case dir_left://è¦å»å·¦è¾¹
 706   2                  switch(str_begin.hzfx){
 707   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 708   3                          fun_motors(mot_hz,-100);
 709   3                          break;
 710   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 711   3                          fun_motors(mot_hz,-100);
 712   3                          break;
 713   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 714   3                          fun_motors(mot_hz,100);
 715   3                          break;
 716   3                      default:
 717   3                          break;
 718   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 719   2                  break;
 720   2              case dir_right://è¦å»å³è¾¹
 721   2                  switch(str_begin.hzfx){
 722   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 723   3                          fun_motors(mot_hz,100);
 724   3                          break;
 725   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 726   3                          fun_motors(mot_hz,100);
 727   3                          break;
 728   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 729   3                          fun_motors(mot_hz,-100);
 730   3                          break;
 731   3                      default:
 732   3                          break;
 733   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 734   2                  break;
 735   2              case dir_up://è¦å»ä¸Šé¢
 736   2                  switch(str_begin.hzfx){
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 13  

 737   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 738   3                          fun_motors(mot_hz,100);
 739   3                          break;
 740   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 741   3                          fun_motors(mot_hz,-100);
 742   3                          break;
 743   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 744   3                          fun_motors(mot_hz,-100);
 745   3                          break;
 746   3                      default:
 747   3                          break;
 748   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 749   2                  break;
 750   2              case dir_down://è¦å»ä¸‹é¢
 751   2                  switch(str_begin.hzfx){
 752   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 753   3                          fun_motors(mot_hz,-100);
 754   3                          break;
 755   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 756   3                          fun_motors(mot_hz,100);
 757   3                          break;
 758   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 759   3                          fun_motors(mot_hz,100);
 760   3                          break;
 761   3                      default:
 762   3                          break;
 763   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 764   2                  break;
 765   2              default:
 766   2                  break;
 767   2          }//è·å–ç°åœ¨è¦å»çš„å›è½¬ä½ç½®
 768   1          fun_py(par_pymodel);//åšå¹³ç§»
 769   1          def_select(sel_912);//ä¼ æ„Ÿå™¨ç‰‡é€‰
 770   1          switch(par_hzmodel){//è·å–æƒ³è¦åˆ°è¾¾çš„å›è½¬ä½ç½®
 771   2              case dir_up://å›è½¬è‡³å‰æ–¹
 772   2                  switch(str_begin.hzfx){
 773   3                      case dir_down://ç°åœ¨åœ¨ä¸‹æ–¹
 774   3                          while(in_hz==1);
 775   3                          while(in_hz==0);
 776   3                          while(in_hz==1);
 777   3                          fun_delay(str_cod.hz1bz,del_ms);
 778   3                          break;
 779   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 780   3                          while(in_hz==1);
 781   3                          fun_delay(str_cod.hz1bz,del_ms);
 782   3                          break;
 783   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 784   3                          while(in_hz==1);
 785   3                          fun_delay(str_cod.hz1bz,del_ms);
 786   3                          break;
 787   3                      default:
 788   3                          break;
 789   3                  }
 790   2                  break;
 791   2              case dir_down://è¦å»ä¸‹é¢
 792   2                  switch(str_begin.hzfx){
 793   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 794   3                          while(in_hz==1);
 795   3                          while(in_hz==0);
 796   3                          while(in_hz==1);
 797   3                          fun_delay(str_cod.hz1bz,del_ms);
 798   3                          break;
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 14  

 799   3                      case dir_left://ç°åœ¨åœ¨å·¦é¢
 800   3                          while(in_hz==1);
 801   3                          fun_delay(str_cod.hz1bz,del_ms);
 802   3                          break;
 803   3                      case dir_right://ç°åœ¨åœ¨å³é¢
 804   3                          while(in_hz==1);
 805   3                          fun_delay(str_cod.hz1bz,del_ms);
 806   3                          break;
 807   3                      default:
 808   3                          break;
 809   3                  }
 810   2                  break;
 811   2              case dir_left://è¦å»å·¦è¾¹
 812   2                  switch(str_begin.hzfx){
 813   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 814   3                          while(in_hz==1);
 815   3                          fun_delay(str_cod.hz1bz,del_ms);
 816   3                          break;
 817   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 818   3                          while(in_hz==1);
 819   3                          fun_delay(str_cod.hz1bz,del_ms);
 820   3                          break;
 821   3                      case dir_right://ç°åœ¨åœ¨å³é¢
 822   3                          while(in_hz==1);
 823   3                          while(in_hz==0);
 824   3                          while(in_hz==1);
 825   3                          fun_delay(str_cod.hz1bz,del_ms);
 826   3                          break;
 827   3                      default:
 828   3                          break;
 829   3                  }
 830   2                  break;
 831   2              case dir_right://è¦å»å³é¢
 832   2                  switch(str_begin.hzfx){
 833   3                      case dir_up://ç°åœ¨åœ¨å‰é¢
 834   3                          while(in_hz==1);
 835   3                          fun_delay(str_cod.hz1bz,del_ms);
 836   3                          break;
 837   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 838   3                          while(in_hz==1);
 839   3                          fun_delay(str_cod.hz1bz,del_ms);
 840   3                          break;
 841   3                      case dir_left://ç°åœ¨åœ¨å·¦é¢
 842   3                          while(in_hz==1);
 843   3                          while(in_hz==0);
 844   3                          while(in_hz==1);
 845   3                          fun_delay(str_cod.hz1bz,del_ms);
 846   3                          break;
 847   3                      default:
 848   3                          break;
 849   3                  }
 850   2                  break;
 851   2              default:
 852   2                  break;
 853   2          }//è·å–ç°åœ¨è¦å»çš„å›è½¬ä½ç½®
 854   1          fun_motors(mot_hz,0);//åœæ­¢å›è½¬åŠ¨ä½œ
 855   1          str_begin.hzfx=par_hzmodel;//å­˜å‚¨è¿è¡Œç»“æœ
 856   1      }//å¹³ç§»å›è½¬åŒæ­¥è¿åŠ¨
 857          void fun_sjhz(enum varENU_tra par_sjmodel,enum varENU_dir par_hzmodel){
 858   1          ul loc_sjdelay=0;//å‡é™ä¸­é—´ä½å»¶æ—¶
 859   1          ul loc_hzdelay=0xFFFF;//å›è½¬å»¶æ—¶
 860   1          uc loc_sjcgq=0;//å‡é™ä¼ æ„Ÿå™¨æ£€æµ‹æ ‡å¿—ä½(0ä¸ºä¸åšå‡é™,1ä¸ºæœªåˆ°ä¼ æ„Ÿå™¨,2ä¸ºå·²åˆ°ä¼ æ„Ÿå
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 15  

             -™¨)
 861   1          uc loc_hzcgq=0;//å›è½¬å‘¨æœŸæ ‡å¿—ä½(0ä¸ºä¸åš,1ä¸ºä¸€åœˆ,2ä¸ºä¸¤åœˆ)
 862   1          uc loc_hzflag=0;//å›è½¬ä¼ æ„Ÿå™¨æ ‡å¿—ä½
 863   1          if(par_hzmodel!=str_begin.hzfx){
 864   2              switch(par_hzmodel){
 865   3                  case dir_up://å›è½¬è‡³å‰æ–¹
 866   3                      switch(str_begin.hzfx){
 867   4                          case dir_down://ç°åœ¨åœ¨ä¸‹æ–¹
 868   4                              fun_motors(mot_hz,-100);//åè½¬
 869   4                              loc_hzcgq=2;//ä¿©å‘¨æœŸ
 870   4                              break;
 871   4                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 872   4                              fun_motors(mot_hz,100);//æ­£è½¬
 873   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 874   4                              break;
 875   4                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 876   4                              fun_motors(mot_hz,-100);//åè½¬
 877   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 878   4                              break;
 879   4                          default:
 880   4                              break;
 881   4                      }
 882   3                      break;
 883   3                  case dir_down://è¦å»ä¸‹é¢
 884   3                      switch(str_begin.hzfx){
 885   4                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 886   4                              fun_motors(mot_hz,100);//æ­£è½¬
 887   4                              loc_hzcgq=2;//ä¿©å‘¨æœŸ
 888   4                              break;
 889   4                          case dir_left://ç°åœ¨åœ¨å·¦é¢
 890   4                              fun_motors(mot_hz,-100);//åè½¬
 891   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 892   4                              break;
 893   4                          case dir_right://ç°åœ¨åœ¨å³é¢
 894   4                              fun_motors(mot_hz,100);//æ­£è½¬
 895   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 896   4                              break;
 897   4                          default:
 898   4                              break;
 899   4                      }
 900   3                      break;
 901   3                  case dir_left://è¦å»å·¦è¾¹
 902   3                      switch(str_begin.hzfx){
 903   4                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 904   4                              fun_motors(mot_hz,-100);//åè½¬
 905   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 906   4                              break;
 907   4                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 908   4                              fun_motors(mot_hz,100);//æ­£è½¬
 909   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 910   4                              break;
 911   4                          case dir_right://ç°åœ¨åœ¨å³é¢
 912   4                              fun_motors(mot_hz,-100);//åè½¬
 913   4                              loc_hzcgq=2;//ä¿©å‘¨æœŸ
 914   4                              break;
 915   4                          default:
 916   4                              break;
 917   4                      }
 918   3                      break;
 919   3                  case dir_right://è¦å»å³é¢
 920   3                      switch(str_begin.hzfx){
 921   4                          case dir_up://ç°åœ¨åœ¨å‰é¢
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 16  

 922   4                              fun_motors(mot_hz,100);//æ­£è½¬
 923   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 924   4                              break;
 925   4                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 926   4                              fun_motors(mot_hz,-100);//åè½¬
 927   4                              loc_hzcgq=1;//ä¸€ä¸ªå‘¨æœŸ
 928   4                              break;
 929   4                          case dir_left://ç°åœ¨åœ¨å·¦é¢
 930   4                              fun_motors(mot_hz,100);//æ­£è½¬
 931   4                              loc_hzcgq=2;//ä¿©å‘¨æœŸ
 932   4                              break;
 933   4                          default:
 934   4                              break;
 935   4                      }
 936   3                      break;
 937   3                  default:
 938   3                      break;
 939   3              }//é€‰æ‹©éœ€è¦çš„è¿åŠ¨å‘¨æœŸ
 940   2              loc_hzdelay=var_timer+1000;//å›è½¬ä¼ æ„Ÿå™¨éš”1ç§’æ£€æµ‹
 941   2          }//å¯åŠ¨å›è½¬ç”µæœº
 942   1          if(par_sjmodel!=str_begin.sjwz){//å¦‚æœä¸åœ¨ä½
 943   2              fun_motors(mot_sj,par_sjmodel<str_begin.sjwz?100:-100);//é€šè¿‡é«˜åº¦è®¡ç®—å¹¶å¯åŠ¨æ­£åè½¬
 944   2              loc_sjcgq=1;//æ ‡å¿—ä½è®°å½•ä¸ºç­‰å¾…ä¼ æ„Ÿå™¨
 945   2          }//å¯åŠ¨å‡é™ç”µæœº
 946   1          while(str_begin.hzsd!=0||str_begin.sjsd!=0){//éé˜»å¡å‹Mainå‡½æ•°å¾ªç¯æ£€æµ‹
 947   2              if(loc_sjcgq==1){//å¦‚æœè¿˜æ²¡åˆ°ä¼ æ„Ÿå™¨
 948   3                  switch(par_sjmodel){
 949   4                      case sjp_1:
 950   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
 951   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
 952   4                          if(in_wz1==0){//å¦‚æœç¬¬ä¸€ä¸ªä¼ æ„Ÿå™¨æœ‰ä¿¡å·
 953   5                              loc_sjdelay=var_timer+str_cod.sj1bzw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—æ
             - ‡å‡†ä½å»¶æ—¶
 954   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
 955   5                          }
 956   4                          break;
 957   4                      case sjp_12:
 958   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
 959   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
 960   4                          if(str_begin.sjwz==sjp_1||in_wz2==0){//å¦‚æœå¼€å§‹çš„æ—¶å€™æ—¶åœ¨ä½ç½®1æˆ–å·²ç»åˆ°ä
             -º†ä½ç½®2
 961   5                              loc_sjdelay=var_timer+str_cod.sj1zjw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—ä
             -¸­é—´ä½å»¶æ—¶
 962   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
 963   5                          }
 964   4                          break;
 965   4                      case sjp_2:
 966   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
 967   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
 968   4                          if(in_wz2==0){//å¦‚æœç¬¬äºŒä¸ªä¼ æ„Ÿå™¨æœ‰ä¿¡å·
 969   5                              loc_sjdelay=var_timer+str_cod.sj1bzw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—æ
             - ‡å‡†ä½å»¶æ—¶
 970   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
 971   5                          }
 972   4                          break;
 973   4                      case sjp_23:
 974   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
 975   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
 976   4                          if(in_wz2==0||in_wz3==0){//å¦‚æœå·²ç»åˆ°äº†ä½ç½®2æˆ–å·²ç»åˆ°äº†ä½ç½®3
 977   5                              loc_sjdelay=var_timer+str_cod.sj1zjw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—ä
             -¸­é—´ä½å»¶æ—¶
 978   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 17  

 979   5                          }
 980   4                          break;
 981   4                      case sjp_3:
 982   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
 983   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
 984   4                          if(in_wz3==0){//å¦‚æœç¬¬ä¸‰ä¸ªä¼ æ„Ÿå™¨æœ‰ä¿¡å·
 985   5                              loc_sjdelay=var_timer+str_cod.sj1bzw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—æ
             - ‡å‡†ä½å»¶æ—¶
 986   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
 987   5                          }
 988   4                          break;
 989   4                      case sjp_34:
 990   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
 991   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
 992   4                          if(in_wz3==0||in_wz4==0){//å¦‚æœå·²ç»åˆ°äº†ä½ç½®3æˆ–å·²ç»åˆ°äº†ä½ç½®4
 993   5                              loc_sjdelay=var_timer+str_cod.sj1zjw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—ä
             -¸­é—´ä½å»¶æ—¶
 994   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
 995   5                          }
 996   4                          break;
 997   4                      case sjp_4:
 998   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
 999   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
1000   4                          if(in_wz4==0){//å¦‚æœç¬¬å››ä¸ªä¼ æ„Ÿå™¨æœ‰ä¿¡å·
1001   5                              loc_sjdelay=var_timer+str_cod.sj1bzw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—æ
             - ‡å‡†ä½å»¶æ—¶
1002   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
1003   5                          }
1004   4                          break;
1005   4                      case sjp_45:
1006   4                          def_select(sel_58);//ç‰‡é€‰58ä¼ æ„Ÿå™¨
1007   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
1008   4                          if(in_wz4==0||str_begin.sjwz==sjp_5){//å¦‚æœå·²ç»åˆ°äº†ä½ç½®4æˆ–å¼€å§‹çš„æ—¶å€™æ—¶å
             -œ¨ä½ç½®5
1009   5                              loc_sjdelay=var_timer+str_cod.sj1zjw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—ä
             -¸­é—´ä½å»¶æ—¶
1010   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
1011   5                          }
1012   4                          break;
1013   4                      case sjp_5:
1014   4                          def_select(sel_912);//ç‰‡é€‰912ä¼ æ„Ÿå™¨
1015   4                          fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
1016   4                          if(in_wz5==0){//å¦‚æœç¬¬äº”ä¸ªä¼ æ„Ÿå™¨æœ‰ä¿¡å·
1017   5                              loc_sjdelay=var_timer+str_cod.sj1bzw;//é€šè¿‡å®šæ—¶å™¨å…¨å±€æ—¶é—´æ ‡å¿—ä½è®¡ç®—æ
             - ‡å‡†ä½å»¶æ—¶
1018   5                              loc_sjcgq=2;//æ ‡å¿—ä½è®°å½•å·²åˆ°ä¼ æ„Ÿå™¨
1019   5                          }
1020   4                          break;
1021   4                      default:
1022   4                          break;
1023   4                  }
1024   3              }
1025   2              else if(loc_sjcgq==2){//å¦‚æœå»¶æ—¶æ—¶é—´åˆ°
1026   3                  if(loc_sjdelay<=var_timer){
1027   4                      fun_motors(mot_sj,0);//åœæ­¢ç”µæœº
1028   4                      loc_sjcgq=0;//ä¸åšå‡é™äº†
1029   4                      str_begin.sjwz=par_sjmodel;//å­˜å‚¨è¿è¡Œç»“æœ
1030   4                  }
1031   3              }//å·²ç»åˆ°äº†ä¼ æ„Ÿå™¨éœ€è¦å»¶æ—¶
1032   2              if(loc_hzdelay<=var_timer){//å¦‚æœ1ç§’å»¶æ—¶å·²ç»è¿‡å»
1033   3                  if(loc_hzcgq!=0){//å¦‚æœä¸æ˜¯è½¬0åœˆ
1034   4                      def_select(sel_912);//ä¼ æ„Ÿå™¨ç‰‡é€‰
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 18  

1035   4                      fun_delay(20,del_us);//å»¶æ—¶20us,ç»™ç‰‡é€‰èŠ¯ç‰‡ä¸€æ®µæ—¶é—´åˆ‡æ¢
1036   4                      if(in_hz==1){//å¦‚æœä¼ æ„Ÿå™¨æ²¡äº®
1037   5                          loc_hzflag=1;//æ ‡å¿—ä½å˜1
1038   5                      }
1039   4                      else if(loc_hzflag==1){//å¦‚æœæ ‡å¿—ä½ä¸º1ä¸”ä¼ æ„Ÿå™¨æœ‰ä¿¡å·
1040   5                          loc_hzcgq--;//ç®—ä¸€ä¸ªå‘¨æœŸå®Œæˆ
1041   5                          loc_hzflag=0;//æ ‡å¿—ä½å˜0
1042   5                      }
1043   4                  }
1044   3                  else{//å¦‚æœåœˆæ•°ä¸º0
1045   4                      fun_motors(mot_hz,0);//åœæ­¢ç”µæœº
1046   4                      loc_hzdelay=0xFFFF;//ä¸åšå›è½¬äº†
1047   4                      str_begin.hzfx=par_hzmodel;//å­˜å‚¨è¿è¡Œç»“æœ
1048   4                  }
1049   3              }
1050   2          }
1051   1      }//å‡é™å›è½¬åŒæ­¥è¿åŠ¨
1052          void fun_pysjhz(enum varENU_tra par_pymodel,enum varENU_tra par_sjmodel,enum varENU_dir par_hzmodel){
1053   1      ;
1054   1      }
*** WARNING C280 IN LINE 1052 OF program\8023.c: 'par_pymodel': unreferenced local variable
*** WARNING C280 IN LINE 1052 OF program\8023.c: 'par_sjmodel': unreferenced local variable
*** WARNING C280 IN LINE 1052 OF program\8023.c: 'par_hzmodel': unreferenced local variable
1055          void fun_jtjp(){
1056   1          while(1){//å¾ªç¯çº å
1057   2              if((!in_ls1&&!in_ls2&&in_ls4&&in_ls5&&!in_ls7&&!in_ls8)&&((in_ls3&&in_ls6)||(!in_ls3&&!in_ls6))){
1058   3                  fun_delay(10,del_ms);
1059   3                  fun_motors(mot_rl,0);
1060   3                  return;
1061   3              }//1278ä¸äº®,45äº®,36è¦ä¹ˆä¸€èµ·äº®è¦ä¹ˆä¸€èµ·ç­
1062   2              if(in_ls2||in_ls1){
1063   3                  fun_motors(mot_l,16);
1064   3                  fun_motors(mot_r,-16);
1065   3              }//12äº®
1066   2              else if(in_ls7||in_ls8){
1067   3                  fun_motors(mot_l,-16);
1068   3                  fun_motors(mot_r,16);
1069   3              }//78äº®
1070   2              else{
1071   3                  if(!in_ls4){
1072   4                      fun_motors(mot_l,-12);
1073   4                      fun_motors(mot_r,12);
1074   4                  }//4ä¸äº®
1075   3                  else if(!in_ls5){
1076   4                      fun_motors(mot_l,12);
1077   4                      fun_motors(mot_r,-12);
1078   4                  }//4äº®5ä¸äº®
1079   3                  else{
1080   4                      if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
1081   5                          fun_motors(mot_l,-8);
1082   5                          fun_motors(mot_r,8);
1083   5                      }
1084   4                      if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
1085   5                          fun_motors(mot_l,8);
1086   5                          fun_motors(mot_r,-8);
1087   5                      }
1088   4                  }
1089   3              }
1090   2          }
1091   1      }//é™æ€çº å
1092          void fun_timermove(){
1093   1          static data uc loc_con=0;//éœ€è¦åˆ†æ­¥åšçš„åŠ¨ä½œéœ€è¦ç”¨åˆ°æ­¤é™æ€ç§æœ‰åˆ†æ­¥æ ‡å¿—ä½
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 19  

1094   1          data int loc_sdl,loc_sdr;//å·¦è½®é€Ÿåº¦å’Œå³è½®é€Ÿåº¦çš„å±€éƒ¨å˜é‡
1095   1          switch(*str_tfl.run){//é€‰æ‹©è¿è¡Œæ–¹å¼
1096   2              case def_end://è¿è¡Œç»“æŸ
1097   2                  fun_motorsrl(mot_rl,0);//å†æ¬¡åœæ­¢ç”µæœºè¿åŠ¨
1098   2                  str_tfl.doing=tf_false;//ç§»åŠ¨ç»“æŸ
1099   2                  memset(str_tfl.step,0,sizeof(str_tfl.step));//æ¸…ç©ºstepæ•°ç»„
1100   2                  str_tfl.run=str_tfl.step;//æŒ‡é’ˆæŒ‡å‘stepçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
1101   2                  break;
1102   2              case tfl_line://è¿è¡Œå·¡çº¿
1103   2                  if(*(str_tfl.run+1)){//å¦‚æœå‚æ•°ä¸ºé0æ•°
1104   3                      if((in_ls1||in_ls8)&&(in_ls2&&in_ls3&&in_ls4&&in_ls5&in_ls6&&in_ls7)){//å¦‚æœä¸­é—´6ä¸ªç
             -¯å…¨äº®,å·¦å³äº®ä»»æ„ä¸€ä¸ª
1105   4                          str_tfl.online=tf_ture;//æ ‡å¿—ä½è®°å½•åœ¨çº¿
1106   4                          fun_motorsrl(mot_rl,str_tfl.gospeed);//æŒ‰ç…§å¸¸è§„é€Ÿåº¦è¿‡çº¿
1107   4                      }
1108   3                      else if(str_tfl.online==tf_ture){//å¦‚æœæ ‡å¿—ä½è®°å½•åœ¨çº¿,è€Œä¸”ä¸ç¬¦åˆåœ¨çº¿ç‰¹å¾
1109   4                          str_tfl.online=tf_false;//æ ‡å¿—ä½è®°å½•ä¸åœ¨çº¿
1110   4                          (*(str_tfl.run+1))--;//å‚æ•°å€¼å‡1,è®°å½•å·²ç»èµ°äº†ä¸€æ¡çº¿
1111   4                      }
1112   3                      else{
1113   4                          loc_sdl=loc_sdr=40;//å·¡çº¿é€Ÿåº¦ä¸ºstr_tfl.gospeed
1114   4                          if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
1115   5                              loc_sdl-=loc_sdl/10;
1116   5                              loc_sdr+=(100-loc_sdr)/10;
1117   5                          }//å‘å·¦è½¬
1118   4                          if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
1119   5                              loc_sdl+=(100-loc_sdl)/10;
1120   5                              loc_sdr-=loc_sdr/10;
1121   5                          }//å‘å³è½¬
1122   4                          if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
1123   5                              loc_sdl-=loc_sdl/10*3;
1124   5                              loc_sdr+=(100-loc_sdr)/10*3;
1125   5                          }//å‘å·¦è½¬
1126   4                          if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
1127   5                              loc_sdl+=(100-loc_sdl)/10*3;
1128   5                              loc_sdr-=loc_sdr/10*3;
1129   5                          }//å‘å³è½¬
1130   4                          if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
1131   5                              loc_sdl-=loc_sdl/10*5;
1132   5                              loc_sdr+=(100-loc_sdr)/10*5;
1133   5                          }//å‘å·¦è½¬
1134   4                          if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
1135   5                              loc_sdl+=(100-loc_sdl)/10*5;
1136   5                              loc_sdr-=loc_sdr/10*5;
1137   5                          }//å‘å³è½¬
1138   4                          fun_motorsrl(mot_r,loc_sdr);
1139   4                          fun_motorsrl(mot_l,loc_sdl);
1140   4                      }
1141   3                  }
1142   2                  else{//å¦‚æœçº¿èµ°å®Œäº†
1143   3                      str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
1144   3                      fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœºè¿åŠ¨
1145   3                  }
1146   2                  break;
1147   2              case tfl_turn://è¿è¡Œè½¬å¼¯
1148   2                  switch(loc_con){//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½
1149   3                      case 0://ç¬¬ä¸€æ­¥
1150   3                          switch(*(str_tfl.run+1)){//è·å–å‚æ•°
1151   4                              case tur_r90://å³è½¬90
1152   4                                  fun_motorsrl(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
1153   4                                  fun_motorsrl(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
1154   4                                  str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 20  

1155   4                                  break;
1156   4                              case tur_l90://å·¦è½¬90
1157   4                                  fun_motorsrl(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
1158   4                                  fun_motorsrl(mot_r,str_tfl.turnspeed);//å³è½®å‘å‰
1159   4                                  str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
1160   4                                  break;
1161   4                              case tur_r180://å³è½¬180
1162   4                                  fun_motorsrl(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
1163   4                                  fun_motorsrl(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
1164   4                                  str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
1165   4                                  break;
1166   4                              case tur_l180://å·¦è½¬180
1167   4                                  fun_motorsrl(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
1168   4                                  fun_motorsrl(mot_r,str_tfl.turnspeed);//å·¦è½®å‘å‰
1169   4                                  str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
1170   4                                  break;
1171   4                          }
1172   3                          loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
1173   3                          break;
1174   3                      case 1://ç¬¬äºŒæ­¥
1175   3                          if(str_tfl.delay<=var_timer)//è®¡æ—¶æ—¶é—´åˆ°
1176   3                              loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
1177   3                          break;
1178   3                      case 2://ç¬¬ä¸‰æ­¥
1179   3                          if(in_ls4&&in_ls5){//å¦‚æœä¸­é—´ä¸¤ä¸ªç¯äº®
1180   4                              fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœº
1181   4                              str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
1182   4                              str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
1183   4                              loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
1184   4                          }
1185   3                          break;
1186   3                  }
1187   2                  break;
1188   2              case tfl_cache://è¿è¡Œå‰å†²
1189   2                  switch(loc_con){
1190   3                      case 0://ç¬¬ä¸€æ­¥
1191   3                          str_tfl.delay=var_timer+((*(str_tfl.run+1))*10);//å»¶æ—¶æ—¶é—´(æ¯«ç§’)ä¸ºå‚æ•°çš„10å€
             -
1192   3                          loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
1193   3                          break;
1194   3                      case 1://ç¬¬äºŒæ­¥
1195   3                          if(str_tfl.delay<=var_timer){//è®¡æ—¶æ—¶é—´åˆ°
1196   4                              fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœº
1197   4                              str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
1198   4                              str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
1199   4                              loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
1200   4                          }
1201   3                          else{
1202   4                              loc_sdl=loc_sdr=str_tfl.cachespeed;//å‰å†²é€Ÿåº¦ä¸ºstr_tfl.cachespeed
1203   4                              if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
1204   5                                  loc_sdl*=0.5;//å·¦å‡é€Ÿ
1205   5                                  loc_sdr*=1.5;//å³åŠ é€Ÿ
1206   5                              }//å‘å·¦è½¬
1207   4                              if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
1208   5                                  loc_sdl*=1.5;//å·¦åŠ é€Ÿ
1209   5                                  loc_sdr*=0.5;//å³å‡é€Ÿ
1210   5                              }//å‘å³è½¬
1211   4                              if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
1212   5                                  loc_sdl*=0.7;//å·¦å‡é€Ÿ
1213   5                                  loc_sdr*=1.3;//å³åŠ é€Ÿ
1214   5                              }//å‘å·¦è½¬
1215   4                              if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 21  

1216   5                                  loc_sdl*=1.3;//å·¦åŠ é€Ÿ
1217   5                                  loc_sdr*=0.7;//å³å‡é€Ÿ
1218   5                              }//å‘å³è½¬
1219   4                              if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
1220   5                                  loc_sdl*=0.9;//å·¦å‡é€Ÿ
1221   5                                  loc_sdr*=1.1;//å³åŠ é€Ÿ
1222   5                              }//å‘å·¦è½¬
1223   4                              if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
1224   5                                  loc_sdl*=1.1;//å·¦åŠ é€Ÿ
1225   5                                  loc_sdr*=0.9;//å³å‡é€Ÿ
1226   5                              }//å‘å³è½¬
1227   4                              fun_motorsrl(mot_r,loc_sdr);
1228   4                              fun_motorsrl(mot_l,loc_sdl);
1229   4                          }
1230   3                          break;
1231   3                  }
1232   2                  break;
1233   2              default:
1234   2                  break;
1235   2          }
1236   1      }//å®šæ—¶å™¨ç§»åŠ¨
1237          void fun_flsetting(char par_gospeed,char par_turnspeed,char par_cachespeed,...){
1238   1          va_list loc_argp;//ä¿å­˜å‚æ•°ç»“æ„
1239   1          uc loc_step=0;//å¾ªç¯stepæ•°ç»„ç”¨çš„ä¸œè¥¿
1240   1          uc loc_cachespeed;//å½“å‰å‚æ•°
1241   1          va_start(loc_argp,par_cachespeed);//loc_argpæŒ‡å‘ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå¯é€‰å‚æ•°,par_cachespeedæ˜¯æœ€å
             -ä¸€ä¸ªç¡®å®šçš„å‚æ•°
1242   1          loc_cachespeed=va_arg(loc_argp,char);//å–å‡ºç¬¬ä¸€ä¸ªå‚æ•°
1243   1          while(loc_cachespeed!=def_end){
1244   2              str_tfl.step[loc_step++]=loc_cachespeed;//æŠŠç»™stepæ•°ç»„,æ ‡å¿—ä½+1
1245   2              loc_cachespeed=va_arg(loc_argp,char);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
1246   2          }
1247   1          str_tfl.step[loc_step]=def_end;//stepæ•°ç»„ç»“æŸæ ‡å¿—ä½
1248   1          va_end(loc_argp);//ç»“æŸ
1249   1      
1250   1          str_tfl.online=tf_false;//ä¸åœ¨çº¿
1251   1          str_tfl.run=str_tfl.step;//æŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªæ•°ç»„
1252   1          str_tfl.gospeed=par_gospeed;//é»˜è®¤é€Ÿåº¦
1253   1          str_tfl.turnspeed=par_turnspeed;//æ‹å¼¯é€Ÿåº¦
1254   1          str_tfl.cachespeed=par_cachespeed;//å‰å†²é€Ÿåº¦
1255   1          str_tfl.doing=tf_ture;//å¼€å§‹åš
1256   1      }//ä¸»å‡½æ•°ç”¨å®šæ—¶å™¨å·¡çº¿è°ƒç”¨å‡½æ•°
1257          void fun_folline(uc par_con,uc par_speed){
1258   1          uc loc_con=par_con;//å·¡çº¿æ¡æ•°æ ‡å¿—ä½
1259   1          uc loc_sdr,loc_sdl;//å·¦å³è½®é€Ÿåº¦
1260   1          uc loc_online;//åœ¨çº¿æ ‡å¿—ä½
1261   1          while(loc_con){
1262   2              if((in_ls1||in_ls8)&&(in_ls2&&in_ls3&&in_ls4&&in_ls5&in_ls6&&in_ls7)){//å¦‚æœä¸­é—´6ä¸ªç¯å…¨äº®,
             -å·¦å³äº®ä»»æ„ä¸€ä¸ª
1263   3                  loc_online=tf_ture;//æ ‡å¿—ä½è®°å½•åœ¨çº¿
1264   3                  fun_motors(mot_rl,par_speed);//æŒ‰ç…§å¸¸è§„é€Ÿåº¦è¿‡çº¿
1265   3              }
1266   2              else if(loc_online==tf_ture){//å¦‚æœæ ‡å¿—ä½è®°å½•åœ¨çº¿,è€Œä¸”ä¸ç¬¦åˆåœ¨çº¿ç‰¹å¾
1267   3                  loc_online=tf_false;//æ ‡å¿—ä½è®°å½•ä¸åœ¨çº¿
1268   3                  loc_con--;//å‚æ•°å€¼å‡1,è®°å½•å·²ç»èµ°äº†ä¸€æ¡çº¿
1269   3              }
1270   2              else{
1271   3                  loc_sdr=loc_sdl=par_speed;
1272   3                  if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
1273   4                      loc_sdl-=loc_sdl/10;
1274   4                      loc_sdr+=(100-loc_sdr)/10;
1275   4                  }//å‘å·¦è½¬
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 22  

1276   3                  if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
1277   4                      loc_sdl+=(100-loc_sdl)/10;
1278   4                      loc_sdr-=loc_sdr/10;
1279   4                  }//å‘å³è½¬
1280   3                  if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
1281   4                      loc_sdl-=loc_sdl/10*3;
1282   4                      loc_sdr+=(100-loc_sdr)/10*3;
1283   4                  }//å‘å·¦è½¬
1284   3                  if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
1285   4                      loc_sdl+=(100-loc_sdl)/10*3;
1286   4                      loc_sdr-=loc_sdr/10*3;
1287   4                  }//å‘å³è½¬
1288   3                  if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
1289   4                      loc_sdl-=loc_sdl/10*5;
1290   4                      loc_sdr+=(100-loc_sdr)/10*5;
1291   4                  }//å‘å·¦è½¬
1292   3                  if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
1293   4                      loc_sdl+=(100-loc_sdl)/10*5;
1294   4                      loc_sdr-=loc_sdr/10*5;
1295   4                  }//å‘å³è½¬
1296   3                  fun_motors(mot_r,loc_sdr);
1297   3                  fun_motors(mot_l,loc_sdl);
1298   3                  fun_delay(1,del_ms);
1299   3              }
1300   2          }//å¦‚æœå·¡çº¿æ¡æ•°ä¸ä¸º0
1301   1          fun_qc(60,40);//å‰å†²
1302   1      }//ä¸»å‡½æ•°å·¡çº¿
1303          void fun_turn(enum varENU_tur par_model,uc par_speed){
1304   1          switch(par_model){//è·å–å‚æ•°
1305   2              case tur_r90://å³è½¬90
1306   2                  fun_motors(mot_l,par_speed);//å·¦è½®å‘å‰
1307   2                  fun_motors(mot_r,-par_speed);//å³è½®å‘å
1308   2                  fun_delay(str_cod.turn90,del_ms);//è®¡æ—¶
1309   2                  break;
1310   2              case tur_l90://å·¦è½¬90
1311   2                  fun_motors(mot_l,-par_speed);//å·¦è½®å‘å
1312   2                  fun_motors(mot_r,par_speed);//å³è½®å‘å‰
1313   2                  fun_delay(str_cod.turn90,del_ms);//è®¡æ—¶
1314   2                  break;
1315   2              case tur_r180://å³è½¬180
1316   2                  fun_motors(mot_l,par_speed);//å·¦è½®å‘å‰
1317   2                  fun_motors(mot_r,-par_speed);//å³è½®å‘å
1318   2                  fun_delay(str_cod.turn180,del_ms);//è®¡æ—¶
1319   2                  break;
1320   2              case tur_l180://å·¦è½¬180
1321   2                  fun_motors(mot_l,-par_speed);//å·¦è½®å‘å
1322   2                  fun_motors(mot_r,par_speed);//å·¦è½®å‘å‰
1323   2                  fun_delay(str_cod.turn180,del_ms);//è®¡æ—¶
1324   2                  break;
1325   2          }
1326   1          while(!in_ls4||!in_ls5);
1327   1          fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
1328   1      }//ä¸»å‡½æ•°è½¬å¼¯
1329          void fun_qc(uc par_time,uc par_speed){
1330   1          uc loc_sdr,loc_sdl;//å·¦å³è½®é€Ÿåº¦
1331   1          str_tfl.delay=var_timer+par_time*10;//å»¶æ—¶æ—¶é—´(æ¯«ç§’)ä¸ºå‚æ•°çš„10å€
1332   1          while(str_tfl.delay>var_timer){
1333   2              loc_sdr=loc_sdl=par_speed;
1334   2              if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
1335   3                  loc_sdl*=0.7;//å·¦å‡é€Ÿ
1336   3                  loc_sdr*=1.3;//å³åŠ é€Ÿ
1337   3              }//å‘å·¦è½¬
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 23  

1338   2              if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
1339   3                  loc_sdl*=1.3;//å·¦åŠ é€Ÿ
1340   3                  loc_sdr*=0.7;//å³å‡é€Ÿ
1341   3              }//å‘å³è½¬
1342   2              if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
1343   3                  loc_sdl*=0.8;//å·¦å‡é€Ÿ
1344   3                  loc_sdr*=1.2;//å³åŠ é€Ÿ
1345   3              }//å‘å·¦è½¬
1346   2              if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
1347   3                  loc_sdl*=1.2;//å·¦åŠ é€Ÿ
1348   3                  loc_sdr*=0.8;//å³å‡é€Ÿ
1349   3              }//å‘å³è½¬
1350   2              if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
1351   3                  loc_sdl*=0.9;//å·¦å‡é€Ÿ
1352   3                  loc_sdr*=1.1;//å³åŠ é€Ÿ
1353   3              }//å‘å·¦è½¬
1354   2              if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
1355   3                  loc_sdl*=1.1;//å·¦åŠ é€Ÿ
1356   3                  loc_sdr*=0.9;//å³å‡é€Ÿ
1357   3              }//å‘å³è½¬
1358   2              fun_motors(mot_r,loc_sdr);
1359   2              fun_motors(mot_l,loc_sdl);
1360   2              fun_delay(1,del_ms);
1361   2          }
1362   1          fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
1363   1      }//ä¸»å‡½æ•°å‰å†²
1364          void fun_stope2prom(){
1365   1          IAP_CONTR = 0;                  //å…³é—­IAPåŠŸèƒ½
1366   1          IAP_CMD = 0;                    //æ¸…é™¤å‘½ä»¤
1367   1          IAP_TRIG = 0;                   //æ¸…é™¤è§¦å‘å¯„å­˜å™¨
1368   1          IAP_ADDRH = 0x80;               //æ•°æ®æŒ‡é’ˆæŒ‡å‘éEEPROMåŒº
1369   1          IAP_ADDRL = 0;                  //æ¸…é™¤IAPåœ°å€
1370   1      }//å…³é—­EEPROMåŠŸèƒ½(IapIdle)
1371          uc fun_reade2prom(ui par_add){
1372   1          uc loc_dat;                     //æ•°æ®ç¼“å†²åŒº
1373   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1374   1          IAP_CMD = 1;                    //è®¾ç½®EEPROMè¯»å‘½ä»¤
1375   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1376   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1377   1          IAP_TRIG = 0x5a;                //è§¦å‘
1378   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1379   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1380   1          loc_dat = IAP_DATA;             //è¯»å‡ºEEPROMä¸­çš„æ•°æ®
1381   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1382   1          return loc_dat;                 //è¿”å›è¯»å–ç»“æœ
1383   1      }//è¯»å–EEPROMæ•°æ®
1384          void fun_writee2prom(ui par_add,uc par_dat){
1385   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1386   1          IAP_CMD = 2;                    //è®¾ç½®EEPROMå†™å…¥å‘½ä»¤
1387   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1388   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1389   1          IAP_DATA = par_dat;             //å†™å…¥æ•°æ®
1390   1          IAP_TRIG = 0x5a;                //è§¦å‘
1391   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1392   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1393   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1394   1      }//å†™EEPROMæ•°æ®
1395          void fun_cleane2prom(ui par_add){
1396   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1397   1          IAP_CMD = 3;                    //è®¾ç½®EEPROMæ“¦é™¤å‘½ä»¤
1398   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1399   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 24  

1400   1          IAP_TRIG = 0x5a;                //è§¦å‘
1401   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1402   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1403   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1404   1      }//æ¸…é™¤EEPROMæ•°æ®
1405          void fun_calibration(){
1406   1          // fun_sj(sjp_1);//å‡åˆ°æœ€ä¸Šä½
1407   1          ul loc_time;
1408   1          fun_py(tra_q);//ç§»åŠ¨åˆ°æœ€å‰ç«¯
1409   1          fun_py(tra_h);//ç§»åŠ¨åˆ°æœ€åç«¯
1410   1          loc_time=var_timer;
1411   1          fun_py(tra_q);//ç§»åŠ¨åˆ°å‰ç«¯å¹¶è®¡æ—¶
1412   1          fun_py(tra_h);//ç§»åŠ¨åˆ°åç«¯
1413   1          loc_time=var_timer-loc_time;
1414   1          loc_time*=0.5;
1415   1          str_cod.py1zh=loc_time*0.5;//ä»ååˆ°ä¸­é—´
1416   1          str_cod.py1qz=loc_time*0.5;//ä»å‰åˆ°ä¸­é—´
1417   1          str_cod.py1qkh=loc_time*0.75;//ä»å‰åˆ°é å
1418   1          str_cod.py1kqh=loc_time*0.564;//ä»é å‰åˆ°å
1419   1          str_cod.py1qkq=loc_time*0.34;//ä»å‰åˆ°é å‰
1420   1          str_cod.py1khh=loc_time*0.2701;//ä»ååˆ°é å
1421   1          str_cod.py1kqz=loc_time*0.189;//ä»é å‰åˆ°ä¸­é—´
1422   1          str_cod.py1zkh=loc_time*0.20;//ä»é ååˆ°ä¸­é—´
1423   1          str_cod.py1kqkh=loc_time*0.5;//ä»é å‰åˆ°é å
1424   1          str_cod.py1khkq=loc_time*0.5;//ä»é ååˆ°é å‰
1425   1      }//è‡ªåŠ¨æ ¡å‡†å¹³ç§»å‚æ•°
1426          void fun_port(){
1427   1          //19200bps@12.000MHz
1428   1          PCON |= 0x80;       //ä½¿èƒ½æ³¢ç‰¹ç‡å€é€Ÿä½SMOD
1429   1          SCON = 0x50;        //8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡
1430   1          AUXR |= 0x04;       //ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨æ—¶é’Ÿä¸ºFosc,å³1T
1431   1          BRT = 0xD9;         //è®¾å®šç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨é‡è£…å€¼
1432   1          AUXR |= 0x01;       //ä¸²å£1é€‰æ‹©ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1433   1          AUXR |= 0x10;       //å¯åŠ¨ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1434   1      }//ä¸²å£åˆå§‹åŒ–
1435          void fun_test(){
1436   1          fun_sz(han_j);
1437   1          fun_delay(1,del_s);
1438   1          fun_sz(han_s);
1439   1          fun_delay(1,del_s);
1440   1          fun_sz(han_j);
1441   1          fun_delay(1,del_s);
1442   1          fun_sz(han_s);
1443   1          fun_delay(1,del_s);
1444   1      
1445   1          str_begin.pywz=tra_h;
1446   1          fun_py(tra_q);
1447   1          fun_delay(1,del_s);
1448   1          fun_py(tra_h);
1449   1          fun_delay(1,del_s);
1450   1          fun_py(tra_q);
1451   1          fun_delay(1,del_s);
1452   1          fun_py(tra_h);
1453   1          fun_delay(1,del_s);
1454   1      
1455   1          fun_sj(sjp_1);
1456   1          fun_delay(1,del_s);
1457   1          fun_sj(sjp_2);
1458   1          fun_delay(1,del_s);
1459   1          fun_sj(sjp_3);
1460   1          fun_delay(1,del_s);
1461   1          fun_sj(sjp_4);
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 25  

1462   1          fun_delay(1,del_s);
1463   1          fun_sj(sjp_5);
1464   1          fun_delay(1,del_s);
1465   1          fun_sj(sjp_4);
1466   1          fun_delay(1,del_s);
1467   1          fun_sj(sjp_3);
1468   1          fun_delay(1,del_s);
1469   1          fun_sj(sjp_2);
1470   1          fun_delay(1,del_s);
1471   1          fun_sj(sjp_1);
1472   1      
1473   1          str_now.hzfx=str_begin.hzfx;
1474   1          str_begin.hzfx=dir_up;
1475   1          fun_hz(dir_right);
1476   1          fun_delay(1,del_s);
1477   1          fun_hz(dir_up);
1478   1          fun_delay(1,del_s);
1479   1          fun_hz(dir_right);
1480   1          fun_delay(1,del_s);
1481   1          fun_hz(dir_up);
1482   1          fun_delay(1,del_s);
1483   1          str_begin.hzfx=str_now.hzfx;
1484   1      
1485   1          fun_motors(mot_rl,60);
1486   1          fun_delay(1,del_s);
1487   1          fun_motors(mot_rl,0);
1488   1          fun_delay(1,del_s);
1489   1      
1490   1          fun_motors(mot_rl,-60);
1491   1          fun_delay(1,del_s);
1492   1          fun_motors(mot_rl,0);
1493   1          fun_delay(1,del_s);
1494   1      
1495   1          fun_motors(mot_r,40);
1496   1          fun_motors(mot_l,-40);
1497   1          fun_delay(1,del_s);
1498   1          fun_motors(mot_rl,0);
1499   1          fun_delay(1,del_s);
1500   1      
1501   1          fun_motors(mot_r,-40);
1502   1          fun_motors(mot_l,40);
1503   1          fun_delay(1,del_s);
1504   1          fun_motors(mot_rl,0);
1505   1      }//æµ‹è¯•ç¨‹åº
1506          uc fun_min(uc par_num,...){
1507   1          va_list loc_argp;//ä¿å­˜å‚æ•°ç»“æ„
1508   1          uc loc_min=par_num;//ç°åœ¨çš„æœ€å°å€¼å°±æ˜¯ç¬¬ä¸€ä¸ª
1509   1          uc loc_shu;//å½“å‰å‚æ•°
1510   1          va_start(loc_argp,par_num);//loc_argpæŒ‡å‘ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œpar_numæ˜¯æœ€åä¸€ä¸ªç¡®å
             -®šçš„å‚æ•°
1511   1          loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
1512   1          do{
1513   2              if(loc_shu<loc_min)
1514   2                  loc_min=loc_shu;
1515   2              loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
1516   2          }while(loc_shu!=def_end);
1517   1          va_end(loc_argp);//ç»“æŸ
1518   1          return loc_min;//é€€å‡º
1519   1      }//æ±‚æœ€å°å€¼
1520          void fun_coordinate(){
1521   1          
1522   1      }//è‡ªåŠ¨å·¡çº¿ä¹‹åæ ‡
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 26  

1523          void fun_zdzj(ul par_04,ul par_37){//ulå‹æ•°æ®,ä¸€æ¬¡è¾“å…¥æ‰€æœ‰ç»“æœ,æ— éœ€ç­‰å¾…
1524   1          struct str_zdzj str_pass,str_end;//str_zdzj(è‡ªåŠ¨æŠ“ä»¶)çš„ç»“æ„ä½“:ç°åœ¨çš„æ•°æ®å’Œç»“æŸæ—¶å¾—åˆ
             -°çš„ç»“æœ
1525   1          char loc_high[8];         //æ¯æ‘å·¥ä»¶çš„é«˜åº¦
1526   1          uc loc_xh1;             //ç¬¬ä¸€ä¸ªå¾ªç¯
1527   1      
1528   1          memset(str_pass.jx,0,sizeof(str_pass.jx));//æ¸…ç©ºç°åœ¨ä»¶åº
1529   1          memset(str_end.jx,0,sizeof(str_end.jx)); //æ¸…ç©ºæƒ³è¦çš„ä»¶åº
1530   1          memset(loc_high,5,sizeof(loc_high));     //æ¯ç»„é«˜åº¦ç½®5(æ²¡æœ‰ä»¶)
1531   1      
1532   1          //èµ·å§‹åŒºä»¶å·
1533   1          str_pass.jx[0][1]=(par_04/10000000)%10;  //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1534   1          str_pass.jx[0][2]=(par_04/1000000)%10;   //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬2å·ä»¶ä»¶å·
1535   1          str_pass.jx[0][3]=(par_04/100000)%10;    //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬3å·ä»¶ä»¶å·
1536   1          str_pass.jx[0][4]=(par_04/10000)%10;     //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1537   1          str_pass.jx[4][1]=(par_04/1000)%10;      //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1538   1          str_pass.jx[4][2]=(par_04/100)%10;       //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬2å·ä»¶ä»¶å·
1539   1          str_pass.jx[4][3]=(par_04/10)%10;        //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬3å·ä»¶ä»¶å·
1540   1          str_pass.jx[4][4]=par_04%10;             //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1541   1          //ç›®çš„åŒºä»¶å·
1542   1          str_pass.jx[3][1]=(par_37/10000000)%10;  //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1543   1          str_pass.jx[3][2]=(par_37/1000000)%10;   //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬2å·ä»¶ä»¶å·
1544   1          str_pass.jx[3][3]=(par_37/100000)%10;    //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬3å·ä»¶ä»¶å·
1545   1          str_pass.jx[3][4]=(par_37/10000)%10;     //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1546   1          str_pass.jx[7][1]=(par_37/1000)%10;      //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1547   1          str_pass.jx[7][2]=(par_37/100)%10;       //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬2å·ä»¶ä»¶å·
1548   1          str_pass.jx[7][3]=(par_37/10)%10;        //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬3å·ä»¶ä»¶å·
1549   1          str_pass.jx[7][4]=par_37%10;             //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1550   1          //ç›®çš„æ¬¡åº
1551   1          str_end.jx[3][1]=1;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬1å·ç›®çš„æ¬¡åºå·(æœ€é«˜ä½)
1552   1          str_end.jx[3][2]=2;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬2å·ç›®çš„æ¬¡åºå·
1553   1          str_end.jx[3][3]=3;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬3å·ç›®çš„æ¬¡åºå·
1554   1          str_end.jx[3][4]=4;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬4å·ç›®çš„æ¬¡åºå·(æœ€ä½ä½)
1555   1          str_end.jx[7][1]=5;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬1å·ç›®çš„æ¬¡åºå·(æœ€é«˜ä½)
1556   1          str_end.jx[7][2]=6;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬2å·ç›®çš„æ¬¡åºå·
1557   1          str_end.jx[7][3]=7;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬3å·ç›®çš„æ¬¡åºå·
1558   1          str_end.jx[7][4]=8;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬4å·ç›®çš„æ¬¡åºå·(æœ€ä½ä½)
1559   1      
1560   1          for(loc_xh1=1;loc_xh1<=4;loc_xh1++){
1561   2              if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][1])&&(str_pass.jx[0][loc_xh1]!=0))
1562   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][1];
1563   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][2])&&(str_pass.jx[0][loc_xh1]!=0))
1564   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][2];
1565   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][3])&&(str_pass.jx[0][loc_xh1]!=0))
1566   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][3];
1567   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][4])&&(str_pass.jx[0][loc_xh1]!=0))
1568   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][4];
1569   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][1])&&(str_pass.jx[0][loc_xh1]!=0))
1570   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][1];
1571   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][2])&&(str_pass.jx[0][loc_xh1]!=0))
1572   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][2];
1573   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][3])&&(str_pass.jx[0][loc_xh1]!=0))
1574   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][3];
1575   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][4])&&(str_pass.jx[0][loc_xh1]!=0))
1576   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][4];
1577   2      
1578   2              if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][1])&&(str_pass.jx[4][loc_xh1]!=0))
1579   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][1];
1580   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][2])&&(str_pass.jx[4][loc_xh1]!=0))
1581   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][2];
1582   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][3])&&(str_pass.jx[4][loc_xh1]!=0))
1583   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][3];
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 27  

1584   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][4])&&(str_pass.jx[4][loc_xh1]!=0))
1585   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][4];
1586   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][1])&&(str_pass.jx[4][loc_xh1]!=0))
1587   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][1];
1588   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][2])&&(str_pass.jx[4][loc_xh1]!=0))
1589   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][2];
1590   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][3])&&(str_pass.jx[4][loc_xh1]!=0))
1591   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][3];
1592   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][4])&&(str_pass.jx[4][loc_xh1]!=0))
1593   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][4];
1594   2          }//é€šè¿‡å®é™…ä»¶åºè·å¾—ç¼–å·
1595   1      
1596   1          memset(str_pass.jx,0,sizeof(str_pass.jx));//æ¸…ç©ºç°åœ¨å®é™…ä»¶åº
1597   1          for(loc_xh1=1;loc_xh1<=4;loc_xh1++){
1598   2              str_pass.jx[0][loc_xh1]=str_end.jx[0][loc_xh1];
1599   2              str_pass.jx[4][loc_xh1]=str_end.jx[4][loc_xh1];
1600   2          }//å°†ç°åœ¨çš„ä»¶åºä»str_end.jxä¸­æ‹¿åˆ°str_pass.jx
1601   1          for(loc_xh1=1;loc_xh1<=4;loc_xh1++){
1602   2              str_end.jx[0][loc_xh1]=0;
1603   2              str_end.jx[4][loc_xh1]=0;
1604   2          }//åˆ é™¤str_end.jxä¸­ç°åœ¨çš„ä»¶åº
1605   1          loc_high[0]=loc_high[4]=1;//åªæœ‰0å·å’Œ4å·æ”¾æ»¡äº†ä»¶
1606   1          loc_xh1=0;//å¾ªç¯æ ‡å¿—ä½å½’é›¶
1607   1      
1608   1          /*
1609   1              åˆ°ç›®å‰ä¸ºæ­¢å‡†å¤‡å·¥ä½œç»“æŸ,ç°åœ¨çš„æ•°ç»„ä¸­æ²¡æœ‰å®é™…ä»¶åº,
1610   1              ç°åœ¨çš„ç¼–å·åœ¨str_pass.jxä¸­,
1611   1              æƒ³è¦å¾—åˆ°çš„ç»“æœä»¶åºç¼–å·åœ¨str_end.jxä¸­
1612   1          */
1613   1          while(1){
1614   2              //é€€å‡ºæ¡ä»¶
1615   2              if((str_pass.jx[3][1]==str_end.jx[3][1])&&
1616   2              (str_pass.jx[3][2]==str_end.jx[3][2])&&
1617   2              (str_pass.jx[3][3]==str_end.jx[3][3])&&
1618   2              (str_pass.jx[3][4]==str_end.jx[3][4])&&
1619   2              (str_pass.jx[7][1]==str_end.jx[7][1])&&
1620   2              (str_pass.jx[7][2]==str_end.jx[7][2])&&
1621   2              (str_pass.jx[7][3]==str_end.jx[7][3])&&
1622   2              (str_pass.jx[7][4]==str_end.jx[7][4])){
1623   3                  if(str_begin.hzfx==dir_left){
1624   4                      fun_sz(han_s);                 //æ‰‹æŠ“æ¾
1625   4                      fun_sj(sjp_1);                 //å‡é™åˆ°æœ€é«˜ä½
1626   4                      fun_zjzt(mot_pyhz,7);           //å¹³é¢ä½ç½®7
1627   4                      fun_zjzt(mot_sj,loc_high[7]);   //å‡é™åˆ°7çš„æœ€é«˜ä½
1628   4                      fun_sz(han_j);                 //æ‰‹æŠ“ç´§
1629   4                  }//å¦‚æœåœåœ¨å·¦è¾¹
1630   3                  return;
1631   3              }//å¦‚æœå°è½¦ä¸€æ–¹çš„å®é™…ä»¶åºå’Œæƒ³è¦è¾¾åˆ°çš„ä»¶åºç›¸ç­‰
1632   2              if(str_begin.hzfx==dir_left){
1633   3                  //è½¬å‘æ¡ä»¶
1634   3                  loc_xh1++;//æ ‡å¿—ä½+1
1635   3                  if(loc_xh1>=100){
1636   4                      loc_xh1=0;
1637   4                      fun_zjzt(mot_sj,fun_min(loc_high[0],loc_high[1],loc_high[2],loc_high[3],loc_high[4],loc_hi
             -gh[5],loc_high[6],loc_high[7],def_end)-1);
1638   4                      fun_hz(dir_right);
1639   4                  }
1640   3                  //å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,ä¸éœ€è¦ä¸­é—´ä½çš„
1641   3                  if(loc_high[1]<5){
1642   4                      if(str_pass.jx[1][loc_high[1]]==str_end.jx[3][loc_high[3]-1]){
1643   5                          fun_najian(1,3,loc_high,str_pass.jx);//1-->3
1644   5                          continue;
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 28  

1645   5                      }
1646   4                  }//å¦‚æœåŒº1æœ‰ä»¶
1647   3                  if(loc_high[2]<5){
1648   4                      if(str_pass.jx[2][loc_high[2]]==str_end.jx[3][loc_high[3]-1]){
1649   5                          fun_najian(2,3,loc_high,str_pass.jx);//2-->3
1650   5                          continue;
1651   5                      }
1652   4                  }//å¦‚æœåŒº2æœ‰ä»¶
1653   3                  if(loc_high[0]<5){
1654   4                      if(str_pass.jx[0][loc_high[0]]==str_end.jx[3][loc_high[3]-1]){
1655   5                          fun_najian(0,3,loc_high,str_pass.jx);//0-->3
1656   5                          continue;
1657   5                      }
1658   4                      if(str_pass.jx[0][loc_high[0]]==str_end.jx[7][loc_high[7]-1]){
1659   5                          fun_najian(0,7,loc_high,str_pass.jx);//0-->7
1660   5                          continue;
1661   5                      }
1662   4                  }//å¦‚æœåŒº0æœ‰ä»¶
1663   3      
1664   3                  //ä¸å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,éœ€è¦ä¸­é—´ä½çš„
1665   3                  if(loc_high[0]<5){
1666   4                      if((str_pass.jx[0][loc_high[0]]==str_end.jx[3][1])||
1667   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[3][2])||
1668   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[3][3])||
1669   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[3][4])){
1670   5                          if(((loc_high[1]==5)||//å¦‚æœ1åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1671   5                          (str_pass.jx[0][loc_high[0]]>str_pass.jx[1][loc_high[1]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§äº1å
             -Œºçš„ç¼–å·å¹¶ä¸”
1672   5                          (loc_high[1]>2)){//1åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1673   6                              fun_najian(0,1,loc_high,str_pass.jx);//0-->1
1674   6                              continue;
1675   6                          }
1676   5                          if(((loc_high[2]==5)||//å¦‚æœ2åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1677   5                          (str_pass.jx[0][loc_high[0]]>str_pass.jx[2][loc_high[2]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§äº2å
             -Œºçš„ç¼–å·å¹¶ä¸”
1678   5                          (loc_high[2]>2)){//2åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1679   6                              fun_najian(0,2,loc_high,str_pass.jx);//0-->2
1680   6                              continue;
1681   6                          }
1682   5                      }//å¦‚æœè¦æ”¾åœ¨3ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1683   4                      if((str_pass.jx[0][loc_high[0]]==str_end.jx[7][1])||
1684   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[7][2])||
1685   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[7][3])||
1686   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[7][4])){
1687   5                          if(((loc_high[5]==5)||//å¦‚æœ5åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1688   5                          (str_pass.jx[0][loc_high[0]]>str_pass.jx[5][loc_high[5]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§äº5å
             -Œºçš„ç¼–å·å¹¶ä¸”
1689   5                          (loc_high[5]>2)){//5åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1690   6                              fun_najian(0,5,loc_high,str_pass.jx);//0-->5
1691   6                              continue;
1692   6                          }
1693   5                          if(((loc_high[6]==5)||//å¦‚æœ6åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1694   5                          (str_pass.jx[0][loc_high[0]]>str_pass.jx[6][loc_high[6]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§äº6å
             -Œºçš„ç¼–å·å¹¶ä¸”
1695   5                          (loc_high[6]>2)){//6åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1696   6                              fun_najian(0,6,loc_high,str_pass.jx);//0-->6
1697   6                              continue;
1698   6                          }
1699   5                      }//å¦‚æœè¦æ”¾åœ¨7ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1700   4                  }//å¦‚æœåŒº0æœ‰ä»¶
1701   3      
1702   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®ä¹Ÿä¸èƒ½ä¸€æ¬¡æå®šçš„
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 29  

1703   3                  if((loc_high[1]<5)&&(loc_high[2]<5)){
1704   4                      if((str_pass.jx[1][loc_high[1]]>str_pass.jx[2][loc_high[2]])&&(loc_high[2]>1)){
1705   5                          fun_najian(1,2,loc_high,str_pass.jx);//1-->2
1706   5                          continue;
1707   5                      }//1çš„ä»¶æ¯”2çš„ä»¶å¤§ä¸”åŒº2æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1708   4                      if((str_pass.jx[2][loc_high[2]]>str_pass.jx[1][loc_high[1]])&&(loc_high[1]>1)){
1709   5                          fun_najian(2,1,loc_high,str_pass.jx);//2-->1
1710   5                          continue;
1711   5                      }//2çš„ä»¶æ¯”1çš„ä»¶å¤§ä¸”åŒº1æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1712   4                  }//å¦‚æœåŒº1å’ŒåŒº2éƒ½æœ‰ä»¶
1713   3      
1714   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®æ€ä¹ˆä¹Ÿæä¸å®šçš„
1715   3                  if((loc_high[1]<5)&&(loc_high[2]<5)){
1716   4                      if((loc_high[0]>1)&&(str_pass.jx[1][loc_high[1]]>str_pass.jx[0][loc_high[0]])){
1717   5                          fun_najian(1,0,loc_high,str_pass.jx);//1-->0
1718   5                          continue;
1719   5                      }//1åŒºçš„ä»¶æ¯”0åŒºçš„å¤§ä¸”0åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1720   4                      if((loc_high[0]>1)&&(str_pass.jx[2][loc_high[2]]>str_pass.jx[0][loc_high[0]])){
1721   5                          fun_najian(2,0,loc_high,str_pass.jx);//2-->0
1722   5                          continue;
1723   5                      }//2åŒºçš„ä»¶æ¯”0åŒºçš„å¤§ä¸”0åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1724   4                  }
1725   3              }//å¦‚æœå›è½¬åœ¨å·¦è¾¹ 
1726   2              if(str_begin.hzfx==dir_right){
1727   3                  //è½¬å‘æ¡ä»¶
1728   3                  loc_xh1++;//æ ‡å¿—ä½+1
1729   3                  if(loc_xh1>=100){
1730   4                      loc_xh1=0;
1731   4                      fun_zjzt(mot_sj,fun_min(loc_high[0],loc_high[1],loc_high[2],loc_high[3],loc_high[4],loc_hi
             -gh[5],loc_high[6],loc_high[7],def_end)-1);
1732   4                      fun_hz(dir_left);
1733   4                  }
1734   3                  //å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,ä¸éœ€è¦ä¸­é—´ä½çš„
1735   3                  if(loc_high[5]<5){
1736   4                      if(str_pass.jx[5][loc_high[5]]==str_end.jx[7][loc_high[7]-1]){
1737   5                          fun_najian(5,7,loc_high,str_pass.jx);//5-->7
1738   5                          continue;
1739   5                      }//5-->7
1740   4                  }//å¦‚æœåŒº5æœ‰ä»¶
1741   3                  if(loc_high[6]<5){
1742   4                      if(str_pass.jx[6][loc_high[6]]==str_end.jx[7][loc_high[7]-1]){
1743   5                          fun_najian(6,7,loc_high,str_pass.jx);//6-->7
1744   5                          continue;
1745   5                      }//6-->7
1746   4                  }//å¦‚æœåŒº6æœ‰ä»¶
1747   3                  if(loc_high[4]<5){
1748   4                      if(str_pass.jx[4][loc_high[4]]==str_end.jx[7][loc_high[7]-1]){
1749   5                          fun_najian(4,7,loc_high,str_pass.jx);//4-->7
1750   5                          continue;
1751   5                      }//4-->7
1752   4                      if(str_pass.jx[4][loc_high[4]]==str_end.jx[3][loc_high[3]-1]){
1753   5                          fun_najian(4,3,loc_high,str_pass.jx);//4-->3
1754   5                          continue;
1755   5                      }//4-->3
1756   4                  }//å¦‚æœåŒº4æœ‰ä»¶
1757   3      
1758   3                  //ä¸å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,éœ€è¦ä¸­é—´ä½çš„
1759   3                  if(loc_high[4]<5){
1760   4                      if((str_pass.jx[4][loc_high[4]]==str_end.jx[7][1])||
1761   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[7][2])||
1762   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[7][3])||
1763   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[7][4])){
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 30  

1764   5                          if(((loc_high[5]==5)||//å¦‚æœ5åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1765   5                          (str_pass.jx[4][loc_high[4]]>str_pass.jx[5][loc_high[5]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§äº5å
             -Œºçš„ç¼–å·å¹¶ä¸”
1766   5                          (loc_high[5]>2)){//5åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1767   6                              fun_najian(4,5,loc_high,str_pass.jx);//4-->5
1768   6                              continue;
1769   6                          }
1770   5                          if(((loc_high[6]==5)||//å¦‚æœ6åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1771   5                          (str_pass.jx[4][loc_high[4]]>str_pass.jx[6][loc_high[6]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§äº6å
             -Œºçš„ç¼–å·å¹¶ä¸”
1772   5                          (loc_high[6]>2)){//6åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1773   6                              fun_najian(4,6,loc_high,str_pass.jx);//4-->6
1774   6                              continue;
1775   6                          }
1776   5                      }//å¦‚æœè¦æ”¾åœ¨7ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1777   4                      if((str_pass.jx[4][loc_high[4]]==str_end.jx[3][1])||
1778   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[3][2])||
1779   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[3][3])||
1780   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[3][4])){
1781   5                          if(((loc_high[1]==5)||//å¦‚æœ1åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1782   5                          (str_pass.jx[4][loc_high[4]]>str_pass.jx[1][loc_high[1]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§äº1å
             -Œºçš„ç¼–å·å¹¶ä¸”
1783   5                          (loc_high[1]>2)){//1åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1784   6                              fun_najian(4,1,loc_high,str_pass.jx);//4-->1
1785   6                              continue;
1786   6                          }
1787   5                          if(((loc_high[2]==5)||//å¦‚æœ2åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1788   5                              (str_pass.jx[4][loc_high[4]]>str_pass.jx[2][loc_high[2]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§ä
             -º2åŒºçš„ç¼–å·å¹¶ä¸”
1789   5                              (loc_high[2]>2)){//2åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1790   6                              fun_najian(4,2,loc_high,str_pass.jx);//4-->2
1791   6                              continue;
1792   6                          }
1793   5                      }//å¦‚æœè¦æ”¾åœ¨3ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1794   4                  }//å¦‚æœåŒº4æœ‰ä»¶
1795   3      
1796   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®ä¹Ÿä¸èƒ½ä¸€æ¬¡æå®šçš„
1797   3                  if((loc_high[5]<5)&&(loc_high[6]<5)){
1798   4                      if((str_pass.jx[5][loc_high[5]]>str_pass.jx[6][loc_high[6]])&&(loc_high[6]>1)){
1799   5                          fun_najian(5,6,loc_high,str_pass.jx);//5-->6
1800   5                          continue;
1801   5                      }//5çš„ä»¶æ¯”6çš„ä»¶å¤§ä¸”åŒº6æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1802   4                      if((str_pass.jx[6][loc_high[6]]>str_pass.jx[5][loc_high[5]])&&(loc_high[5]>1)){
1803   5                          fun_najian(6,5,loc_high,str_pass.jx);//6-->5
1804   5                          continue;
1805   5                      }//6çš„ä»¶æ¯”5çš„ä»¶å¤§ä¸”åŒº5æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1806   4                  }//å¦‚æœåŒº5å’ŒåŒº6éƒ½æœ‰ä»¶
1807   3      
1808   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®æ€ä¹ˆä¹Ÿæä¸å®šçš„
1809   3                  if((loc_high[5]<5)&&(loc_high[6]<5)){
1810   4                      if((loc_high[4]>1)&&(str_pass.jx[5][loc_high[5]]>str_pass.jx[4][loc_high[4]])){
1811   5                          fun_najian(5,4,loc_high,str_pass.jx);//5-->4
1812   5                          continue;
1813   5                      }//5åŒºçš„ä»¶æ¯”4åŒºçš„å¤§ä¸”4åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1814   4                      if((loc_high[4]>1)&&(str_pass.jx[6][loc_high[6]]>str_pass.jx[4][loc_high[4]])){
1815   5                          fun_najian(6,4,loc_high,str_pass.jx);//6-->4
1816   5                          continue;
1817   5                      }//6åŒºçš„ä»¶æ¯”4åŒºçš„å¤§ä¸”4åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1818   4                  }
1819   3              }//å¦‚æœå›è½¬åœ¨å³è¾¹
1820   2          }    
1821   1      }//è‡ªåŠ¨æŠ“ä»¶
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 31  

1822          void fun_zjzt(uc par_motor,char par_model){
1823   1          if(par_motor==mot_pyhz){
1824   2              switch(par_model){
1825   3                  case 0:
1826   3                      if((str_begin.pywz==tra_h)&&(str_begin.hzfx==dir_left))
1827   3                          break;
1828   3                      if(str_begin.hzfx==dir_right)
1829   3                          fun_pyhz(tra_z,dir_left);
1830   3                      fun_py(tra_h);
1831   3                      break;
1832   3                  case 1:
1833   3                      if((str_begin.pywz==tra_kh)&&(str_begin.hzfx==dir_left))
1834   3                          break;
1835   3                      if(str_begin.hzfx==dir_right)
1836   3                          fun_pyhz(tra_z,dir_left);
1837   3                      fun_py(tra_kh);
1838   3                      break;
1839   3                  case 2:
1840   3                      if((str_begin.pywz==tra_kq)&&(str_begin.hzfx==dir_left))
1841   3                          break;
1842   3                      if(str_begin.hzfx==dir_right)
1843   3                          fun_pyhz(tra_z,dir_left);
1844   3                      fun_py(tra_kq);
1845   3                      break;
1846   3                  case 3:
1847   3                      if((str_begin.pywz==tra_q)&&(str_begin.hzfx==dir_left))
1848   3                          break;
1849   3                      if(str_begin.hzfx==dir_right)
1850   3                          fun_pyhz(tra_z,dir_left);
1851   3                      fun_py(tra_q);
1852   3                      break;
1853   3                  case 4:
1854   3                      if((str_begin.pywz==tra_q)&&(str_begin.hzfx==dir_right))
1855   3                          break;
1856   3                      if(str_begin.hzfx==dir_left)
1857   3                          fun_pyhz(tra_z,dir_right);
1858   3                      fun_py(tra_q);
1859   3                      break;
1860   3                  case 5:
1861   3                      if((str_begin.pywz==tra_kq)&&(str_begin.hzfx==dir_right))
1862   3                          break;
1863   3                      if(str_begin.hzfx==dir_left)
1864   3                          fun_pyhz(tra_z,dir_right);
1865   3                      fun_py(tra_kq);
1866   3                      break;
1867   3                  case 6:
1868   3                      if((str_begin.pywz==tra_kh)&&(str_begin.hzfx==dir_right))
1869   3                          break;
1870   3                      if(str_begin.hzfx==dir_left)
1871   3                          fun_pyhz(tra_z,dir_right);
1872   3                      fun_py(tra_kh);
1873   3                      break;
1874   3                  case 7:
1875   3                      if((str_begin.pywz==tra_h)&&(str_begin.hzfx==dir_right))
1876   3                          break;
1877   3                      if(str_begin.hzfx==dir_left)
1878   3                          fun_pyhz(tra_z,dir_right);
1879   3                      fun_py(tra_h);
1880   3                      break;
1881   3                  default:
1882   3                      break;
1883   3              }
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 32  

1884   2          }
1885   1          else if(par_motor==mot_sj){
1886   2              switch(par_model){
1887   3                  case 0:
1888   3                      fun_sj(sjp_1);
1889   3                      break;
1890   3                  case 1:
1891   3                      fun_sj(sjp_2);
1892   3                      break;
1893   3                  case 2:
1894   3                      fun_sj(sjp_3);
1895   3                      break;
1896   3                  case 3:
1897   3                      fun_sj(sjp_4);
1898   3                      break;
1899   3                  case 4:
1900   3                      fun_sj(sjp_5);
1901   3                      break;
1902   3                  default:
1903   3                      if(par_model<0)
1904   3                          fun_sj(sjp_1);
1905   3                      else if(par_model>5)
1906   3                          fun_sj(sjp_5);
1907   3                      break;
1908   3              }
1909   2          }
1910   1      }//æŠ“ä»¶çŠ¶æ€,0ä¸ºå·¦ä¸Šä½,3ä¸ºå·¦ä¸‹ä½,4ä¸ºå³ä¸Šä½,7ä¸ºå³ä¸‹ä½
1911          void fun_najian(uc par_now,uc par_next,char par_high[8],uc par_data[8][5]){
1912   1          #ifdef Debug
                      printf("%d --> %d\n",(ui)par_now,(ui)par_next);
                  #else
1915   1              //å–å„ä½ç½®çš„æœ€é«˜ä½
1916   1              uc loc_high=fun_min(par_high[0],par_high[1],par_high[2],par_high[3],par_high[4],par_high[5],par_hi
             -gh[6],par_high[7],def_end);
1917   1              //å‡èµ·
1918   1              if(par_now==0||par_now==1||par_now==2||par_now==3){
1919   2                  if(str_begin.hzfx==dir_left)
1920   2                      fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],par_high[3],def_end)-1);
1921   2                  else if(str_begin.hzfx==dir_right)
1922   2                      fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],par_high[3],par_high[4],par_hi
             -gh[5],par_high[6],par_high[7],def_end)-1);            
1923   2              }
1924   1              else if(par_now==4||par_now==5||par_now==6||par_now==7){
1925   2                  if(str_begin.hzfx==dir_right)
1926   2                      fun_zjzt(mot_sj,fun_min(par_high[4],par_high[5],par_high[6],par_high[7],def_end)-1);
1927   2                  else if(str_begin.hzfx==dir_left)
1928   2                      fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],par_high[3],par_high[4],par_hi
             -gh[5],par_high[6],par_high[7],def_end)-1);            
1929   2              }
1930   1              //å¹³ç§»å›è½¬åˆ°éœ€è¦çš„åœ°æ–¹
1931   1              fun_zjzt(mot_pyhz,par_now);
1932   1              //ä¸‹é™åˆ°å·¥ä»¶çš„ä½ç½®
1933   1              fun_zjzt(mot_sj,par_high[par_now]);
1934   1              //æŠ“ç´§å·¥ä»¶
1935   1              fun_sz(han_j);
1936   1              //ä¸Šå‡åˆ°æ­£ç¡®çš„æœ€é«˜ä½
1937   1              switch(par_now){
1938   2                  case 0:
1939   2                      switch(par_next){
1940   3                          case 1:
1941   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 33  

1942   3                              break;
1943   3                          case 2:
1944   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[par_ne
             -xt],def_end)-2);
1945   3                              break;
1946   3                          case 3:
1947   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[2],par
             -_high[par_next],def_end)-2);
1948   3                              break;
1949   3                          case 4:
1950   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[5],par
             -_high[par_next],def_end)-2);
1951   3                              break;
1952   3                          case 5:
1953   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[par_ne
             -xt],def_end)-2);
1954   3                              break;
1955   3                          case 6:
1956   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[par_ne
             -xt],def_end)-2);
1957   3                              break;
1958   3                          case 7:
1959   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[6],par
             -_high[par_next],def_end)-2);
1960   3                              break;
1961   3                          default:
1962   3                              break;
1963   3                      }
1964   2                      break;
1965   2                  case 1:
1966   2                      switch(par_next){
1967   3                          case 0:
1968   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
1969   3                              break;
1970   3                          case 2:
1971   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
1972   3                              break;
1973   3                          case 3:
1974   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[par_ne
             -xt],def_end)-2);
1975   3                              break;
1976   3                          case 4:
1977   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[par_ne
             -xt],def_end)-2);
1978   3                              break;
1979   3                          case 5:
1980   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
1981   3                              break;
1982   3                          case 6:
1983   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
1984   3                              break;
1985   3                          case 7:
1986   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[par_ne
             -xt],def_end)-2);
1987   3                              break;
1988   3                          default:
1989   3                              break;
1990   3                      }
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 34  

1991   2                      break;
1992   2                  case 2:
1993   2                      switch(par_next){
1994   3                          case 0:
1995   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[par_ne
             -xt],def_end)-2);
1996   3                              break;
1997   3                          case 1:
1998   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
1999   3                              break;
2000   3                          case 3:
2001   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2002   3                              break;
2003   3                          case 4:
2004   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[par_ne
             -xt],def_end)-2);
2005   3                              break;
2006   3                          case 5:
2007   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2008   3                              break;
2009   3                          case 6:
2010   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2011   3                              break;
2012   3                          case 7:
2013   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[par_ne
             -xt],def_end)-2);
2014   3                              break;
2015   3                          default:
2016   3                              break;
2017   3                      }
2018   2                      break;
2019   2                  case 3:
2020   2                      switch(par_next){
2021   3                          case 0:
2022   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[1],par
             -_high[par_next],def_end)-2);
2023   3                              break;
2024   3                          case 1:
2025   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[par_ne
             -xt],def_end)-2);
2026   3                              break;
2027   3                          case 2:
2028   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2029   3                              break;
2030   3                          case 4:
2031   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[5],par
             -_high[par_next],def_end)-2);
2032   3                              break;
2033   3                          case 5:
2034   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[par_ne
             -xt],def_end)-2);
2035   3                              break;
2036   3                          case 6:
2037   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[par_ne
             -xt],def_end)-2);
2038   3                              break;
2039   3                          case 7:
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 35  

2040   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[6],par
             -_high[par_next],def_end)-2);
2041   3                              break;
2042   3                          default:
2043   3                              break;
2044   3                      }
2045   2                      break;
2046   2                  case 4:
2047   2                      switch(par_next){
2048   3                          case 0:
2049   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[1],par
             -_high[par_next],def_end)-2);
2050   3                              break;
2051   3                          case 1:
2052   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[par_ne
             -xt],def_end)-2);
2053   3                              break;
2054   3                          case 2:
2055   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[par_ne
             -xt],def_end)-2);
2056   3                              break;
2057   3                          case 3:
2058   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[2],par
             -_high[par_next],def_end)-2);
2059   3                              break;
2060   3                          case 5:
2061   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2062   3                              break;
2063   3                          case 6:
2064   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[par_ne
             -xt],def_end)-2);
2065   3                              break;
2066   3                          case 7:
2067   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[6],par
             -_high[par_next],def_end)-2);
2068   3                              break;
2069   3                          default:
2070   3                              break;
2071   3                      }
2072   2                      break;
2073   2                  case 5:
2074   2                      switch(par_next){
2075   3                          case 0:
2076   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[par_ne
             -xt],def_end)-2);
2077   3                              break;
2078   3                          case 1:
2079   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2080   3                              break;
2081   3                          case 2:
2082   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2083   3                              break;
2084   3                          case 3:
2085   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[par_ne
             -xt],def_end)-2);
2086   3                              break;
2087   3                          case 4:
2088   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 36  

2089   3                              break;
2090   3                          case 6:
2091   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2092   3                              break;
2093   3                          case 7:
2094   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[par_ne
             -xt],def_end)-2);
2095   3                              break;
2096   3                          default:
2097   3                              break;
2098   3                      }
2099   2                      break;
2100   2                  case 6:
2101   2                      switch(par_next){
2102   3                          case 0:
2103   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[1],par_high[par_ne
             -xt],def_end)-2);
2104   3                              break;
2105   3                          case 1:
2106   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2107   3                              break;
2108   3                          case 2:
2109   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2110   3                              break;
2111   3                          case 3:
2112   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[2],par_high[par_ne
             -xt],def_end)-2);
2113   3                              break;
2114   3                          case 4:
2115   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[par_ne
             -xt],def_end)-2);
2116   3                              break;
2117   3                          case 5:
2118   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2119   3                              break;
2120   3                          case 7:
2121   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2122   3                              break;
2123   3                          default:
2124   3                              break;
2125   3                      }
2126   2                      break;
2127   2                  case 7:
2128   2                      switch(par_next){
2129   3                          case 0:
2130   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[1],par
             -_high[par_next],def_end)-2);
2131   3                              break;
2132   3                          case 1:
2133   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[par_ne
             -xt],def_end)-2);
2134   3                              break;
2135   3                          case 2:
2136   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[par_ne
             -xt],def_end)-2);
2137   3                              break;
2138   3                          case 3:
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 37  

2139   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[2],par
             -_high[par_next],def_end)-2);
2140   3                              break;
2141   3                          case 4:
2142   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[5],par_high[6],par
             -_high[par_next],def_end)-2);
2143   3                              break;
2144   3                          case 5:
2145   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[6],par_high[par_ne
             -xt],def_end)-2);
2146   3                              break;
2147   3                          case 6:
2148   3                              fun_zjzt(mot_sj,fun_min(loc_high+2,par_high[par_now]+1,par_high[par_next],def_end)
             --2);
2149   3                              break;
2150   3                          default:
2151   3                              break;
2152   3                      }
2153   2                      break;
2154   2                  default:
2155   2                      break;
2156   2              }
2157   1              //å¹³ç§»å›è½¬è‡³æ”¾ä»¶å¤„
2158   1              fun_zjzt(mot_pyhz,par_next);
2159   1              //ä¸‹é™åˆ°è¦æ”¾ä¸‹çš„ä½ç½®
2160   1              fun_zjzt(mot_sj,par_high[par_next]-1);
2161   1              //æ¾å¼€æ‰‹æŠ“
2162   1              fun_sz(han_s);
2163   1          #endif
2164   1      
2165   1          //æ›´æ–°å‚æ•°
2166   1          par_data[par_next][par_high[par_next]-1]=par_data[par_now][par_high[par_now]];
2167   1          par_data[par_now][par_high[par_now]]=0;
2168   1          par_high[par_now]++;
2169   1          par_high[par_next]--;
2170   1      }//æ‹¿ä»¶(é…åˆè‡ªåŠ¨æŠ“ä»¶ä½¿ç”¨)
2171          void fun_zhuajian(){
2172   1          fun_sz(han_s);                 //æ‰‹æŠ“æ¾
2173   1          fun_sj(sjp_1);                 //ä¸Šå‡åˆ°æœ€é«˜ä½
2174   1          fun_py(tra_q);                 //å¹³ç§»åˆ°å‰ç«¯
2175   1          if(str_begin.hzfx!=dir_right)   //å¦‚æœä¸åœ¨å³è¾¹
2176   1              fun_hz(dir_right);         //å°±å¹³ç§»åˆ°å³è¾¹
2177   1      
2178   1          fun_folline(2,60);
2179   1          fun_turn(tur_l90,40);
2180   1          fun_folline(1,60);
2181   1          fun_qc(100,40);
2182   1          while((!in_ls4||!in_ls5)||(in_ls1||in_ls2||in_ls3||in_ls6||in_ls7||in_ls8)){
2183   2              if(in_ls1||in_ls2||in_ls3||!in_ls5){
2184   3                  fun_motors(mot_rl,-30);
2185   3                  fun_delay(300,del_ms);
2186   3                  fun_motors(mot_r,-20);
2187   3                  fun_motors(mot_l,-30);
2188   3                  fun_delay(300,del_ms);
2189   3                  fun_motors(mot_rl,-30);
2190   3                  fun_delay(300,del_ms);
2191   3              }//3äº®æˆ–5ä¸äº®
2192   2              else if(in_ls6||in_ls7||in_ls8||!in_ls4){
2193   3                  fun_motors(mot_rl,-30);
2194   3                  fun_delay(300,del_ms);
2195   3                  fun_motors(mot_r,-30);
2196   3                  fun_motors(mot_l,-29);
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 38  

2197   3                  fun_delay(300,del_ms);
2198   3                  fun_motors(mot_rl,-30);
2199   3                  fun_delay(300,del_ms);
2200   3              }//6äº®æˆ–4ä¸äº®
2201   2              fun_qc(150,40);//é‡æ–°è¿›è¡Œå‰å†²
2202   2          }
2203   1          fun_motors(mot_rl,0);
2204   1      }//ä»èµ·å§‹åŒºèµ°åˆ°æŠ“ä»¶åŒº
2205          void fun_back(){
2206   1          fun_motors(mot_rl,-25);
2207   1          fun_delay(1,del_s);
2208   1      
2209   1          fun_motors(mot_r,-48);
2210   1          fun_motors(mot_l,-20);
2211   1          fun_delay(3,del_s);    
2212   1      
2213   1          fun_motors(mot_rl,-35);
2214   1          fun_delay(1,del_s);
2215   1      }//ä»æŠ“ä»¶åŒºå›åˆ°èµ·å§‹åŒº
2216          void fun_start(char par_x,char par_y,enum varENU_dir par_ctfx,enum varENU_han par_szzt,enum varENU_sjp par
             -_sjwz,enum varENU_tra par_pywz,enum varENU_dir par_hzfx){
2217   1          CLK_DIV=0x00;             //ä¸åˆ†é¢‘
2218   1          P0M1=0xff;                //P0ç”¨äºè¾“å…¥
2219   1          P0M0=0x00;                //P0ä¸èƒ½è¾“å‡º
2220   1          P1M1=0x00;                //P1å£0-1åŒå‘
2221   1          P1M0=0xfc;                //P1å£2-7è¾“å‡º
2222   1          P2M1=0xf0;                //P2å£4-7è¾“å…¥
2223   1          P2M0=0x0f;                //P2å£0-3è¾“å‡º
2224   1      
2225   1          out_en1=1;                //ç”µæœº1/3ä½¿èƒ½
2226   1          out_en2=1;                //ç”µæœº2/4ä½¿èƒ½
2227   1          CR=0;                     //PACè®¡æ•°å™¨å½’é›¶
2228   1          out_motorselect=0;        //ç”µæœºç‰‡é€‰ä¸º0
2229   1      
2230   1          #ifdef Debug              //å¦‚æœæ˜¯è°ƒè¯•æ¨¡å¼
                      fun_port();           //åˆå§‹åŒ–ä¸²å£
                      TI=1;                 //æ‰“å¼€ä¸²å£ä¼ è¾“åŠŸèƒ½        
                  #endif
2234   1          fun_pwminit();            //PWMçš„åˆå§‹åŒ–
2235   1          fun_timer0init();         //åˆå§‹åŒ–å®šæ—¶å™¨0
2236   1          fun_timer1init();         //åˆå§‹åŒ–å®šæ—¶å™¨1
2237   1      
2238   1          TR0=1;                    //æ‰“å¼€å®šæ—¶å™¨0
2239   1          TR1=1;                    //æ‰“å¼€å®šæ—¶å™¨1
2240   1          in_start=1;               //æŒ‰é”®ç½®1
2241   1      
2242   1          str_begin.x=par_x;        //Xåæ ‡
2243   1          str_begin.y=par_y;        //Yåæ ‡
2244   1          str_begin.ctfx=par_ctfx;  //è½¦å¤´æ–¹å‘
2245   1          str_begin.szzt=par_szzt;  //æ‰‹æŠ“çŠ¶æ€
2246   1          str_begin.sjwz=par_sjwz;  //å‡é™ä½ç½®
2247   1          str_begin.pywz=par_pywz;  //å¹³ç§»ä½ç½®
2248   1          str_begin.hzfx=par_hzfx;  //å›è½¬æ–¹å‘
2249   1      
2250   1          str_tfl.gospeed=0;        //é€Ÿåº¦å½’é›¶
2251   1          fun_motors(mot_sz,0);     //æ‰‹æŠ“é€Ÿåº¦å½’é›¶
2252   1          fun_motors(mot_py,0);     //å¹³ç§»é€Ÿåº¦å½’é›¶
2253   1          fun_motors(mot_sj,0);     //æ‰‹æŠ“é€Ÿåº¦å½’é›¶
2254   1          fun_motors(mot_hz,0);     //æ‰‹æŠ“é€Ÿåº¦å½’é›¶
2255   1          fun_motors(mot_rl,0);     //å·¦å³é€Ÿåº¦å½’é›¶
2256   1      
2257   1          #ifdef Debug              //å¦‚æœå¼€å¯è°ƒè¯•æ¨¡å¼
C51 COMPILER V9.54   8023                                                                  10/08/2015 11:58:08 PAGE 39  

                      fun_delay(5,del_s);
                      MSG("Ready!")         //è¾“å‡ºReady!
                  #else
2261   1              fun_wait();           //ç­‰å¾…æŒ‰é”®
2262   1          #endif
2263   1      }//åˆå§‹åŒ–å‡½æ•°
2264          void fun_stop(){
2265   1          EA=0;                   //å…³æ€»ä¸­æ–­
2266   1          str_tfl.gospeed=0;      //é€Ÿåº¦å½’é›¶
2267   1          fun_motors(mot_sz,0);   //æ‰‹æŠ“é€Ÿåº¦å½’é›¶
2268   1          fun_motors(mot_py,0);   //å¹³ç§»é€Ÿåº¦å½’é›¶
2269   1          fun_motors(mot_sj,0);   //æ‰‹æŠ“é€Ÿåº¦å½’é›¶
2270   1          fun_motors(mot_hz,0);   //æ‰‹æŠ“é€Ÿåº¦å½’é›¶
2271   1          fun_motors(mot_rl,0);   //å·¦å³é€Ÿåº¦å½’é›¶
2272   1          MSG("End!")             //è¾“å‡ºEnd!
2273   1          while(1);               //æ­»å¾ªç¯
2274   1      }//ç»“æŸå‡½æ•°


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =  15591    ----
   CONSTANT SIZE    =      9    ----
   XDATA SIZE       =    150     242
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5      11
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  3 WARNING(S),  0 ERROR(S)
