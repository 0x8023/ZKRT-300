C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE 8023
OBJECT MODULE PLACED IN .\output\8023.obj
COMPILER INVOKED BY: D:\MyProgram\keil\C51\BIN\C51.EXE program\8023.c OPTIMIZE(8,SPEED) DEBUG OBJECTEXTEND PRINT(.\8023.
                    -lst) OBJECT(.\output\8023.obj)

line level    source

   1          #include "./output/8023.h"
   2          xdata struct str_state str_begin,str_now,str_next;//åˆ†åˆ«ä¸º:èµ·å§‹çŠ¶æ€/å½“å‰çŠ¶æ€/ç›®æ ‡çŠ¶æ€
   3          xdata struct str_parameter str_cod={
   4              /*ui str_cod.mlinerqd*/25000,//é»˜è®¤ä¸»å‡½æ•°å·¡çº¿è½¯èµ·åŠ¨è·¯ç¨‹ä¸º25000
   5              /*ui str_cod.mlineqc*/200,   //é»˜è®¤ä¸»å‡½æ•°å·¡çº¿å‰å†²æ—¶é—´ä¸º500æ¯«ç§’
   6          
   7              /*ui str_cod.sj1bzw*/58,     //å‡é™æ ‡å‡†ä½å»¶æ—¶
   8              /*ui str_cod.sj1zjw*/800,    //å‡é™ä¸­é—´ä½å»¶æ—¶
   9          
  10              /*ui str_cod.py1bz*/20,      //fun_py1æ ‡å‡†ä½å»¶æ—¶
  11              /*ui str_cod.py1qkq*/666,    //fun_py1å‰åˆ°é å‰å»¶æ—¶å‚æ•°
  12              /*ui str_cod.py1kqz*/684,    //fun_py1é å‰åˆ°ä¸­é—´å»¶æ—¶
  13              /*ui str_cod.py1zkh*/684,    //fun_py1ä¸­é—´åˆ°é åå»¶æ—¶
  14              /*ui str_cod.py1khh*/666,    //fun_py1é ååˆ°åå»¶æ—¶
  15              /*ui str_cod.py1qz*/500,     //fun_py1å‰åˆ°ä¸­é—´å»¶æ—¶
  16              /*ui str_cod.py1zh*/500,     //fun_py1ä¸­é—´åˆ°åå»¶æ—¶
  17              /*ui str_cod.py1kqkh*/1480,  //fun_py1é å‰åˆ°é åå»¶æ—¶
  18              /*ui str_cod.py1qkh*/2122,   //fun_py1å‰åˆ°é åå»¶æ—¶
  19              /*ui str_cod.py1kqh*/2122,   //fun_py1é å‰åˆ°åå»¶æ—¶
  20          
  21              /*ui str_cod.hz1bz*/20,      //fun_hz1æ ‡å‡†ä½å»¶æ—¶
  22          
  23              /*ui turn90;*/500,           //90åº¦è½¬å¼¯å±è”½å»¶æ—¶
  24              /*ui turn180;*/2000          //180åº¦è½¬å¼¯å±è”½å»¶æ—¶
  25          };
  26          xdata struct str_timerfolline str_tfl;
  27          ul var_timer=0;
  28          void fun_delay(ui par_value,enum varENU_del par_model){
  29   1          ui loc_con=par_value;
  30   1          switch(par_model){
  31   2              case del_us://å¾®ç§’çº§å»¶æ—¶
  32   2                  #ifdef Debug
                              printf("fun_delay(%d,del_us);\n",par_value);
                          #else
  35   2                      while(loc_con-->0){
  36   3                          _nop_();
  37   3                          _nop_();
  38   3                      }
  39   2                  #endif
  40   2                  return;
  41   2              case del_ms://æ¯«ç§’çº§å»¶æ—¶
  42   2                  #ifdef Debug
                              printf("fun_delay(%d,del_ms);\n",par_value);
                          #else
  45   2                      while(loc_con-->0){
  46   3                          uc loc_i, loc_j;
  47   3                          _nop_();
  48   3                          _nop_();
  49   3                          loc_i=12;
  50   3                          loc_j=168;
  51   3                          do{
  52   4                              while(--loc_j);
  53   4                          }while(--loc_i);
  54   3                      }
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 2   

  55   2                  #endif
  56   2                  return;
  57   2              case del_s://ç§’çº§å»¶æ—¶
  58   2                  #ifdef Debug
                              printf("fun_delay(%d,del_s);\n",par_value);
                          #else
  61   2                      while(loc_con-->0){
  62   3                          uc loc_i, loc_j, loc_k;
  63   3                          loc_i=46;
  64   3                          loc_j=153;
  65   3                          loc_k=245;
  66   3                          do{
  67   4                              do{
  68   5                                  while(--loc_k);
  69   5                              }while(--loc_j);
  70   4                          }while(--loc_i);
  71   3                      }
  72   2                  #endif
  73   2                  return;
  74   2              default:return;
  75   2          }
  76   1      }//å»¶æ—¶
  77          void fun_timer0init(){
  78   1          #ifdef Debug
                      printf("fun_timer0init();\n");
                  #endif
  81   1          AUXR|=0x80;   //å®šæ—¶å™¨æ—¶é’Ÿ1Tæ¨¡å¼
  82   1          TMOD&=0xF0;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  83   1          TMOD|=0x01;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  84   1          TL0=0x20;     //å®šæ—¶åˆå€¼:1ms
  85   1          TH0=0xD1;     //å®šæ—¶åˆå€¼:1ms
  86   1          TF0=0;        //æ¸…é™¤TF0æ ‡å¿—
  87   1          ET0=1;
  88   1          EA=1;         //å¼€å¯æ€»ä¸­æ–­
  89   1      }//1æ¯«ç§’å®šæ—¶å™¨0åˆå§‹åŒ–
  90          void fun_timer1init(){
  91   1          #ifdef Debug
                      printf("fun_timer1init();\n");
                  #endif
  94   1          AUXR&=0xBF;     //å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
  95   1          TMOD&=0x0F;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  96   1          TMOD|=0x10;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  97   1          TL1=0xE0;       //å®šæ—¶åˆå€¼:20ms
  98   1          TH1=0xB1;       //å®šæ—¶åˆå€¼:20ms
  99   1          TF1=0;          //æ¸…é™¤TF1æ ‡å¿—
 100   1          ET1=1;
 101   1          EA=1;           //å¼€å¯æ€»ä¸­æ–­
 102   1      }//20æ¯«ç§’å®šæ—¶å™¨1åˆå§‹åŒ–
 103          void fun_timer0(){
 104   1          TL0=0x20;
 105   1          TH0=0xD1;//å®šæ—¶å™¨åˆå€¼æ¢å¤è‡³1ms
 106   1          var_timer++;//å…¨å±€è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶
 107   1          if(str_tfl.doing==tf_ture)//å¦‚æœæ­£åœ¨ç§»åŠ¨
 108   1              fun_timermove();//å®šæ—¶å™¨ç§»åŠ¨
 109   1      }//1æ¯«ç§’å®šæ—¶å™¨0å¤„ç†å‡½æ•°
 110          void fun_timer1(){
 111   1          TL1=0xE0;
 112   1          TH1=0xB1;
 113   1      }//20æ¯«ç§’å®šæ—¶å™¨1å¤„ç†å‡½æ•°
 114          void fun_wait(){
 115   1          #ifdef Debug
                      printf("fun_wait();\n");
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 3   

                  #else
 118   1              while(in_start==1);
 119   1              fun_delay(20,del_ms);
 120   1              while(in_start==0);
 121   1              fun_delay(256,del_ms);
 122   1          #endif
 123   1      }//ç­‰å¾…æŒ‰é”®
 124          void fun_pwminit(){
 125   1          #ifdef Debug
                      printf("fun_pwminit();\n");
                  #endif
 128   1          CCON=0x00;//PACå¯„å­˜æ§åˆ¶å™¨
 129   1          CH=0;//é‡ç½®PACè®¡æ—¶å™¨
 130   1          CL=0;
 131   1          CMOD=0x08;//ä¸åˆ†é¢‘
 132   1      }//PWMåˆå§‹åŒ–
 133          void fun_pwmr(uc par_value){
 134   1          CCAP0H=CCAP0L=par_value*25/10;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 135   1          CCAPM0=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 136   1          PCA_PWM0=0x00;
 137   1      }//å³è·¯PWMè¾“å‡º
 138          void fun_pwml(uc par_value){
 139   1          CCAP1H=CCAP1L=par_value*25/10;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 140   1          CCAPM1=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 141   1          PCA_PWM1=0x00;
 142   1      }//å·¦è·¯PWMè¾“å‡º
 143          void fun_motors(enum varENU_mot par_model,char par_speed){
 144   1          if(par_speed>100)
 145   1              par_speed=100;
 146   1          else if(par_speed<-100)
 147   1              par_speed=-100;//é€Ÿåº¦æœ€å¤š100,æœ€å°‘-100
 148   1          switch(par_model){
 149   2              case mot_l://å·¦è½®ç”µæœº
 150   2                  if(str_begin.leftsd==par_speed)
 151   2                      return;
 152   2                  else
 153   2                      str_begin.leftsd=par_speed;
 154   2                  if(par_speed==0){
 155   3                      fun_pwml(0);out_pwml=0;
 156   3                  }
 157   2                  else if(par_speed>0){
 158   3                      CR=1;fun_pwml(par_speed);out_pwml=0;
 159   3                  }
 160   2                  else if(par_speed<0){
 161   3                      CR=1;fun_pwml(cabs(par_speed));out_pwml=1;
 162   3                  }
 163   2                  break;
 164   2              case mot_r://å³è½®ç”µæœº
 165   2                  if(str_begin.rightsd==par_speed)
 166   2                      return;
 167   2                  else
 168   2                      str_begin.rightsd=par_speed;
 169   2                  if(par_speed==0){
 170   3                      fun_pwmr(0);out_pwmr=0;
 171   3                  }
 172   2                  else if(par_speed>0){
 173   3                      CR=1;fun_pwmr(par_speed);out_pwmr=0;
 174   3                  }
 175   2                  else if(par_speed<0){
 176   3                      CR=1;fun_pwmr(cabs(par_speed));out_pwmr=1;
 177   3                  }
 178   2                  break;
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 4   

 179   2              case mot_rl://å·¦å³è½®åŒæ­¥
 180   2                  if((str_begin.leftsd==par_speed)&&(str_begin.rightsd==par_speed))
 181   2                      return;
 182   2                  else
 183   2                      str_begin.leftsd=str_begin.rightsd=par_speed;
 184   2                  if(par_speed==0){
 185   3                      CR=0;
 186   3                      fun_pwmr(0);out_pwmr=0;
 187   3                      fun_pwml(0);out_pwml=0;
 188   3                  }
 189   2                  else if(par_speed>0){
 190   3                      CR=1;
 191   3                      fun_pwml(par_speed);out_pwml=0;
 192   3                      fun_pwmr(par_speed);out_pwmr=0;
 193   3                  }
 194   2                  else if(par_speed<0){
 195   3                      CR=1;
 196   3                      fun_pwml(cabs(par_speed));out_pwml=1;
 197   3                      fun_pwmr(cabs(par_speed));out_pwmr=1;
 198   3                  }
 199   2                  break;
 200   2              case mot_sz://æ­£è½¬ä¸ºæŠ“ç´§ï¼Œåè½¬ä¸ºæ¾å¼€
 201   2                  if(str_begin.szsd==par_speed)
 202   2                      return;
 203   2                  else
 204   2                      str_begin.szsd=par_speed;
 205   2                  if(par_speed==0){
 206   3                      out_motorselect=1;out_dir1=0;out_en1=1;
 207   3                  }
 208   2                  else if(par_speed>0){
 209   3                      out_motorselect=1;out_dir1=1;out_en1=0;
 210   3                  }
 211   2                  else if(par_speed<0){
 212   3                      out_motorselect=1;out_dir1=0;out_en1=0;
 213   3                  }
 214   2                  break;
 215   2              case mot_py://æ­£è½¬æ˜¯å‘æ— ç”µæœºä¸€æ–¹è½¬,åè½¬ä¸ºå‘æœ‰ç”µæœºä¸€æ–¹è½¬
 216   2                  if(str_begin.pysd==par_speed)
 217   2                      return;
 218   2                  else
 219   2                      str_begin.pysd=par_speed;
 220   2                  if(par_speed==0){
 221   3                      out_motorselect=1;out_dir2=0;out_en2=1;
 222   3                  }
 223   2                  else if(par_speed>0){
 224   3                      out_motorselect=1;out_dir2=1;out_en2=0;
 225   3                  }
 226   2                  else if(par_speed<0){
 227   3                      out_motorselect=1;out_dir2=0;out_en2=0;
 228   3                  }
 229   2                  break;
 230   2              case mot_sj://å‘ä¸Šä¸ºæ­£è½¬,å‘ä¸‹ä¸ºåè½¬
 231   2                  if(str_begin.sjsd==par_speed)
 232   2                      return;
 233   2                  else
 234   2                      str_begin.sjsd=par_speed;
 235   2                  if(par_speed==0){
 236   3                      out_motorselect=0;out_dir1=0;out_en1=1;
 237   3                  }
 238   2                  else if(par_speed>0){
 239   3                      out_motorselect=0;out_dir1=0;out_en1=0;
 240   3                  }
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 5   

 241   2                  else if(par_speed<0){
 242   3                      out_motorselect=0;out_dir1=1;out_en1=0;
 243   3                  }
 244   2                  break;
 245   2              case mot_hz://é¡ºæ—¶é’ˆä¸ºæ­£è½¬,é€†æ—¶é’ˆä¸ºåè½¬
 246   2                  if(str_begin.hzsd==par_speed)
 247   2                      return;
 248   2                  else
 249   2                      str_begin.hzsd=par_speed;
 250   2                  if(par_speed==0){
 251   3                      out_motorselect=0;out_dir2=0;out_en2=1;
 252   3                  }
 253   2                  else if(par_speed>0){
 254   3                      out_motorselect=0;out_dir2=0;out_en2=0;
 255   3                  }
 256   2                  else if(par_speed<0){
 257   3                      out_motorselect=0;out_dir2=1;out_en2=0;
 258   3                  }
 259   2                  break;
 260   2              default:
 261   2                  break;
 262   2          }
 263   1      }//ä¸»å‡½æ•°æ“ä½œç”µæœº
 264          void fun_motorsrl(enum varENU_mot par_model,char par_speed){
 265   1          if(par_speed>100)
 266   1              par_speed=100;
 267   1          else if(par_speed<-100)
 268   1              par_speed=-100;//é€Ÿåº¦æœ€å¤š100,æœ€å°‘-100
 269   1          switch(par_model){
 270   2              case mot_l://å·¦è½®ç”µæœº
 271   2                  if(str_begin.leftsd==par_speed)
 272   2                      return;
 273   2                  else
 274   2                      str_begin.leftsd=par_speed;
 275   2                  if(par_speed==0){
 276   3                      fun_pwml(0);out_pwml=0;
 277   3                  }
 278   2                  else if(par_speed>0){
 279   3                      CR=1;fun_pwml(par_speed);out_pwml=0;
 280   3                  }
 281   2                  else if(par_speed<0){
 282   3                      CR=1;fun_pwml(cabs(par_speed));out_pwml=1;
 283   3                  }
 284   2                  break;
 285   2              case mot_r://å³è½®ç”µæœº
 286   2                  if(str_begin.rightsd==par_speed)
 287   2                      return;
 288   2                  else
 289   2                      str_begin.rightsd=par_speed;
 290   2                  if(par_speed==0){
 291   3                      fun_pwmr(0);out_pwmr=0;
 292   3                  }
 293   2                  else if(par_speed>0){
 294   3                      CR=1;fun_pwmr(par_speed);out_pwmr=0;
 295   3                  }
 296   2                  else if(par_speed<0){
 297   3                      CR=1;fun_pwmr(cabs(par_speed));out_pwmr=1;
 298   3                  }
 299   2                  break;
 300   2              case mot_rl://å·¦å³è½®åŒæ­¥
 301   2                  if((str_begin.leftsd==par_speed)&&(str_begin.rightsd==par_speed))
 302   2                      return;
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 6   

 303   2                  else
 304   2                      str_begin.leftsd=str_begin.rightsd=par_speed;
 305   2                  if(par_speed==0){
 306   3                      CR=0;
 307   3                      fun_pwmr(0);out_pwmr=0;
 308   3                      fun_pwml(0);out_pwml=0;
 309   3                  }
 310   2                  else if(par_speed>0){
 311   3                      CR=1;
 312   3                      fun_pwml(par_speed);out_pwml=0;
 313   3                      fun_pwmr(par_speed);out_pwmr=0;
 314   3                  }
 315   2                  else if(par_speed<0){
 316   3                      CR=1;
 317   3                      fun_pwml(cabs(par_speed));out_pwml=1;
 318   3                      fun_pwmr(cabs(par_speed));out_pwmr=1;
 319   3                  }
 320   2                  break;
 321   2              default:
 322   2                  break;
 323   2          }
 324   1      }//å®šæ—¶å™¨æ“ä½œå·¦å³è½®
 325          void fun_sz1(enum varENU_han par_model){
 326   1          if(str_begin.szzt==par_model)
 327   1              return;
 328   1          if(par_model==han_s){//æ‰‹æŠ“æ¾
 329   2              fun_motors(mot_sz,-100);
 330   2              while(in_s==1);
 331   2          }
 332   1          else{//æ‰‹æŠ“ç´§
 333   2              fun_motors(mot_sz,100);
 334   2              while(in_j==1);
 335   2          }
 336   1          fun_delay(20,del_ms);
 337   1          fun_motors(mot_sz,0);
 338   1          str_begin.szzt=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 339   1      }//æ‰‹æŠ“å•æ­¥è¿åŠ¨
 340          void fun_py1(enum varENU_tra par_model){
 341   1          if(str_begin.pywz==par_model)
 342   1              return;
 343   1          switch(par_model){
 344   2              case tra_q://å‰å¹³ç§»(æ²¡æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 345   2                  fun_motors(mot_py,100);
 346   2                  while(in_qpy==1);
 347   2                  fun_delay(str_cod.py1bz,del_ms);
 348   2                  break;
 349   2              case tra_kq:
 350   2                  switch(str_begin.pywz){
 351   3                      case tra_q:
 352   3                          fun_motors(mot_py,-100);
 353   3                          fun_delay(str_cod.py1qkq,del_ms);
 354   3                          break;
 355   3                      case tra_z:
 356   3                          fun_motors(mot_py,100);
 357   3                          fun_delay(str_cod.py1kqz,del_ms);
 358   3                          break;
 359   3                      case tra_kh:
 360   3                          fun_motors(mot_py,100);
 361   3                          fun_delay(str_cod.py1kqkh,del_ms);
 362   3                          break;
 363   3                      case tra_h:
 364   3                          fun_motors(mot_py,100);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 7   

 365   3                          fun_delay(str_cod.py1kqh,del_ms);
 366   3                          break;
 367   3                  }
 368   2                  break;
 369   2              case tra_z:
 370   2                  switch(str_begin.pywz){
 371   3                      case tra_q:
 372   3                          fun_motors(mot_py,-100);
 373   3                          fun_delay(str_cod.py1qz,del_ms);
 374   3                          break;
 375   3                      case tra_kq:
 376   3                          fun_motors(mot_py,-100);
 377   3                          fun_delay(str_cod.py1kqz,del_ms);
 378   3                          break;
 379   3                      case tra_kh:
 380   3                          fun_motors(mot_py,100);
 381   3                          fun_delay(str_cod.py1zkh,del_ms);
 382   3                          break;
 383   3                      case tra_h:
 384   3                          fun_motors(mot_py,100);
 385   3                          fun_delay(str_cod.py1zh,del_ms);
 386   3                          break;
 387   3                  }
 388   2                  break;
 389   2              case tra_kh:
 390   2                  switch(str_begin.pywz){
 391   3                      case tra_q:
 392   3                          fun_motors(mot_py,-100);
 393   3                          fun_delay(str_cod.py1qkh,del_ms);
 394   3                          break;
 395   3                      case tra_kq:
 396   3                          fun_motors(mot_py,-100);
 397   3                          fun_delay(str_cod.py1kqkh,del_ms);
 398   3                          break;
 399   3                      case tra_z:
 400   3                          fun_motors(mot_py,-100);
 401   3                          fun_delay(str_cod.py1zkh,del_ms);
 402   3                          break;
 403   3                      case tra_h:
 404   3                          fun_motors(mot_py,100);
 405   3                          fun_delay(str_cod.py1khh,del_ms);
 406   3                          break;
 407   3                  }
 408   2                  break;
 409   2              case tra_h://åå¹³ç§»(æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 410   2                  fun_motors(mot_py,-100);
 411   2                  while(in_hpy==1);
 412   2                  fun_delay(str_cod.py1bz,del_ms);
 413   2                  break;
 414   2              default:
 415   2                  break;
 416   2          }
 417   1          fun_motors(mot_py,0);
 418   1          str_begin.pywz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 419   1      }//å¹³ç§»å•æ­¥è¿åŠ¨
 420          void fun_sj1(enum varENU_sjp par_model){
 421   1          if(str_begin.sjwz==par_model)
 422   1             return;
 423   1          switch(par_model){
 424   2              case sjp_1://å‡é™ä½ç½®1(æœ€ä¸Šä½)
 425   2                  fun_motors(mot_sj,100);
 426   2                  def_select(sel_58);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 8   

 427   2                  while(in_wz1==1);
 428   2                  fun_delay(str_cod.sj1bzw,del_ms);
 429   2                  break;
 430   2              case sjp_12:
 431   2                  if(par_model>str_begin.sjwz){
 432   3                      fun_motors(mot_sj,-100);
 433   3                      fun_delay(str_cod.sj1zjw,del_ms);
 434   3                  }
 435   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 436   3                      fun_sj1(sjp_2);
 437   3                      fun_motors(mot_sj,100);
 438   3                      fun_delay(str_cod.sj1zjw,del_ms);
 439   3                  }
 440   2                  break;
 441   2              case sjp_2://å‡é™ä½ç½®2
 442   2                  fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 443   2                  def_select(sel_58);
 444   2                  while(in_wz2==1);
 445   2                  fun_delay(str_cod.sj1bzw,del_ms);
 446   2                  break;
 447   2              case sjp_23:
 448   2                  if(par_model>str_begin.sjwz){
 449   3                      fun_sj1(sjp_2);
 450   3                      fun_motors(mot_sj,-100);
 451   3                      fun_delay(str_cod.sj1zjw,del_ms);
 452   3                  }
 453   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 454   3                      fun_sj1(sjp_3);
 455   3                      fun_motors(mot_sj,100);
 456   3                      fun_delay(str_cod.sj1zjw,del_ms);
 457   3                  }
 458   2                  break;
 459   2              case sjp_3://å‡é™ä½ç½®3
 460   2                  fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 461   2                  def_select(sel_58);
 462   2                  while(in_wz3==1);
 463   2                  fun_delay(str_cod.sj1bzw,del_ms);
 464   2                  break;
 465   2              case sjp_34:
 466   2                  if(par_model>str_begin.sjwz){
 467   3                      fun_sj1(sjp_3);
 468   3                      fun_motors(mot_sj,-100);
 469   3                      fun_delay(str_cod.sj1zjw,del_ms);
 470   3                  }
 471   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 472   3                      fun_sj1(sjp_4);
 473   3                      fun_motors(mot_sj,100);
 474   3                      fun_delay(str_cod.sj1zjw,del_ms);
 475   3                  }
 476   2                  break;
 477   2              case sjp_4://å‡é™ä½ç½®4
 478   2                  fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 479   2                  def_select(sel_58);
 480   2                  while(in_wz4==1);
 481   2                  fun_delay(str_cod.sj1bzw,del_ms);
 482   2                  break;
 483   2              case sjp_45:
 484   2                  if(par_model>str_begin.sjwz){
 485   3                      fun_sj1(sjp_4);
 486   3                      fun_motors(mot_sj,-100);
 487   3                      fun_delay(str_cod.sj1zjw,del_ms);
 488   3                  }
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 9   

 489   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 490   3                      fun_motors(mot_sj,100);
 491   3                      fun_delay(str_cod.sj1zjw,del_ms);
 492   3                  }
 493   2                  break;
 494   2              case sjp_5://å‡é™ä½ç½®5
 495   2                  fun_motors(mot_sj,-100);
 496   2                  def_select(sel_912);
 497   2                  while(in_wz5==1);
 498   2                  fun_delay(str_cod.sj1bzw,del_ms);
 499   2                  break;
 500   2              default:
 501   2                  break;
 502   2          }
 503   1          fun_motors(mot_sj,0);
 504   1          str_begin.sjwz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 505   1      }//å‡é™å•æ­¥è¿åŠ¨
 506          void fun_hz1(enum varENU_dir par_model){
 507   1          if(str_begin.hzfx==par_model)
 508   1              return;
 509   1          def_select(sel_912);
 510   1          switch(par_model){
 511   2              case dir_up://å›è½¬è‡³å‰æ–¹
 512   2                  switch(str_begin.hzfx){
 513   3                      case dir_down://ç°åœ¨åœ¨ä¸‹æ–¹
 514   3                          fun_motors(mot_hz,-100);
 515   3                          fun_delay(1,del_s);
 516   3                          while(in_hz==1);
 517   3                          while(in_hz==0);
 518   3                          while(in_hz==1);
 519   3                          fun_delay(str_cod.hz1bz,del_ms);
 520   3                          break;
 521   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 522   3                          fun_motors(mot_hz,100);
 523   3                          fun_delay(1,del_s);
 524   3                          while(in_hz==1);
 525   3                          fun_delay(str_cod.hz1bz,del_ms);
 526   3                          break;
 527   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 528   3                          fun_motors(mot_hz,-100);
 529   3                          fun_delay(1,del_s);
 530   3                          while(in_hz==1);
 531   3                          fun_delay(str_cod.hz1bz,del_ms);
 532   3                          break;
 533   3                      default:
 534   3                          break;
 535   3                  }
 536   2                  break;
 537   2              case dir_down://è¦å»ä¸‹é¢
 538   2                  switch(str_begin.hzfx){
 539   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 540   3                          fun_motors(mot_hz,100);
 541   3                          fun_delay(1,del_s);
 542   3                          while(in_hz==1);
 543   3                          while(in_hz==0);
 544   3                          while(in_hz==1);
 545   3                          fun_delay(str_cod.hz1bz,del_ms);
 546   3                          break;
 547   3                      case dir_left://ç°åœ¨åœ¨å·¦é¢
 548   3                          fun_motors(mot_hz,-100);
 549   3                          fun_delay(1,del_s);
 550   3                          while(in_hz==1);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 10  

 551   3                          fun_delay(str_cod.hz1bz,del_ms);
 552   3                          break;
 553   3                          break;
 554   3                      case dir_right://ç°åœ¨åœ¨å³é¢
 555   3                          fun_motors(mot_hz,100);
 556   3                          fun_delay(1,del_s);
 557   3                          while(in_hz==1);
 558   3                          fun_delay(str_cod.hz1bz,del_ms);
 559   3                          break;
 560   3                      default:
 561   3                          break;
 562   3                  }
 563   2                  break;
 564   2              case dir_left://è¦å»å·¦è¾¹
 565   2                  switch(str_begin.hzfx){
 566   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 567   3                          fun_motors(mot_hz,-100);
 568   3                          fun_delay(1,del_s);
 569   3                          while(in_hz==1);
 570   3                          fun_delay(str_cod.hz1bz,del_ms);
 571   3                          break;
 572   3                          break;
 573   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 574   3                          fun_motors(mot_hz,100);
 575   3                          fun_delay(1,del_s);
 576   3                          while(in_hz==1);
 577   3                          fun_delay(str_cod.hz1bz,del_ms);
 578   3                          break;
 579   3                          break;
 580   3                      case dir_right://ç°åœ¨åœ¨å³é¢
 581   3                          fun_motors(mot_hz,-100);
 582   3                          fun_delay(1,del_s);
 583   3                          while(in_hz==1);
 584   3                          while(in_hz==0);
 585   3                          while(in_hz==1);
 586   3                          fun_delay(str_cod.hz1bz,del_ms);
 587   3                          break;
 588   3                      default:
 589   3                          break;
 590   3                  }
 591   2                  break;
 592   2              case dir_right://è¦å»å³é¢
 593   2                  switch(str_begin.hzfx){
 594   3                      case dir_up://ç°åœ¨åœ¨å‰é¢
 595   3                          fun_motors(mot_hz,100);
 596   3                          fun_delay(1,del_s);
 597   3                          while(in_hz==1);
 598   3                          fun_delay(str_cod.hz1bz,del_ms);
 599   3                          break;
 600   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 601   3                          fun_motors(mot_hz,-100);
 602   3                          fun_delay(1,del_s);
 603   3                          while(in_hz==1);
 604   3                          fun_delay(str_cod.hz1bz,del_ms);
 605   3                          break;
 606   3                      case dir_left://ç°åœ¨åœ¨å·¦é¢
 607   3                          fun_motors(mot_hz,100);
 608   3                          fun_delay(1,del_s);
 609   3                          while(in_hz==1);
 610   3                          while(in_hz==0);
 611   3                          while(in_hz==1);
 612   3                          fun_delay(str_cod.hz1bz,del_ms);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 11  

 613   3                          break;
 614   3                      default:
 615   3                          break;
 616   3                  }
 617   2                  break;
 618   2              default:
 619   2                  break;
 620   2          }
 621   1          fun_motors(mot_hz,0);
 622   1          str_begin.hzfx=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 623   1      }//å›è½¬å•æ­¥è¿åŠ¨
 624          void fun_pyhz2(enum varENU_tra par_pymodel,enum varENU_dir par_hzmodel){
 625   1          switch(par_hzmodel){
 626   2              case dir_left://è¦å»å·¦è¾¹
 627   2                  switch(str_begin.hzfx){
 628   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 629   3                      
 630   3                          break;
 631   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 632   3                      
 633   3                          break;
 634   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 635   3                      
 636   3                          break;
 637   3                      default:
 638   3                          break;
 639   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 640   2                  break;
 641   2              case dir_right://è¦å»å³è¾¹
 642   2                  switch(str_begin.hzfx){
 643   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 644   3                      
 645   3                          break;
 646   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 647   3                      
 648   3                          break;
 649   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 650   3                      
 651   3                          break;
 652   3                      default:
 653   3                          break;
 654   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 655   2                  break;
 656   2              case dir_up://è¦å»ä¸Šé¢
 657   2                  switch(str_begin.hzfx){
 658   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 659   3                      
 660   3                          break;
 661   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 662   3                      
 663   3                          break;
 664   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 665   3                      
 666   3                          break;
 667   3                      default:
 668   3                          break;
 669   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 670   2                  break;
 671   2              case dir_down://è¦å»ä¸‹é¢
 672   2                  switch(str_begin.hzfx){
 673   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 674   3                      
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 12  

 675   3                          break;
 676   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 677   3                      
 678   3                          break;
 679   3                      case dir_up://ç°åœ¨åœ¨ä¸‹é¢
 680   3                      
 681   3                          break;
 682   3                      default:
 683   3                          break;
 684   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 685   2                  break;
 686   2              default:
 687   2                  break;
 688   2          }//è·å–ç°åœ¨è¦å»çš„å›è½¬ä½ç½®
 689   1          switch(par_pymodel){
 690   2              case tra_q://è¦å»å‰é¢
 691   2              
 692   2                  break;
 693   2              case tra_kq://è¦å»é å‰
 694   2              
 695   2                  break;
 696   2              case tra_z://è¦å»ä¸­é—´
 697   2              
 698   2                  break;
 699   2              case tra_kh://è¦å»é å
 700   2              
 701   2                  break;
 702   2              case tra_h://è¦å»åé¢
 703   2              
 704   2                  break;
 705   2              default:
 706   2                  break;
 707   2          }//è·å–ç°åœ¨å¹³ç§»æ‰€åœ¨çš„ä½ç½®
 708   1          switch(par_hzmodel){
 709   2              case dir_left://è¦å»å·¦è¾¹
 710   2                  switch(str_begin.hzfx){
 711   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 712   3                      
 713   3                          break;
 714   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 715   3                      
 716   3                          break;
 717   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 718   3                      
 719   3                          break;
 720   3                      default:
 721   3                          break;
 722   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 723   2                  break;
 724   2              case dir_right://è¦å»å³è¾¹
 725   2                  switch(str_begin.hzfx){
 726   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 727   3                      
 728   3                          break;
 729   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 730   3                      
 731   3                          break;
 732   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 733   3                      
 734   3                          break;
 735   3                      default:
 736   3                          break;
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 13  

 737   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 738   2                  break;
 739   2              case dir_up://è¦å»ä¸Šé¢
 740   2                  switch(str_begin.hzfx){
 741   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 742   3                      
 743   3                          break;
 744   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 745   3                      
 746   3                          break;
 747   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 748   3                      
 749   3                          break;
 750   3                      default:
 751   3                          break;
 752   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 753   2                  break;
 754   2              case dir_down://è¦å»ä¸‹é¢
 755   2                  switch(str_begin.hzfx){
 756   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 757   3                      
 758   3                          break;
 759   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 760   3                      
 761   3                          break;
 762   3                      case dir_up://ç°åœ¨åœ¨ä¸‹é¢
 763   3                      
 764   3                          break;
 765   3                      default:
 766   3                          break;
 767   3                  }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 768   2                  break;
 769   2              default:
 770   2                  break;
 771   2          }//è·å–ç°åœ¨è¦å»çš„å›è½¬ä½ç½®
 772   1      }//å¹³ç§»å›è½¬åŒæ­¥è¿åŠ¨
 773          void fun_jtjp(){
 774   1          while(1){
 775   2              if((!in_ls1&&!in_ls2&&in_ls4&&in_ls5&&!in_ls7&&!in_ls8)&&((in_ls3&&in_ls6)||(!in_ls3&&!in_ls6))){
 776   3                  fun_delay(10,del_ms);
 777   3                  fun_motors(mot_rl,0);
 778   3                  return;
 779   3              }
 780   2              if(in_ls2||in_ls1){
 781   3                  fun_motors(mot_l,16);
 782   3                  fun_motors(mot_r,-16);
 783   3              }
 784   2              else if(in_ls7||in_ls8){
 785   3                  fun_motors(mot_l,-16);
 786   3                  fun_motors(mot_r,16);
 787   3              }
 788   2              else{
 789   3                  if(!in_ls4){
 790   4                      fun_motors(mot_l,-12);
 791   4                      fun_motors(mot_r,12);
 792   4                  }
 793   3                  else if(!in_ls5){
 794   4                      fun_motors(mot_l,12);
 795   4                      fun_motors(mot_r,-12);
 796   4                  }
 797   3                  else{
 798   4                      if(in_ls6&&!in_ls3){
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 14  

 799   5                          fun_motors(mot_l,-8);
 800   5                          fun_motors(mot_r,8);
 801   5                      }
 802   4                      if(in_ls3&&!in_ls6){
 803   5                          fun_motors(mot_l,8);
 804   5                          fun_motors(mot_r,-8);
 805   5                      }
 806   4                  }
 807   3              }
 808   2          }
 809   1      }//é™æ€çº å
 810          void fun_timermove(){
 811   1          static uc loc_con=0;//éœ€è¦åˆ†æ­¥åšçš„åŠ¨ä½œéœ€è¦ç”¨åˆ°æ­¤é™æ€ç§æœ‰åˆ†æ­¥æ ‡å¿—ä½
 812   1          uc loc_sdl,loc_sdr;//å·¦è½®é€Ÿåº¦å’Œå³è½®é€Ÿåº¦çš„å±€éƒ¨å˜é‡
 813   1          switch(*str_tfl.run){//é€‰æ‹©è¿è¡Œæ–¹å¼
 814   2              case def_end://è¿è¡Œç»“æŸ
 815   2                  fun_motorsrl(mot_rl,0);//å†æ¬¡åœæ­¢ç”µæœºè¿åŠ¨
 816   2                  str_tfl.doing=tf_false;//ç§»åŠ¨ç»“æŸ
 817   2                  memset(str_tfl.step,0,sizeof(str_tfl.step));//æ¸…ç©ºstepæ•°ç»„
 818   2                  str_tfl.run=str_tfl.step;//æŒ‡é’ˆæŒ‡å‘stepçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
 819   2                  break;
 820   2              case tfl_line://è¿è¡Œå·¡çº¿
 821   2                  if(*(str_tfl.run+1)){//å¦‚æœå‚æ•°ä¸ºé0æ•°
 822   3                      if((in_ls1||in_ls8)&&(in_ls2&&in_ls3&&in_ls4&&in_ls5&in_ls6&&in_ls7)){//å¦‚æœä¸­é—´6ä¸ªç
             -¯å…¨äº®,å·¦å³äº®ä»»æ„ä¸€ä¸ª
 823   4                          str_tfl.online=tf_ture;//æ ‡å¿—ä½è®°å½•åœ¨çº¿
 824   4                          fun_motorsrl(mot_rl,str_tfl.gospeed);//æŒ‰ç…§å¸¸è§„é€Ÿåº¦è¿‡çº¿
 825   4                      }
 826   3                      else if(str_tfl.online==tf_ture){//å¦‚æœæ ‡å¿—ä½è®°å½•åœ¨çº¿,è€Œä¸”ä¸ç¬¦åˆåœ¨çº¿ç‰¹å¾
 827   4                          str_tfl.online=tf_false;//æ ‡å¿—ä½è®°å½•ä¸åœ¨çº¿
 828   4                          (*(str_tfl.run+1))--;//å‚æ•°å€¼å‡1,è®°å½•å·²ç»èµ°äº†ä¸€æ¡çº¿
 829   4                      }
 830   3                      else{
 831   4                          loc_sdl=loc_sdr=str_tfl.gospeed;//å·¡çº¿é€Ÿåº¦ä¸ºstr_tfl.gospeed
 832   4                          if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
 833   5                              loc_sdl*=0.5;//å·¦å‡é€Ÿ
 834   5                              loc_sdr*=1.5;//å³åŠ é€Ÿ
 835   5                          }//å‘å·¦è½¬
 836   4                          if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
 837   5                              loc_sdl*=1.5;//å·¦åŠ é€Ÿ
 838   5                              loc_sdr*=0.5;//å³å‡é€Ÿ
 839   5                          }//å‘å³è½¬
 840   4                          if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
 841   5                              loc_sdl*=0.7;//å·¦å‡é€Ÿ
 842   5                              loc_sdr*=1.3;//å³åŠ é€Ÿ
 843   5                          }//å‘å·¦è½¬
 844   4                          if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
 845   5                              loc_sdl*=1.3;//å·¦åŠ é€Ÿ
 846   5                              loc_sdr*=0.7;//å³å‡é€Ÿ
 847   5                          }//å‘å³è½¬
 848   4                          if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
 849   5                              loc_sdl*=0.9;//å·¦å‡é€Ÿ
 850   5                              loc_sdr*=1.1;//å³åŠ é€Ÿ
 851   5                          }//å‘å·¦è½¬
 852   4                          if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
 853   5                              loc_sdl*=1.1;//å·¦åŠ é€Ÿ
 854   5                              loc_sdr*=0.9;//å³å‡é€Ÿ
 855   5                          }//å‘å³è½¬
 856   4                          fun_motorsrl(mot_r,loc_sdr);
 857   4                          fun_motorsrl(mot_l,loc_sdl);
 858   4                      }
 859   3                  }
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 15  

 860   2                  else{//å¦‚æœçº¿èµ°å®Œäº†
 861   3                      str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 862   3                      fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœºè¿åŠ¨
 863   3                  }
 864   2                  break;
 865   2              case tfl_turn://è¿è¡Œè½¬å¼¯
 866   2                  switch(loc_con){//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½
 867   3                      case 0://ç¬¬ä¸€æ­¥
 868   3                          switch(*(str_tfl.run+1)){//è·å–å‚æ•°
 869   4                              case tur_r90://å³è½¬90
 870   4                                  fun_motorsrl(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
 871   4                                  fun_motorsrl(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
 872   4                                  str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
 873   4                                  break;
 874   4                              case tur_l90://å·¦è½¬90
 875   4                                  fun_motorsrl(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
 876   4                                  fun_motorsrl(mot_r,str_tfl.turnspeed);//å³è½®å‘å‰
 877   4                                  str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
 878   4                                  break;
 879   4                              case tur_r180://å³è½¬180
 880   4                                  fun_motorsrl(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
 881   4                                  fun_motorsrl(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
 882   4                                  str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
 883   4                                  break;
 884   4                              case tur_l180://å·¦è½¬180
 885   4                                  fun_motorsrl(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
 886   4                                  fun_motorsrl(mot_r,str_tfl.turnspeed);//å·¦è½®å‘å‰
 887   4                                  str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
 888   4                                  break;
 889   4                          }
 890   3                          loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 891   3                          break;
 892   3                      case 1://ç¬¬äºŒæ­¥
 893   3                          if(str_tfl.delay<=var_timer)//è®¡æ—¶æ—¶é—´åˆ°
 894   3                              loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 895   3                          break;
 896   3                      case 2://ç¬¬ä¸‰æ­¥
 897   3                          if(in_ls4&&in_ls5){//å¦‚æœä¸­é—´ä¸¤ä¸ªç¯äº®
 898   4                              fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœº
 899   4                              str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 900   4                              str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
 901   4                              loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
 902   4                          }
 903   3                          break;
 904   3                  }
 905   2                  break;
 906   2              case tfl_cache://è¿è¡Œå‰å†²
 907   2                  switch(loc_con){
 908   3                      case 0://ç¬¬ä¸€æ­¥
 909   3                          str_tfl.delay=var_timer+((*(str_tfl.run+1))*10);//å»¶æ—¶æ—¶é—´(æ¯«ç§’)ä¸ºå‚æ•°çš„10å€
             -
 910   3                          loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 911   3                          break;
 912   3                      case 1://ç¬¬äºŒæ­¥
 913   3                          if(str_tfl.delay<=var_timer){//è®¡æ—¶æ—¶é—´åˆ°
 914   4                              fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœº
 915   4                              str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 916   4                              str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
 917   4                              loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
 918   4                          }
 919   3                          else{
 920   4                              loc_sdl=loc_sdr=str_tfl.cachespeed;//å‰å†²é€Ÿåº¦ä¸ºstr_tfl.cachespeed
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 16  

 921   4                              if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
 922   5                                  loc_sdl*=0.5;//å·¦å‡é€Ÿ
 923   5                                  loc_sdr*=1.5;//å³åŠ é€Ÿ
 924   5                              }//å‘å·¦è½¬
 925   4                              if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
 926   5                                  loc_sdl*=1.5;//å·¦åŠ é€Ÿ
 927   5                                  loc_sdr*=0.5;//å³å‡é€Ÿ
 928   5                              }//å‘å³è½¬
 929   4                              if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
 930   5                                  loc_sdl*=0.7;//å·¦å‡é€Ÿ
 931   5                                  loc_sdr*=1.3;//å³åŠ é€Ÿ
 932   5                              }//å‘å·¦è½¬
 933   4                              if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
 934   5                                  loc_sdl*=1.3;//å·¦åŠ é€Ÿ
 935   5                                  loc_sdr*=0.7;//å³å‡é€Ÿ
 936   5                              }//å‘å³è½¬
 937   4                              if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
 938   5                                  loc_sdl*=0.9;//å·¦å‡é€Ÿ
 939   5                                  loc_sdr*=1.1;//å³åŠ é€Ÿ
 940   5                              }//å‘å·¦è½¬
 941   4                              if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
 942   5                                  loc_sdl*=1.1;//å·¦åŠ é€Ÿ
 943   5                                  loc_sdr*=0.9;//å³å‡é€Ÿ
 944   5                              }//å‘å³è½¬
 945   4                              fun_motorsrl(mot_r,loc_sdr);
 946   4                              fun_motorsrl(mot_l,loc_sdl);
 947   4                          }
 948   3                          break;
 949   3                  }
 950   2                  break;
 951   2              case tfl_start://è¿è¡Œå¸¦åŠ é€Ÿçš„å‰å†²
 952   2      
 953   2                  break;
 954   2              case tfl_end://è¿è¡Œå¸¦å‡é€Ÿçš„å‰å†²
 955   2      
 956   2                  break;
 957   2          }
 958   1      }//å®šæ—¶å™¨ç§»åŠ¨
 959          void fun_folline(uc par_con,uc par_speed){
 960   1          uc loc_con=par_con;//å·¡çº¿æ¡æ•°æ ‡å¿—ä½
 961   1          uc loc_sdr,loc_sdl;//å·¦å³è½®é€Ÿåº¦
 962   1          uc loc_online;//åœ¨çº¿æ ‡å¿—ä½
 963   1          while(loc_con){
 964   2              if((in_ls1||in_ls8)&&(in_ls2&&in_ls3&&in_ls4&&in_ls5&in_ls6&&in_ls7)){//å¦‚æœä¸­é—´6ä¸ªç¯å…¨äº®,
             -å·¦å³äº®ä»»æ„ä¸€ä¸ª
 965   3                  loc_online=tf_ture;//æ ‡å¿—ä½è®°å½•åœ¨çº¿
 966   3                  fun_motors(mot_rl,par_speed);//æŒ‰ç…§å¸¸è§„é€Ÿåº¦è¿‡çº¿
 967   3              }
 968   2              else if(loc_online==tf_ture){//å¦‚æœæ ‡å¿—ä½è®°å½•åœ¨çº¿,è€Œä¸”ä¸ç¬¦åˆåœ¨çº¿ç‰¹å¾
 969   3                  loc_online=tf_false;//æ ‡å¿—ä½è®°å½•ä¸åœ¨çº¿
 970   3                  loc_con--;//å‚æ•°å€¼å‡1,è®°å½•å·²ç»èµ°äº†ä¸€æ¡çº¿
 971   3              }
 972   2              else{
 973   3                  loc_sdr=loc_sdl=par_speed;
 974   3                  if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
 975   4                      loc_sdl*=0.5;//å·¦å‡é€Ÿ
 976   4                      loc_sdr*=1.5;//å³åŠ é€Ÿ
 977   4                  }//å‘å·¦è½¬
 978   3                  if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
 979   4                      loc_sdl*=1.5;//å·¦åŠ é€Ÿ
 980   4                      loc_sdr*=0.5;//å³å‡é€Ÿ
 981   4                  }//å‘å³è½¬
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 17  

 982   3                  if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
 983   4                      loc_sdl*=0.7;//å·¦å‡é€Ÿ
 984   4                      loc_sdr*=1.3;//å³åŠ é€Ÿ
 985   4                  }//å‘å·¦è½¬
 986   3                  if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
 987   4                      loc_sdl*=1.3;//å·¦åŠ é€Ÿ
 988   4                      loc_sdr*=0.7;//å³å‡é€Ÿ
 989   4                  }//å‘å³è½¬
 990   3                  if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
 991   4                      loc_sdl*=0.9;//å·¦å‡é€Ÿ
 992   4                      loc_sdr*=1.1;//å³åŠ é€Ÿ
 993   4                  }//å‘å·¦è½¬
 994   3                  if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
 995   4                      loc_sdl*=1.1;//å·¦åŠ é€Ÿ
 996   4                      loc_sdr*=0.9;//å³å‡é€Ÿ
 997   4                  }//å‘å³è½¬
 998   3                  fun_motors(mot_r,loc_sdr);
 999   3                  fun_motors(mot_l,loc_sdl);
1000   3                  fun_delay(1,del_ms);
1001   3              }
1002   2          }//å¦‚æœå·¡çº¿æ¡æ•°ä¸ä¸º0
1003   1          fun_qc(65,40);
1004   1      }//ä¸»å‡½æ•°å·¡çº¿
1005          void fun_turn(enum varENU_tur par_model,uc par_speed){
1006   1          switch(par_model){//è·å–å‚æ•°
1007   2              case tur_r90://å³è½¬90
1008   2                  fun_motors(mot_l,par_speed);//å·¦è½®å‘å‰
1009   2                  fun_motors(mot_r,-par_speed);//å³è½®å‘å
1010   2                  fun_delay(str_cod.turn90,del_ms);//è®¡æ—¶
1011   2                  break;
1012   2              case tur_l90://å·¦è½¬90
1013   2                  fun_motors(mot_l,-par_speed);//å·¦è½®å‘å
1014   2                  fun_motors(mot_r,par_speed);//å³è½®å‘å‰
1015   2                  fun_delay(str_cod.turn90,del_ms);//è®¡æ—¶
1016   2                  break;
1017   2              case tur_r180://å³è½¬180
1018   2                  fun_motors(mot_l,par_speed);//å·¦è½®å‘å‰
1019   2                  fun_motors(mot_r,-par_speed);//å³è½®å‘å
1020   2                  fun_delay(str_cod.turn180,del_ms);//è®¡æ—¶
1021   2                  break;
1022   2              case tur_l180://å·¦è½¬180
1023   2                  fun_motors(mot_l,-par_speed);//å·¦è½®å‘å
1024   2                  fun_motors(mot_r,par_speed);//å·¦è½®å‘å‰
1025   2                  fun_delay(str_cod.turn180,del_ms);//è®¡æ—¶
1026   2                  break;
1027   2          }
1028   1          while(!in_ls4||!in_ls5);
1029   1          fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
1030   1      }//ä¸»å‡½æ•°è½¬å¼¯
1031          void fun_qc(uc par_time,uc par_speed){
1032   1          uc loc_sdr,loc_sdl;//å·¦å³è½®é€Ÿåº¦
1033   1          str_tfl.delay=var_timer+par_time*10;//å»¶æ—¶æ—¶é—´(æ¯«ç§’)ä¸ºå‚æ•°çš„10å€
1034   1          while(str_tfl.delay>var_timer){
1035   2              loc_sdr=loc_sdl=par_speed;
1036   2              if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
1037   3                  loc_sdl*=0.5;//å·¦å‡é€Ÿ
1038   3                  loc_sdr*=1.5;//å³åŠ é€Ÿ
1039   3              }//å‘å·¦è½¬
1040   2              if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
1041   3                  loc_sdl*=1.5;//å·¦åŠ é€Ÿ
1042   3                  loc_sdr*=0.5;//å³å‡é€Ÿ
1043   3              }//å‘å³è½¬
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 18  

1044   2              if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
1045   3                  loc_sdl*=0.7;//å·¦å‡é€Ÿ
1046   3                  loc_sdr*=1.3;//å³åŠ é€Ÿ
1047   3              }//å‘å·¦è½¬
1048   2              if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
1049   3                  loc_sdl*=1.3;//å·¦åŠ é€Ÿ
1050   3                  loc_sdr*=0.7;//å³å‡é€Ÿ
1051   3              }//å‘å³è½¬
1052   2              if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
1053   3                  loc_sdl*=0.9;//å·¦å‡é€Ÿ
1054   3                  loc_sdr*=1.1;//å³åŠ é€Ÿ
1055   3              }//å‘å·¦è½¬
1056   2              if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
1057   3                  loc_sdl*=1.1;//å·¦åŠ é€Ÿ
1058   3                  loc_sdr*=0.9;//å³å‡é€Ÿ
1059   3              }//å‘å³è½¬
1060   2              fun_motors(mot_r,loc_sdr);
1061   2              fun_motors(mot_l,loc_sdl);
1062   2              fun_delay(1,del_ms);
1063   2          }
1064   1          fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
1065   1      }//ä¸»å‡½æ•°å‰å†²
1066          void fun_stope2prom(){
1067   1          IAP_CONTR = 0;                  //å…³é—­IAPåŠŸèƒ½
1068   1          IAP_CMD = 0;                    //æ¸…é™¤å‘½ä»¤
1069   1          IAP_TRIG = 0;                   //æ¸…é™¤è§¦å‘å¯„å­˜å™¨
1070   1          IAP_ADDRH = 0x80;               //æ•°æ®æŒ‡é’ˆæŒ‡å‘éEEPROMåŒº
1071   1          IAP_ADDRL = 0;                  //æ¸…é™¤IAPåœ°å€
1072   1      }//å…³é—­EEPROMåŠŸèƒ½(IapIdle)
1073          uc fun_reade2prom(ui par_add){
1074   1          uc loc_dat;                     //æ•°æ®ç¼“å†²åŒº
1075   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1076   1          IAP_CMD = 1;                    //è®¾ç½®EEPROMè¯»å‘½ä»¤
1077   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1078   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1079   1          IAP_TRIG = 0x5a;                //è§¦å‘
1080   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1081   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1082   1          loc_dat = IAP_DATA;             //è¯»å‡ºEEPROMä¸­çš„æ•°æ®
1083   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1084   1          return loc_dat;                 //è¿”å›è¯»å–ç»“æœ
1085   1      }//è¯»å–EEPROMæ•°æ®
1086          void fun_writee2prom(ui par_add,uc par_dat){
1087   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1088   1          IAP_CMD = 2;                    //è®¾ç½®EEPROMå†™å…¥å‘½ä»¤
1089   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1090   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1091   1          IAP_DATA = par_dat;             //å†™å…¥æ•°æ®
1092   1          IAP_TRIG = 0x5a;                //è§¦å‘
1093   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1094   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1095   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1096   1      }//å†™EEPROMæ•°æ®
1097          void fun_cleane2prom(ui par_add){
1098   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1099   1          IAP_CMD = 3;                    //è®¾ç½®EEPROMæ“¦é™¤å‘½ä»¤
1100   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1101   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1102   1          IAP_TRIG = 0x5a;                //è§¦å‘
1103   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1104   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1105   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 19  

1106   1      }//æ¸…é™¤EEPROMæ•°æ®
1107          void fun_calibration(){
1108   1          // fun_sj1(sjp_1);//å‡åˆ°æœ€ä¸Šä½
1109   1          ul loc_time;
1110   1          fun_py1(tra_q);//ç§»åŠ¨åˆ°æœ€å‰ç«¯
1111   1          fun_py1(tra_h);//ç§»åŠ¨åˆ°æœ€åç«¯
1112   1          loc_time=var_timer;
1113   1          fun_py1(tra_q);//ç§»åŠ¨åˆ°å‰ç«¯å¹¶è®¡æ—¶
1114   1          fun_py1(tra_h);//ç§»åŠ¨åˆ°åç«¯
1115   1          loc_time=var_timer-loc_time;
1116   1          loc_time*=0.5;
1117   1          str_cod.py1zh=loc_time*0.5;//ä»ååˆ°ä¸­é—´
1118   1          str_cod.py1qz=loc_time*0.5;//ä»å‰åˆ°ä¸­é—´
1119   1          str_cod.py1qkh=loc_time*0.75;//ä»å‰åˆ°é å
1120   1          str_cod.py1kqh=loc_time*0.564;//ä»é å‰åˆ°å
1121   1          str_cod.py1qkq=loc_time*0.34;//ä»å‰åˆ°é å‰
1122   1          str_cod.py1khh=loc_time*0.2701;//ä»ååˆ°é å
1123   1          str_cod.py1kqz=loc_time*0.189;//ä»é å‰åˆ°ä¸­é—´
1124   1          str_cod.py1zkh=loc_time*0.20;//ä»é ååˆ°ä¸­é—´.
1125   1          str_cod.py1kqkh=loc_time*0.5;//ä»é å‰åˆ°é å
1126   1      }//è‡ªåŠ¨æ ¡å‡†å¹³ç§»å‚æ•°
1127          void fun_port(){
1128   1          //19200bps@12.000MHz
1129   1          PCON |= 0x80;       //ä½¿èƒ½æ³¢ç‰¹ç‡å€é€Ÿä½SMOD
1130   1          SCON = 0x50;        //8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡
1131   1          AUXR |= 0x04;       //ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨æ—¶é’Ÿä¸ºFosc,å³1T
1132   1          BRT = 0xD9;         //è®¾å®šç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨é‡è£…å€¼
1133   1          AUXR |= 0x01;       //ä¸²å£1é€‰æ‹©ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1134   1          AUXR |= 0x10;       //å¯åŠ¨ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1135   1          TI=1;               //æ‰“å¼€ä¸²å£ä¼ è¾“åŠŸèƒ½
1136   1      }//ä¸²å£åˆå§‹åŒ–
1137          void fun_test(){
1138   1          fun_sz1(han_j);
1139   1          fun_delay(1,del_s);
1140   1          fun_sz1(han_s);
1141   1          fun_delay(1,del_s);
1142   1          fun_sz1(han_j);
1143   1          fun_delay(1,del_s);
1144   1          fun_sz1(han_s);
1145   1          fun_delay(1,del_s);
1146   1      
1147   1          str_begin.pywz=tra_h;
1148   1          fun_py1(tra_q);
1149   1          fun_delay(1,del_s);
1150   1          fun_py1(tra_h);
1151   1          fun_delay(1,del_s);
1152   1          fun_py1(tra_q);
1153   1          fun_delay(1,del_s);
1154   1          fun_py1(tra_h);
1155   1          fun_delay(1,del_s);
1156   1      
1157   1          fun_sj1(sjp_1);
1158   1          fun_delay(1,del_s);
1159   1          fun_sj1(sjp_2);
1160   1          fun_delay(1,del_s);
1161   1          fun_sj1(sjp_3);
1162   1          fun_delay(1,del_s);
1163   1          fun_sj1(sjp_4);
1164   1          fun_delay(1,del_s);
1165   1          fun_sj1(sjp_5);
1166   1          fun_delay(1,del_s);
1167   1          fun_sj1(sjp_4);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 20  

1168   1          fun_delay(1,del_s);
1169   1          fun_sj1(sjp_3);
1170   1          fun_delay(1,del_s);
1171   1          fun_sj1(sjp_2);
1172   1          fun_delay(1,del_s);
1173   1          fun_sj1(sjp_1);
1174   1      
1175   1          str_now.hzfx=str_begin.hzfx;
1176   1          str_begin.hzfx=dir_up;
1177   1          fun_hz1(dir_right);
1178   1          fun_delay(1,del_s);
1179   1          fun_hz1(dir_up);
1180   1          fun_delay(1,del_s);
1181   1          fun_hz1(dir_right);
1182   1          fun_delay(1,del_s);
1183   1          fun_hz1(dir_up);
1184   1          fun_delay(1,del_s);
1185   1          str_begin.hzfx=str_now.hzfx;
1186   1      
1187   1          fun_motors(mot_rl,60);
1188   1          fun_delay(1,del_s);
1189   1          fun_motors(mot_rl,0);
1190   1          fun_delay(1,del_s);
1191   1      
1192   1          fun_motors(mot_rl,-60);
1193   1          fun_delay(1,del_s);
1194   1          fun_motors(mot_rl,0);
1195   1          fun_delay(1,del_s);
1196   1      
1197   1          fun_motors(mot_r,40);
1198   1          fun_motors(mot_l,-40);
1199   1          fun_delay(1,del_s);
1200   1          fun_motors(mot_rl,0);
1201   1          fun_delay(1,del_s);
1202   1      
1203   1          fun_motors(mot_r,-40);
1204   1          fun_motors(mot_l,40);
1205   1          fun_delay(1,del_s);
1206   1          fun_motors(mot_rl,0);
1207   1      }//æµ‹è¯•ç¨‹åº
1208          uc fun_min(uc par_num,...){
1209   1          va_list loc_argp;//ä¿å­˜å‚æ•°ç»“æ„
1210   1          uc loc_min=par_num;//ç°åœ¨çš„æœ€å°å€¼å°±æ˜¯ç¬¬ä¸€ä¸ª
1211   1          uc loc_shu;//å½“å‰å‚æ•°
1212   1          va_start(loc_argp,par_num);//loc_argpæŒ‡å‘ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œpar_numæ˜¯æœ€åä¸€ä¸ªç¡®å
             -®šçš„å‚æ•°
1213   1          loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
1214   1          do{
1215   2              if(loc_shu<loc_min)
1216   2                  loc_min=loc_shu;
1217   2              loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
1218   2          }while(loc_shu!=def_end);
1219   1          va_end(loc_argp);//ç»“æŸ
1220   1          return loc_min;//é€€å‡º
1221   1      }//æ±‚æœ€å°å€¼
1222          void fun_coordinate(){
1223   1          
1224   1      }//è‡ªåŠ¨å·¡çº¿ä¹‹åæ ‡
1225          void fun_zdzj(ul par_04,ul par_37){//ulå‹æ•°æ®,ä¸€æ¬¡è¾“å…¥æ‰€æœ‰ç»“æœ,æ— éœ€ç­‰å¾…
1226   1          xdata struct str_zdzj str_pass,str_end;//str_zdzj(è‡ªåŠ¨æŠ“ä»¶)çš„ç»“æ„ä½“:ç°åœ¨çš„æ•°æ®å’Œç»“æŸæ—
             -¶å¾—åˆ°çš„ç»“æœ
1227   1          xdata char loc_high[8];         //æ¯æ‘å·¥ä»¶çš„é«˜åº¦
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 21  

1228   1          xdata uc loc_xh1;             //ç¬¬ä¸€ä¸ªå¾ªç¯
1229   1      
1230   1          memset(str_pass.jx,0,sizeof(str_pass.jx));//æ¸…ç©ºç°åœ¨ä»¶åº
1231   1          memset(str_end.jx,0,sizeof(str_end.jx)); //æ¸…ç©ºæƒ³è¦çš„ä»¶åº
1232   1          memset(loc_high,5,sizeof(loc_high));     //æ¯ç»„é«˜åº¦ç½®5(æ²¡æœ‰ä»¶)
1233   1      
1234   1          //èµ·å§‹åŒºä»¶å·
1235   1          str_pass.jx[0][1]=(par_04/10000000)%10;  //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1236   1          str_pass.jx[0][2]=(par_04/1000000)%10;   //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬2å·ä»¶ä»¶å·
1237   1          str_pass.jx[0][3]=(par_04/100000)%10;    //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬3å·ä»¶ä»¶å·
1238   1          str_pass.jx[0][4]=(par_04/10000)%10;     //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1239   1          str_pass.jx[4][1]=(par_04/1000)%10;      //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1240   1          str_pass.jx[4][2]=(par_04/100)%10;       //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬2å·ä»¶ä»¶å·
1241   1          str_pass.jx[4][3]=(par_04/10)%10;        //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬3å·ä»¶ä»¶å·
1242   1          str_pass.jx[4][4]=par_04%10;             //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1243   1          //ç›®çš„åŒºä»¶å·
1244   1          str_pass.jx[3][1]=(par_37/10000000)%10;  //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1245   1          str_pass.jx[3][2]=(par_37/1000000)%10;   //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬2å·ä»¶ä»¶å·
1246   1          str_pass.jx[3][3]=(par_37/100000)%10;    //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬3å·ä»¶ä»¶å·
1247   1          str_pass.jx[3][4]=(par_37/10000)%10;     //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº0çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1248   1          str_pass.jx[7][1]=(par_37/1000)%10;      //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬1å·ä»¶ä»¶å·(æœ€é«˜ä½)
1249   1          str_pass.jx[7][2]=(par_37/100)%10;       //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬2å·ä»¶ä»¶å·
1250   1          str_pass.jx[7][3]=(par_37/10)%10;        //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬3å·ä»¶ä»¶å·
1251   1          str_pass.jx[7][4]=par_37%10;             //ä¼ å…¥ç°åœ¨ä»¶åº:åŒº4çš„ç¬¬4å·ä»¶ä»¶å·(æœ€ä½ä½)
1252   1          //ç›®çš„æ¬¡åº
1253   1          str_end.jx[3][1]=1;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬1å·ç›®çš„æ¬¡åºå·(æœ€é«˜ä½)
1254   1          str_end.jx[3][2]=2;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬2å·ç›®çš„æ¬¡åºå·
1255   1          str_end.jx[3][3]=3;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬3å·ç›®çš„æ¬¡åºå·
1256   1          str_end.jx[3][4]=4;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº3çš„ç¬¬4å·ç›®çš„æ¬¡åºå·(æœ€ä½ä½)
1257   1          str_end.jx[7][1]=5;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬1å·ç›®çš„æ¬¡åºå·(æœ€é«˜ä½)
1258   1          str_end.jx[7][2]=6;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬2å·ç›®çš„æ¬¡åºå·
1259   1          str_end.jx[7][3]=7;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬3å·ç›®çš„æ¬¡åºå·
1260   1          str_end.jx[7][4]=8;                      //æ ‡å‡†ç›®æ ‡æ¬¡åº:åŒº7çš„ç¬¬4å·ç›®çš„æ¬¡åºå·(æœ€ä½ä½)
1261   1      
1262   1          for(loc_xh1=1;loc_xh1<=4;loc_xh1++){
1263   2              if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][1])&&(str_pass.jx[0][loc_xh1]!=0))
1264   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][1];
1265   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][2])&&(str_pass.jx[0][loc_xh1]!=0))
1266   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][2];
1267   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][3])&&(str_pass.jx[0][loc_xh1]!=0))
1268   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][3];
1269   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[3][4])&&(str_pass.jx[0][loc_xh1]!=0))
1270   2                  str_end.jx[0][loc_xh1]=str_end.jx[3][4];
1271   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][1])&&(str_pass.jx[0][loc_xh1]!=0))
1272   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][1];
1273   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][2])&&(str_pass.jx[0][loc_xh1]!=0))
1274   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][2];
1275   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][3])&&(str_pass.jx[0][loc_xh1]!=0))
1276   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][3];
1277   2              else if((str_pass.jx[0][loc_xh1]==str_pass.jx[7][4])&&(str_pass.jx[0][loc_xh1]!=0))
1278   2                  str_end.jx[0][loc_xh1]=str_end.jx[7][4];
1279   2      
1280   2              if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][1])&&(str_pass.jx[4][loc_xh1]!=0))
1281   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][1];
1282   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][2])&&(str_pass.jx[4][loc_xh1]!=0))
1283   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][2];
1284   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][3])&&(str_pass.jx[4][loc_xh1]!=0))
1285   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][3];
1286   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[3][4])&&(str_pass.jx[4][loc_xh1]!=0))
1287   2                  str_end.jx[4][loc_xh1]=str_end.jx[3][4];
1288   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][1])&&(str_pass.jx[4][loc_xh1]!=0))
1289   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][1];
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 22  

1290   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][2])&&(str_pass.jx[4][loc_xh1]!=0))
1291   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][2];
1292   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][3])&&(str_pass.jx[4][loc_xh1]!=0))
1293   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][3];
1294   2              else if((str_pass.jx[4][loc_xh1]==str_pass.jx[7][4])&&(str_pass.jx[4][loc_xh1]!=0))
1295   2                  str_end.jx[4][loc_xh1]=str_end.jx[7][4];
1296   2          }//é€šè¿‡å®é™…ä»¶åºè·å¾—ç¼–å·
1297   1      
1298   1          memset(str_pass.jx,0,sizeof(str_pass.jx));//æ¸…ç©ºç°åœ¨å®é™…ä»¶åº
1299   1          for(loc_xh1=1;loc_xh1<=4;loc_xh1++){
1300   2              str_pass.jx[0][loc_xh1]=str_end.jx[0][loc_xh1];
1301   2              str_pass.jx[4][loc_xh1]=str_end.jx[4][loc_xh1];
1302   2          }//å°†ç°åœ¨çš„ä»¶åºä»str_end.jxä¸­æ‹¿åˆ°str_pass.jx
1303   1          for(loc_xh1=1;loc_xh1<=4;loc_xh1++){
1304   2              str_end.jx[0][loc_xh1]=0;
1305   2              str_end.jx[4][loc_xh1]=0;
1306   2          }//åˆ é™¤str_end.jxä¸­ç°åœ¨çš„ä»¶åº
1307   1          loc_high[0]=loc_high[4]=1;//åªæœ‰0å·å’Œ4å·æ”¾æ»¡äº†ä»¶
1308   1      
1309   1          /*
1310   1              åˆ°ç›®å‰ä¸ºæ­¢å‡†å¤‡å·¥ä½œç»“æŸ,ç°åœ¨çš„æ•°ç»„ä¸­æ²¡æœ‰å®é™…ä»¶åº,
1311   1              ç°åœ¨çš„ç¼–å·åœ¨str_pass.jxä¸­,
1312   1              æƒ³è¦å¾—åˆ°çš„ç»“æœä»¶åºç¼–å·åœ¨str_end.jxä¸­
1313   1          */
1314   1          while(1){
1315   2              if(str_begin.hzfx==dir_left){
1316   3                  //è½¬å‘æ¡ä»¶
1317   3                  //if(str_pass.jx[0][])
1318   3      
1319   3                  //å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,ä¸éœ€è¦ä¸­é—´ä½çš„
1320   3                  if(loc_high[1]<5){
1321   4                      if(str_pass.jx[1][loc_high[1]]==str_end.jx[3][loc_high[3]]){
1322   5                          #ifdef Debug
                                      printf("1-->3\n");
                                  #else
1325   5                              ;
1326   5                          #endif
1327   5                              fun_najian(1,3,loc_high,str_pass.jx);
*** WARNING C182 IN LINE 1327 OF program\8023.c: pointer to different objects
1328   5                              continue;
1329   5                      }//1-->3
1330   4                  }//å¦‚æœåŒº1æœ‰ä»¶
1331   3                  if(loc_high[2]<5){
1332   4                      if(str_pass.jx[2][loc_high[2]]==str_end.jx[3][loc_high[3]]){
1333   5                          #ifdef Debug
                                      printf("2-->3\n");
                                  #else
1336   5                              ;
1337   5                          #endif
1338   5                              continue;
1339   5                      }//2-->3
1340   4                  }//å¦‚æœåŒº2æœ‰ä»¶
1341   3                  if(loc_high[0]<5){
1342   4                      if(str_pass.jx[0][loc_high[0]]==str_end.jx[3][loc_high[3]]){
1343   5                          #ifdef Debug
                                      printf("0-->3\n");
                                  #else
1346   5                              ;
1347   5                          #endif
1348   5                              continue;
1349   5                      }//0-->3
1350   4                      if(str_pass.jx[0][loc_high[0]]==str_end.jx[7][loc_high[7]]){
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 23  

1351   5                          #ifdef Debug
                                      printf("0-->7\n");
                                  #else
1354   5                              ;
1355   5                          #endif
1356   5                              continue;
1357   5                      }//0-->7
1358   4                  }//å¦‚æœåŒº0æœ‰ä»¶
1359   3      
1360   3                  //ä¸å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,éœ€è¦ä¸­é—´ä½çš„
1361   3                  if(loc_high[0]<5){
1362   4                      if((str_pass.jx[0][loc_high[0]]==str_end.jx[3][1])||
1363   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[3][2])||
1364   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[3][3])||
1365   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[3][4])){
1366   5                          if(((loc_high[1]==5)||//å¦‚æœ1åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1367   5                          (str_pass.jx[0][loc_high[0]]>str_pass.jx[1][loc_high[1]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§äº1å
             -Œºçš„ç¼–å·å¹¶ä¸”
1368   5                          (loc_high[1]>2)){//1åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1369   6                              #ifdef Debug
                                          printf("0-->1\n");
                                      #else
1372   6                                  ;
1373   6                              #endif
1374   6                                  continue;
1375   6                          }
1376   5                          if(((loc_high[2]==5)||//å¦‚æœ2åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1377   5                              (str_pass.jx[0][loc_high[0]]>str_pass.jx[2][loc_high[2]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§ä
             -º2åŒºçš„ç¼–å·å¹¶ä¸”
1378   5                              (loc_high[2]>2)){//2åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1379   6                              #ifdef Debug
                                          printf("0-->2\n");
                                      #else
1382   6                                  ;
1383   6                              #endif
1384   6                                  continue;
1385   6                          }
1386   5                      }//å¦‚æœè¦æ”¾åœ¨3ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1387   4                      if((str_pass.jx[0][loc_high[0]]==str_end.jx[7][1])||
1388   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[7][2])||
1389   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[7][3])||
1390   4                      (str_pass.jx[0][loc_high[0]]==str_end.jx[7][4])){
1391   5                          if(((loc_high[5]==5)||//å¦‚æœ5åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1392   5                          (str_pass.jx[0][loc_high[0]]>str_pass.jx[5][loc_high[5]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§äº5å
             -Œºçš„ç¼–å·å¹¶ä¸”
1393   5                          (loc_high[5]>2)){//5åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1394   6                              #ifdef Debug
                                          printf("0-->5\n");
                                      #else
1397   6                                  ;
1398   6                              #endif
1399   6                                  continue;
1400   6                          }
1401   5                          if(((loc_high[6]==5)||//å¦‚æœ6åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1402   5                          (str_pass.jx[0][loc_high[0]]>str_pass.jx[6][loc_high[6]]))&&//0åŒºçš„ä»¶ç¼–å·å¤§äº6å
             -Œºçš„ç¼–å·å¹¶ä¸”
1403   5                          (loc_high[6]>2)){//6åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1404   6                              #ifdef Debug
                                          printf("0-->6\n");
                                      #else
1407   6                                  ;
1408   6                              #endif
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 24  

1409   6                                  continue;
1410   6                          }
1411   5                      }//å¦‚æœè¦æ”¾åœ¨7ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1412   4                  }//å¦‚æœåŒº0æœ‰ä»¶
1413   3      
1414   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®ä¹Ÿä¸èƒ½ä¸€æ¬¡æå®šçš„
1415   3                  if((loc_high[1]<5)&&(loc_high[2]<5)){
1416   4                      if((str_pass.jx[1][loc_high[1]]>str_pass.jx[2][loc_high[2]])&&(loc_high[2]>1)){
1417   5                          #ifdef Debug
                                      printf("1-->2\n");
                                  #else
1420   5                              ;
1421   5                          #endif
1422   5                              continue;
1423   5                      }//1çš„ä»¶æ¯”2çš„ä»¶å¤§ä¸”åŒº2æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1424   4                      if((str_pass.jx[2][loc_high[2]]>str_pass.jx[1][loc_high[1]])&&(loc_high[1]>1)){
1425   5                          #ifdef Debug
                                      printf("2-->1\n");
                                  #else
1428   5                              ;
1429   5                          #endif
1430   5                              continue;
1431   5                      }//2çš„ä»¶æ¯”1çš„ä»¶å¤§ä¸”åŒº1æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1432   4                  }//å¦‚æœåŒº1å’ŒåŒº2éƒ½æœ‰ä»¶
1433   3      
1434   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®æ€ä¹ˆä¹Ÿæä¸å®šçš„
1435   3                  if((loc_high[1]<5)&&(loc_high[2]<5)){
1436   4                      if((loc_high[0]>1)&&(str_pass.jx[1][loc_high[1]]>str_pass.jx[0][loc_high[0]])){
1437   5                          #ifdef Debug
                                      printf("1-->0\n");
                                  #else
1440   5                              ;
1441   5                          #endif
1442   5                              continue;
1443   5                      }//1åŒºçš„ä»¶æ¯”0åŒºçš„å¤§ä¸”0åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1444   4                      if((loc_high[0]>1)&&(str_pass.jx[2][loc_high[2]]>str_pass.jx[0][loc_high[0]])){
1445   5                          #ifdef Debug
                                      printf("2-->0\n");
                                  #else
1448   5                              ;
1449   5                          #endif
1450   5                              continue;
1451   5                      }//2åŒºçš„ä»¶æ¯”0åŒºçš„å¤§ä¸”0åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1452   4                  }
1453   3              }//å¦‚æœå›è½¬åœ¨å·¦è¾¹ 
1454   2              if(str_begin.hzfx==dir_right){
1455   3                  //å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,ä¸éœ€è¦ä¸­é—´ä½çš„
1456   3                  if(loc_high[5]<5){
1457   4                      if(str_pass.jx[5][loc_high[5]]==str_end.jx[7][loc_high[7]]){
1458   5                          #ifdef Debug
                                      printf("5-->7\n");
                                  #else
1461   5                              ;
1462   5                          #endif
1463   5                              continue;
1464   5                      }//5-->7
1465   4                  }//å¦‚æœåŒº5æœ‰ä»¶
1466   3                  if(loc_high[6]<5){
1467   4                      if(str_pass.jx[6][loc_high[6]]==str_end.jx[7][loc_high[7]]){
1468   5                          #ifdef Debug
                                      printf("6-->7\n");
                                  #else
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 25  

1471   5                              ;
1472   5                          #endif
1473   5                              continue;
1474   5                      }//6-->7
1475   4                  }//å¦‚æœåŒº6æœ‰ä»¶
1476   3                  if(loc_high[4]<5){
1477   4                      if(str_pass.jx[4][loc_high[4]]==str_end.jx[7][loc_high[7]]){
1478   5                          #ifdef Debug
                                      printf("4-->7\n");
                                  #else
1481   5                              ;
1482   5                          #endif
1483   5                              continue;
1484   5                      }//4-->7
1485   4                      if(str_pass.jx[4][loc_high[4]]==str_end.jx[3][loc_high[3]]){
1486   5                          #ifdef Debug
                                      printf("4-->3\n");
                                  #else
1489   5                              ;
1490   5                          #endif
1491   5                              continue;
1492   5                      }//4-->3
1493   4                  }//å¦‚æœåŒº4æœ‰ä»¶
1494   3      
1495   3                  //ä¸å¯ä»¥ä¸€æ¬¡æ‹¿èµ°,éœ€è¦ä¸­é—´ä½çš„
1496   3                  if(loc_high[4]<5){
1497   4                      if((str_pass.jx[4][loc_high[4]]==str_end.jx[7][1])||
1498   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[7][2])||
1499   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[7][3])||
1500   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[7][4])){
1501   5                          if(((loc_high[5]==5)||//å¦‚æœ5åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1502   5                          (str_pass.jx[4][loc_high[4]]>str_pass.jx[5][loc_high[5]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§äº5å
             -Œºçš„ç¼–å·å¹¶ä¸”
1503   5                          (loc_high[5]>2)){//5åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1504   6                              #ifdef Debug
                                          printf("4-->5\n");
                                      #else
1507   6                                  ;
1508   6                              #endif
1509   6                                  continue;
1510   6                          }
1511   5                          if(((loc_high[6]==5)||//å¦‚æœ6åŒºæ²¡ä¸œè¥¿æ”¾æˆ–è€…
1512   5                          (str_pass.jx[4][loc_high[4]]>str_pass.jx[6][loc_high[6]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§äº6å
             -Œºçš„ç¼–å·å¹¶ä¸”
1513   5                          (loc_high[6]>2)){//6åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1514   6                              #ifdef Debug
                                          printf("4-->6\n");
                                      #else
1517   6                                  ;
1518   6                              #endif
1519   6                                  continue;
1520   6                          }
1521   5                      }//å¦‚æœè¦æ”¾åœ¨7ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1522   4                      if((str_pass.jx[4][loc_high[4]]==str_end.jx[3][1])||
1523   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[3][2])||
1524   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[3][3])||
1525   4                      (str_pass.jx[4][loc_high[4]]==str_end.jx[3][4])){
1526   5                          if(((loc_high[1]==5)||//å¦‚æœ1åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1527   5                          (str_pass.jx[4][loc_high[4]]>str_pass.jx[1][loc_high[1]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§äº1å
             -Œºçš„ç¼–å·å¹¶ä¸”
1528   5                          (loc_high[1]>2)){//1åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1529   6                              #ifdef Debug
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 26  

                                          printf("4-->1\n");
                                      #else
1532   6                                  ;
1533   6                              #endif
1534   6                                  continue;
1535   6                          }
1536   5                          if(((loc_high[2]==5)||//å¦‚æœ2åŒºæ²¡æ”¾ä¸œè¥¿æˆ–è€…
1537   5                              (str_pass.jx[4][loc_high[4]]>str_pass.jx[2][loc_high[2]]))&&//4åŒºçš„ä»¶ç¼–å·å¤§ä
             -º2åŒºçš„ç¼–å·å¹¶ä¸”
1538   5                              (loc_high[2]>2)){//2åŒºä¸èƒ½æ”¾è¶…è¿‡2ä¸ªä»¶
1539   6                              #ifdef Debug
                                          printf("4-->2\n");
                                      #else
1542   6                                  ;
1543   6                              #endif
1544   6                                  continue;
1545   6                          }
1546   5                      }//å¦‚æœè¦æ”¾åœ¨3ä¸Š,ä½†ç›®å‰ä¸èƒ½æ”¾
1547   4                  }//å¦‚æœåŒº4æœ‰ä»¶
1548   3      
1549   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®ä¹Ÿä¸èƒ½ä¸€æ¬¡æå®šçš„
1550   3                  if((loc_high[5]<5)&&(loc_high[6]<5)){
1551   4                      if((str_pass.jx[5][loc_high[5]]>str_pass.jx[6][loc_high[6]])&&(loc_high[6]>1)){
1552   5                          #ifdef Debug
                                      printf("5-->6\n");
                                  #else
1555   5                              ;
1556   5                          #endif
1557   5                              continue;
1558   5                      }//5çš„ä»¶æ¯”6çš„ä»¶å¤§ä¸”åŒº6æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1559   4                      if((str_pass.jx[6][loc_high[6]]>str_pass.jx[5][loc_high[5]])&&(loc_high[5]>1)){
1560   5                          #ifdef Debug
                                      printf("6-->5\n");
                                  #else
1563   5                              ;
1564   5                          #endif
1565   5                              continue;
1566   5                      }//6çš„ä»¶æ¯”5çš„ä»¶å¤§ä¸”åŒº5æ”¾äº†ä¸åˆ°3ä¸ªä»¶
1567   4                  }//å¦‚æœåŒº5å’ŒåŒº6éƒ½æœ‰ä»¶
1568   3      
1569   3                  //ä¸­é—´ä¸¤ä¸ªä½ç½®æ€ä¹ˆä¹Ÿæä¸å®šçš„
1570   3                  if((loc_high[5]<5)&&(loc_high[6]<5)){
1571   4                      if((loc_high[4]>1)&&(str_pass.jx[5][loc_high[5]]>str_pass.jx[4][loc_high[4]])){
1572   5                          #ifdef Debug
                                      printf("5-->4\n");
                                  #else
1575   5                              ;
1576   5                          #endif
1577   5                              continue;
1578   5                      }//5åŒºçš„ä»¶æ¯”4åŒºçš„å¤§ä¸”4åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1579   4                      if((loc_high[4]>1)&&(str_pass.jx[6][loc_high[6]]>str_pass.jx[4][loc_high[4]])){
1580   5                          #ifdef Debug
                                      printf("6-->4\n");
                                  #else
1583   5                              ;
1584   5                          #endif
1585   5                              continue;
1586   5                      }//6åŒºçš„ä»¶æ¯”4åŒºçš„å¤§ä¸”4åŒºæ”¾äº†ä¸åˆ°3ä¸ªä»¶
1587   4                  }
1588   3              }//å¦‚æœå›è½¬åœ¨å³è¾¹
1589   2              //é€€å‡ºæ¡ä»¶
1590   2          }    
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 27  

1591   1      }//è‡ªåŠ¨æŠ“ä»¶
1592          void fun_zjzt(uc par_motor,uc par_model){
1593   1          if(par_motor==mot_pyhz){
1594   2              switch(par_model){
1595   3                  case 0:
1596   3                      fun_py1(tra_z);
1597   3                      fun_hz1(dir_left);
1598   3                      fun_py1(tra_h);
1599   3                      break;
1600   3                  case 1:
1601   3                      fun_py1(tra_z);
1602   3                      fun_hz1(dir_left);
1603   3                      fun_py1(tra_kh);
1604   3                      break;
1605   3                  case 2:
1606   3                      fun_py1(tra_z);
1607   3                      fun_hz1(dir_left);
1608   3                      fun_py1(tra_kq);
1609   3                      break;
1610   3                  case 3:
1611   3                      fun_py1(tra_z);
1612   3                      fun_hz1(dir_left);
1613   3                      fun_py1(tra_q);
1614   3                      break;
1615   3                  case 4:
1616   3                      fun_py1(tra_z);
1617   3                      fun_hz1(dir_right);
1618   3                      fun_py1(tra_q);
1619   3                      break;
1620   3                  case 5:
1621   3                      fun_py1(tra_z);
1622   3                      fun_hz1(dir_right);
1623   3                      fun_py1(tra_kq);
1624   3                      break;
1625   3                  case 6:
1626   3                      fun_py1(tra_z);
1627   3                      fun_hz1(dir_right);
1628   3                      fun_py1(tra_kh);
1629   3                      break;
1630   3                  case 7:
1631   3                      fun_py1(tra_z);
1632   3                      fun_hz1(dir_right);
1633   3                      fun_py1(tra_h);
1634   3                      break;
1635   3              }
1636   2          }
1637   1          else if(par_motor==mot_sj){
1638   2              switch(par_model){
1639   3                  case 0:
1640   3                      fun_sj1(sjp_1);
1641   3                      break;
1642   3                  case 1:
1643   3                      fun_sj1(sjp_2);
1644   3                      break;
1645   3                  case 2:
1646   3                      fun_sj1(sjp_3);
1647   3                      break;
1648   3                  case 3:
1649   3                      fun_sj1(sjp_4);
1650   3                      break;
1651   3                  case 4:
1652   3                      fun_sj1(sjp_5);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 28  

1653   3                      break;
1654   3                  default:
1655   3                      break;
1656   3              }
1657   2          }
1658   1      }//æŠ“ä»¶çŠ¶æ€,0ä¸ºå·¦ä¸Šä½,3ä¸ºå·¦ä¸‹ä½,4ä¸ºå³ä¸Šä½,7ä¸ºå³ä¸‹ä½
1659          void fun_najian(uc par_now,uc par_next,pc par_high,unsigned char** par_data){
1660   1          #ifdef Debug
                      printf("%d --> %d\n",(ui)par_now,(ui)par_next);
                  #else
1663   1              //å‡èµ·
1664   1              if(par_now==0||par_now==1||par_now==2||par_now==3)
1665   1                  if(str_begin.hzfx==dir_left)
1666   1                      fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],par_high[3],def_end)-1);
1667   1                  else if(str_begin.hzfx==dir_right)
1668   1                      fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],par_high[3],par_high[4],par_hi
             -gh[5],par_high[6],par_high[7],def_end)-1);
1669   1              else if(par_now==4||par_now==5||par_now==6||par_now==7)
1670   1                  if(str_begin.hzfx==dir_right)
1671   1                      fun_zjzt(mot_sj,fun_min(par_high[4],par_high[5],par_high[6],par_high[7],def_end)-1);
1672   1                  else if(str_begin.hzfx==dir_left)
1673   1                      fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],par_high[3],par_high[4],par_hi
             -gh[5],par_high[6],par_high[7],def_end)-1);
1674   1              //å¹³ç§»å›è½¬åˆ°éœ€è¦çš„åœ°æ–¹
1675   1              fun_zjzt(mot_pyhz,par_now);
1676   1              //ä¸‹é™åˆ°å·¥ä»¶çš„ä½ç½®
1677   1              fun_zjzt(mot_sj,par_high[par_now]);
1678   1              //æŠ“ç´§å·¥ä»¶
1679   1              fun_sz1(han_j);
1680   1              //ä¸Šå‡åˆ°æ­£ç¡®çš„æœ€é«˜ä½
1681   1              switch(par_now){
1682   2                  case 0:
1683   2                      switch(par_next){
1684   3                          case 1:
1685   3                              fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],def_end)-1);
1686   3                              break;
1687   3                          case 2:
1688   3                              fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],def_end)-1);
1689   3                              break;
1690   3                          case 3:
1691   3                              fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[2],par_high[3],def_end)-1
             -);
1692   3                              break;
1693   3                          case 4:
1694   3                              fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[5],par_high[4],def_end)-1
             -);
1695   3                              break;
1696   3                          case 5:
1697   3                              fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[5],def_end)-1);
1698   3                              break;
1699   3                          case 6:
1700   3                              fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[6],def_end)-1);
1701   3                              break;
1702   3                          case 7:
1703   3                              fun_zjzt(mot_sj,fun_min(par_high[0],par_high[1],par_high[6],par_high[7],def_end)-1
             -);
1704   3                              break;
1705   3                          default:
1706   3                              break;
1707   3                      }
1708   2                      break;
1709   2                  case 1:
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 29  

1710   2                      switch(par_next){
1711   3                          case 0:
1712   3                              fun_zjzt(mot_sj,fun_min(par_high[1],par_high[0],def_end)-1);
1713   3                              break;
1714   3                          case 2:
1715   3                              fun_zjzt(mot_sj,fun_min(par_high[1],par_high[2],def_end)-1);
1716   3                              break;
1717   3                          case 3:
1718   3                              fun_zjzt(mot_sj,fun_min(par_high[1],par_high[2],par_high[3],def_end)-1);
1719   3                              break;
1720   3                          case 4:
1721   3                              fun_zjzt(mot_sj,fun_min(par_high[1],par_high[5],par_high[4],def_end)-1);
1722   3                              break;
1723   3                          case 5:
1724   3                              fun_zjzt(mot_sj,fun_min(par_high[1],par_high[5],def_end)-1);
1725   3                              break;
1726   3                          case 6:
1727   3                              fun_zjzt(mot_sj,fun_min(par_high[1],par_high[6],def_end)-1);
1728   3                              break;
1729   3                          case 7:
1730   3                              fun_zjzt(mot_sj,fun_min(par_high[1],par_high[6],par_high[7],def_end)-1);
1731   3                              break;
1732   3                          default:
1733   3                              break;
1734   3                      }
1735   2                      break;
1736   2                  case 2:
1737   2                      switch(par_next){
1738   3                          case 0:
1739   3                              fun_zjzt(mot_sj,fun_min(par_high[2],par_high[0],def_end)-1);
1740   3                              break;
1741   3                          case 1:
1742   3                              fun_zjzt(mot_sj,fun_min(par_high[2],par_high[1],def_end)-1);
1743   3                              break;
1744   3                          case 3:
1745   3                              fun_zjzt(mot_sj,fun_min(par_high[2],par_high[3],def_end)-1);
1746   3                              break;
1747   3                          case 4:
1748   3                              fun_zjzt(mot_sj,fun_min(par_high[2],par_high[5],par_high[4],def_end)-1);
1749   3                              break;
1750   3                          case 5:
1751   3                              fun_zjzt(mot_sj,fun_min(par_high[2],par_high[5],def_end)-1);
1752   3                              break;
1753   3                          case 6:
1754   3                              fun_zjzt(mot_sj,fun_min(par_high[2],par_high[6],def_end)-1);
1755   3                              break;
1756   3                          case 7:
1757   3                              fun_zjzt(mot_sj,fun_min(par_high[2],par_high[6],par_high[7],def_end)-1);
1758   3                              break;
1759   3                          default:
1760   3                              break;
1761   3                      }
1762   2                      break;
1763   2                  case 3:
1764   2                      switch(par_next){
1765   3                          case 0:
1766   3                              fun_zjzt(mot_sj,fun_min(par_high[3],par_high[1],par_high[0],def_end)-1);
1767   3                              break;
1768   3                          case 1:
1769   3                              fun_zjzt(mot_sj,fun_min(par_high[3],par_high[1],def_end)-1);
1770   3                              break;
1771   3                          case 2:
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 30  

1772   3                              fun_zjzt(mot_sj,fun_min(par_high[3],par_high[2],def_end)-1);
1773   3                              break;
1774   3                          case 4:
1775   3                              fun_zjzt(mot_sj,fun_min(par_high[3],par_high[2],par_high[5],par_high[4],def_end)-1
             -);
1776   3                              break;
1777   3                          case 5:
1778   3                              fun_zjzt(mot_sj,fun_min(par_high[3],par_high[2],par_high[5],def_end)-1);
1779   3                              break;
1780   3                          case 6:
1781   3                              fun_zjzt(mot_sj,fun_min(par_high[3],par_high[2],par_high[6],def_end)-1);
1782   3                              break;
1783   3                          case 7:
1784   3                              fun_zjzt(mot_sj,fun_min(par_high[3],par_high[2],par_high[6],par_high[7],def_end)-1
             -);
1785   3                              break;
1786   3                          default:
1787   3                              break;
1788   3                      }
1789   2                      break;
1790   2                  case 4:
1791   2                      switch(par_next){
1792   3                          case 0:
1793   3                              fun_zjzt(mot_sj,fun_min(par_high[4],par_high[5],par_high[1],par_high[0],def_end)-1
             -);
1794   3                              break;
1795   3                          case 1:
1796   3                              fun_zjzt(mot_sj,fun_min(par_high[4],par_high[5],par_high[1],def_end)-1);
1797   3                              break;
1798   3                          case 2:
1799   3                              fun_zjzt(mot_sj,fun_min(par_high[4],par_high[6],par_high[2],def_end)-1);
1800   3                              break;
1801   3                          case 3:
1802   3                              fun_zjzt(mot_sj,fun_min(par_high[4],par_high[5],par_high[2],par_high[3],def_end)-1
             -);
1803   3                              break;
1804   3                          case 5:
1805   3                              fun_zjzt(mot_sj,fun_min(par_high[4],par_high[5],def_end)-1);
1806   3                              break;
1807   3                          case 6:
1808   3                              fun_zjzt(mot_sj,fun_min(par_high[4],par_high[6],def_end)-1);
1809   3                              break;
1810   3                          case 7:
1811   3                              fun_zjzt(mot_sj,fun_min(par_high[4],par_high[6],par_high[7],def_end)-1);
1812   3                              break;
1813   3                          default:
1814   3                              break;
1815   3                      }
1816   2                      break;
1817   2                  case 5:
1818   2                      switch(par_next){
1819   3                          case 0:
1820   3                              fun_zjzt(mot_sj,fun_min(par_high[5],par_high[1],par_high[0],def_end)-1);
1821   3                              break;
1822   3                          case 1:
1823   3                              fun_zjzt(mot_sj,fun_min(par_high[5],par_high[1],def_end)-1);
1824   3                              break;
1825   3                          case 2:
1826   3                              fun_zjzt(mot_sj,fun_min(par_high[5],par_high[2],def_end)-1);
1827   3                              break;
1828   3                          case 3:
1829   3                              fun_zjzt(mot_sj,fun_min(par_high[5],par_high[2],par_high[3],def_end)-1);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 31  

1830   3                              break;
1831   3                          case 4:
1832   3                              fun_zjzt(mot_sj,fun_min(par_high[5],par_high[4],def_end)-1);
1833   3                              break;
1834   3                          case 6:
1835   3                              fun_zjzt(mot_sj,fun_min(par_high[5],par_high[6],def_end)-1);
1836   3                              break;
1837   3                          case 7:
1838   3                              fun_zjzt(mot_sj,fun_min(par_high[5],par_high[7],def_end)-1);
1839   3                              break;
1840   3                          default:
1841   3                              break;
1842   3                      }
1843   2                      break;
1844   2                  case 6:
1845   2                      switch(par_next){
1846   3                          case 0:
1847   3                              fun_zjzt(mot_sj,fun_min(par_high[6],par_high[1],par_high[0],def_end)-1);
1848   3                              break;
1849   3                          case 1:
1850   3                              fun_zjzt(mot_sj,fun_min(par_high[6],par_high[1],def_end)-1);
1851   3                              break;
1852   3                          case 2:
1853   3                              fun_zjzt(mot_sj,fun_min(par_high[6],par_high[2],def_end)-1);
1854   3                              break;
1855   3                          case 3:
1856   3                              fun_zjzt(mot_sj,fun_min(par_high[6],par_high[2],par_high[3],def_end)-1);
1857   3                              break;
1858   3                          case 4:
1859   3                              fun_zjzt(mot_sj,fun_min(par_high[6],par_high[4],def_end)-1);
1860   3                              break;
1861   3                          case 5:
1862   3                              fun_zjzt(mot_sj,fun_min(par_high[6],par_high[5],def_end)-1);
1863   3                              break;
1864   3                          case 7:
1865   3                              fun_zjzt(mot_sj,fun_min(par_high[6],par_high[7],def_end)-1);
1866   3                              break;
1867   3                          default:
1868   3                              break;
1869   3                      }
1870   2                      break;
1871   2                  case 7:
1872   2                      switch(par_next){
1873   3                          case 0:
1874   3                              fun_zjzt(mot_sj,fun_min(par_high[7],par_high[5],par_high[1],par_high[0],def_end)-1
             -);
1875   3                              break;
1876   3                          case 1:
1877   3                              fun_zjzt(mot_sj,fun_min(par_high[7],par_high[5],par_high[1],def_end)-1);
1878   3                              break;
1879   3                          case 2:
1880   3                              fun_zjzt(mot_sj,fun_min(par_high[7],par_high[6],par_high[2],def_end)-1);
1881   3                              break;
1882   3                          case 3:
1883   3                              fun_zjzt(mot_sj,fun_min(par_high[7],par_high[6],par_high[2],par_high[3],def_end)-1
             -);
1884   3                              break;
1885   3                          case 4:
1886   3                              fun_zjzt(mot_sj,fun_min(par_high[7],par_high[5],par_high[4],def_end)-1);
1887   3                              break;
1888   3                          case 5:
1889   3                              fun_zjzt(mot_sj,fun_min(par_high[7],par_high[5],def_end)-1);
C51 COMPILER V9.54   8023                                                                  09/22/2015 16:44:06 PAGE 32  

1890   3                              break;
1891   3                          case 6:
1892   3                              fun_zjzt(mot_sj,fun_min(par_high[7],par_high[6],def_end)-1);
1893   3                              break;
1894   3                          default:
1895   3                              break;
1896   3                      }
1897   2                      break;
1898   2                  default:
1899   2                      break;
1900   2              }
1901   1              //å¹³ç§»å›è½¬è‡³æ”¾ä»¶å¤„
1902   1              fun_zjzt(mot_pyhz,par_next);
1903   1              //ä¸‹é™åˆ°è¦æ”¾ä¸‹çš„ä½ç½®
1904   1              fun_zjzt(mot_sj,par_high[par_next]-1);
1905   1              //æ¾å¼€æ‰‹æŠ“
1906   1              fun_sz1(han_s);
1907   1          #endif
1908   1      
1909   1          //æ›´æ–°å‚æ•°
1910   1          par_data[par_next][par_high[par_next]]=par_data[par_now][par_high[par_now]];
1911   1          par_data[par_now][par_high[par_now]]=0;
1912   1          par_high[par_now]--;
1913   1          par_high[par_next]++;
1914   1      }
1915          void fun_zhuajian(){
1916   1          fun_folline(2,70);
1917   1          fun_turn(tur_l90,40);
1918   1          fun_folline(1,40);
1919   1      }//ä»èµ·å§‹åŒºèµ°åˆ°æŠ“ä»¶åŒº
1920          void fun_back(){
1921   1          fun_motors(mot_rl,-20);
1922   1          fun_delay(1,del_s);
1923   1      
1924   1          fun_motors(mot_rl,-50);
1925   1          fun_delay(1,del_s);
1926   1      
1927   1          fun_motors(mot_r,-50);
1928   1          fun_motors(mot_l,-20);
1929   1          fun_delay(1,del_s);
1930   1      }//ä»æŠ“ä»¶åŒºå›åˆ°èµ·å§‹åŒº


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =  10851    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    148      89
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5      62
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
