C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE 8023
OBJECT MODULE PLACED IN .\output\8023.obj
COMPILER INVOKED BY: D:\MyProgram\keil\C51\BIN\C51.EXE program\8023.c OPTIMIZE(8,SPEED) DEBUG OBJECTEXTEND PRINT(.\8023.
                    -lst) OBJECT(.\output\8023.obj)

line level    source

   1          #include "./output/8023.h"
*** ERROR C100 IN LINE 265 OF ./output/8023.h: unprintable character 0xA3 skipped
*** ERROR C100 IN LINE 265 OF ./output/8023.h: unprintable character 0xBB skipped
*** ERROR C127 IN LINE 266 OF ./output/8023.h: 'fun_zhuajian': invalid storage class
*** ERROR C127 IN LINE 267 OF ./output/8023.h: 'fun_back': invalid storage class
   2          xdata struct str_state str_begin,str_now,str_next;//åˆ†åˆ«ä¸º:èµ·å§‹çŠ¶æ€/å½“å‰çŠ¶æ€/ç›®æ ‡çŠ¶æ€
   3          xdata struct str_parameter str_cod={
   4              /*ui str_cod.mlinerqd*/25000,//é»˜è®¤ä¸»å‡½æ•°å·¡çº¿è½¯èµ·åŠ¨è·¯ç¨‹ä¸º25000
   5              /*ui str_cod.mlineqc*/200,   //é»˜è®¤ä¸»å‡½æ•°å·¡çº¿å‰å†²æ—¶é—´ä¸º500æ¯«ç§’
   6          
   7              /*ui str_cod.sj1bzw*/58,     //å‡é™æ ‡å‡†ä½å»¶æ—¶
   8              /*ui str_cod.sj1zjw*/800,    //å‡é™ä¸­é—´ä½å»¶æ—¶
   9          
  10              /*ui str_cod.py1bz*/20,      //fun_py1æ ‡å‡†ä½å»¶æ—¶
  11              /*ui str_cod.py1qkq*/666,    //fun_py1å‰åˆ°é å‰å»¶æ—¶å‚æ•°
  12              /*ui str_cod.py1kqz*/684,    //fun_py1é å‰åˆ°ä¸­é—´å»¶æ—¶
  13              /*ui str_cod.py1zkh*/684,    //fun_py1ä¸­é—´åˆ°é åå»¶æ—¶
  14              /*ui str_cod.py1khh*/666,    //fun_py1é ååˆ°åå»¶æ—¶
  15              /*ui str_cod.py1qz*/500,     //fun_py1å‰åˆ°ä¸­é—´å»¶æ—¶
  16              /*ui str_cod.py1zh*/500,     //fun_py1ä¸­é—´åˆ°åå»¶æ—¶
  17              /*ui str_cod.py1kqkh*/1480,  //fun_py1é å‰åˆ°é åå»¶æ—¶
  18              /*ui str_cod.py1qkh*/2122,   //fun_py1å‰åˆ°é åå»¶æ—¶
  19              /*ui str_cod.py1kqh*/2122,   //fun_py1é å‰åˆ°åå»¶æ—¶
  20          
  21              /*ui str_cod.hz1bz*/20,      //fun_hz1æ ‡å‡†ä½å»¶æ—¶
  22          
  23              /*ui turn90;*/500,           //90åº¦è½¬å¼¯å±è”½å»¶æ—¶
  24              /*ui turn180;*/2000          //180åº¦è½¬å¼¯å±è”½å»¶æ—¶
  25          };
  26          xdata struct str_timerfolline str_tfl;
  27          ul var_timer=0;
  28          void fun_delay(ui par_value,enum varENU_del par_model){
  29              ui loc_con=par_value;
  30              switch(par_model){
  31                  case del_us://å¾®ç§’çº§å»¶æ—¶
  32                      while(loc_con-->0){
  33                          _nop_();
  34                          _nop_();
  35                      }
  36                      return;
  37                  case del_ms://æ¯«ç§’çº§å»¶æ—¶
  38                      while(loc_con-->0){
  39                          uc loc_i, loc_j;
  40                          _nop_();
  41                          _nop_();
  42                          loc_i=12;
  43                          loc_j=168;
  44                          do{
  45                              while(--loc_j);
  46                          }while(--loc_i);
  47                      }
  48                      return;
  49                  case del_s://ç§’çº§å»¶æ—¶
  50                      while(loc_con-->0){
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 2   

  51                          uc loc_i, loc_j, loc_k;
  52                          loc_i=46;
  53                          loc_j=153;
  54                          loc_k=245;
  55                          do{
  56                              do{
  57                                  while(--loc_k);
  58                              }while(--loc_j);
  59                          }while(--loc_i);
  60                      }
  61                      return;
  62                  default:return;
  63              }
  64          }//å»¶æ—¶
  65          void fun_timer0init(){
  66              AUXR|=0x80;   //å®šæ—¶å™¨æ—¶é’Ÿ1Tæ¨¡å¼
  67              TMOD&=0xF0;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  68              TMOD|=0x01;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  69              TL0=0x20;     //å®šæ—¶åˆå€¼:1ms
  70              TH0=0xD1;     //å®šæ—¶åˆå€¼:1ms
  71              TF0=0;        //æ¸…é™¤TF0æ ‡å¿—
  72              ET0=1;
  73              EA=1;         //å¼€å¯æ€»ä¸­æ–­
  74          }//1æ¯«ç§’å®šæ—¶å™¨0åˆå§‹åŒ–
  75          void fun_timer1init(){
  76              AUXR&=0xBF;     //å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
  77              TMOD&=0x0F;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  78              TMOD|=0x10;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  79              TL1=0xE0;       //å®šæ—¶åˆå€¼:20ms
  80              TH1=0xB1;       //å®šæ—¶åˆå€¼:20ms
  81              TF1=0;          //æ¸…é™¤TF1æ ‡å¿—
  82              ET1=1;
  83              EA=1;           //å¼€å¯æ€»ä¸­æ–­
  84          }//20æ¯«ç§’å®šæ—¶å™¨1åˆå§‹åŒ–
  85          void fun_timer0(){
  86              TL0=0x20;
  87              TH0=0xD1;//å®šæ—¶å™¨åˆå€¼æ¢å¤è‡³1ms
  88              var_timer++;//å…¨å±€è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶
  89              if(str_tfl.doing==tf_ture)//å¦‚æœæ­£åœ¨ç§»åŠ¨
  90                  fun_timermove();//å®šæ—¶å™¨ç§»åŠ¨
  91          }//1æ¯«ç§’å®šæ—¶å™¨0å¤„ç†å‡½æ•°
  92          void fun_timer1(){
  93              TL1=0xE0;
  94              TH1=0xB1;
  95          }//20æ¯«ç§’å®šæ—¶å™¨1å¤„ç†å‡½æ•°
  96          void fun_wait(){
  97              while(in_start==1);
  98              fun_delay(20,del_ms);
  99              while(in_start==0);
 100              fun_delay(256,del_ms);
 101          }//ç­‰å¾…æŒ‰é”®
 102          void fun_pwminit(){
 103              CCON=0x00;//PACå¯„å­˜æ§åˆ¶å™¨
 104              CH=0;//é‡ç½®PACè®¡æ—¶å™¨
 105              CL=0;
 106              CMOD=0x08;//ä¸åˆ†é¢‘
 107          }//PWMåˆå§‹åŒ–
 108          void fun_pwmr(uc par_value){
 109              CCAP0H=CCAP0L=par_value*25/10;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 110              CCAPM0=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 111              PCA_PWM0=0x00;
 112          }//å³è·¯PWMè¾“å‡º
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 3   

 113          void fun_pwml(uc par_value){
 114              CCAP1H=CCAP1L=par_value*25/10;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 115              CCAPM1=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 116              PCA_PWM1=0x00;
 117          }//å·¦è·¯PWMè¾“å‡º
 118          void fun_motors(enum varENU_mot par_model,char par_speed){
 119              if(par_speed>100)
 120                  par_speed=100;
 121              else if(par_speed<-100)
 122                  par_speed=-100;//é€Ÿåº¦æœ€å¤š100,æœ€å°‘-100
 123              switch(par_model){
 124                  case mot_l://å·¦è½®ç”µæœº
 125                      if(str_begin.leftsd==par_speed)
 126                          return;
 127                      else
 128                          str_begin.leftsd=par_speed;
 129                      if(par_speed==0){
 130                          fun_pwml(0);out_pwml=0;
 131                      }
 132                      else if(par_speed>0){
 133                          CR=1;fun_pwml(par_speed);out_pwml=0;
 134                      }
 135                      else if(par_speed<0){
 136                          CR=1;fun_pwml(cabs(par_speed));out_pwml=1;
 137                      }
 138                      break;
 139                  case mot_r://å³è½®ç”µæœº
 140                      if(str_begin.rightsd==par_speed)
 141                          return;
 142                      else
 143                          str_begin.rightsd=par_speed;
 144                      if(par_speed==0){
 145                          fun_pwmr(0);out_pwmr=0;
 146                      }
 147                      else if(par_speed>0){
 148                          CR=1;fun_pwmr(par_speed);out_pwmr=0;
 149                      }
 150                      else if(par_speed<0){
 151                          CR=1;fun_pwmr(cabs(par_speed));out_pwmr=1;
 152                      }
 153                      break;
 154                  case mot_rl://å·¦å³è½®åŒæ­¥
 155                      if((str_begin.leftsd==par_speed)&&(str_begin.rightsd==par_speed))
 156                          return;
 157                      else
 158                          str_begin.leftsd=str_begin.rightsd=par_speed;
 159                      if(par_speed==0){
 160                          CR=0;
 161                          fun_pwmr(0);out_pwmr=0;
 162                          fun_pwml(0);out_pwml=0;
 163                      }
 164                      else if(par_speed>0){
 165                          CR=1;
 166                          fun_pwml(par_speed);out_pwml=0;
 167                          fun_pwmr(par_speed);out_pwmr=0;
 168                      }
 169                      else if(par_speed<0){
 170                          CR=1;
 171                          fun_pwml(cabs(par_speed));out_pwml=1;
 172                          fun_pwmr(cabs(par_speed));out_pwmr=1;
 173                      }
 174                      break;
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 4   

 175                  case mot_sz://æ­£è½¬ä¸ºæŠ“ç´§ï¼Œåè½¬ä¸ºæ¾å¼€
 176                      if(str_begin.szsd==par_speed)
 177                          return;
 178                      else
 179                          str_begin.szsd=par_speed;
 180                      if(par_speed==0){
 181                          out_motorselect=1;out_dir1=0;out_en1=1;
 182                      }
 183                      else if(par_speed>0){
 184                          out_motorselect=1;out_dir1=1;out_en1=0;
 185                      }
 186                      else if(par_speed<0){
 187                          out_motorselect=1;out_dir1=0;out_en1=0;
 188                      }
 189                      break;
 190                  case mot_py://æ­£è½¬æ˜¯å‘æ— ç”µæœºä¸€æ–¹è½¬,åè½¬ä¸ºå‘æœ‰ç”µæœºä¸€æ–¹è½¬
 191                      if(str_begin.pysd==par_speed)
 192                          return;
 193                      else
 194                          str_begin.pysd=par_speed;
 195                      if(par_speed==0){
 196                          out_motorselect=1;out_dir2=0;out_en2=1;
 197                      }
 198                      else if(par_speed>0){
 199                          out_motorselect=1;out_dir2=1;out_en2=0;
 200                      }
 201                      else if(par_speed<0){
 202                          out_motorselect=1;out_dir2=0;out_en2=0;
 203                      }
 204                      break;
 205                  case mot_sj://å‘ä¸Šä¸ºæ­£è½¬,å‘ä¸‹ä¸ºåè½¬
 206                      if(str_begin.sjsd==par_speed)
 207                          return;
 208                      else
 209                          str_begin.sjsd=par_speed;
 210                      if(par_speed==0){
 211                          out_motorselect=0;out_dir1=0;out_en1=1;
 212                      }
 213                      else if(par_speed>0){
 214                          out_motorselect=0;out_dir1=0;out_en1=0;
 215                      }
 216                      else if(par_speed<0){
 217                          out_motorselect=0;out_dir1=1;out_en1=0;
 218                      }
 219                      break;
 220                  case mot_hz://é¡ºæ—¶é’ˆä¸ºæ­£è½¬,é€†æ—¶é’ˆä¸ºåè½¬
 221                      if(str_begin.hzsd==par_speed)
 222                          return;
 223                      else
 224                          str_begin.hzsd=par_speed;
 225                      if(par_speed==0){
 226                          out_motorselect=0;out_dir2=0;out_en2=1;
 227                      }
 228                      else if(par_speed>0){
 229                          out_motorselect=0;out_dir2=0;out_en2=0;
 230                      }
 231                      else if(par_speed<0){
 232                          out_motorselect=0;out_dir2=1;out_en2=0;
 233                      }
 234                      break;
 235                  default:
 236                      break;
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 5   

 237              }
 238          }//ä¸»å‡½æ•°æ“ä½œç”µæœº
 239          void fun_motorsrl(enum varENU_mot par_model,char par_speed){
 240              if(par_speed>100)
 241                  par_speed=100;
 242              else if(par_speed<-100)
 243                  par_speed=-100;//é€Ÿåº¦æœ€å¤š100,æœ€å°‘-100
 244              switch(par_model){
 245                  case mot_l://å·¦è½®ç”µæœº
 246                      if(str_begin.leftsd==par_speed)
 247                          return;
 248                      else
 249                          str_begin.leftsd=par_speed;
 250                      if(par_speed==0){
 251                          fun_pwml(0);out_pwml=0;
 252                      }
 253                      else if(par_speed>0){
 254                          CR=1;fun_pwml(par_speed);out_pwml=0;
 255                      }
 256                      else if(par_speed<0){
 257                          CR=1;fun_pwml(cabs(par_speed));out_pwml=1;
 258                      }
 259                      break;
 260                  case mot_r://å³è½®ç”µæœº
 261                      if(str_begin.rightsd==par_speed)
 262                          return;
 263                      else
 264                          str_begin.rightsd=par_speed;
 265                      if(par_speed==0){
 266                          fun_pwmr(0);out_pwmr=0;
 267                      }
 268                      else if(par_speed>0){
 269                          CR=1;fun_pwmr(par_speed);out_pwmr=0;
 270                      }
 271                      else if(par_speed<0){
 272                          CR=1;fun_pwmr(cabs(par_speed));out_pwmr=1;
 273                      }
 274                      break;
 275                  case mot_rl://å·¦å³è½®åŒæ­¥
 276                      if((str_begin.leftsd==par_speed)&&(str_begin.rightsd==par_speed))
 277                          return;
 278                      else
 279                          str_begin.leftsd=str_begin.rightsd=par_speed;
 280                      if(par_speed==0){
 281                          CR=0;
 282                          fun_pwmr(0);out_pwmr=0;
 283                          fun_pwml(0);out_pwml=0;
 284                      }
 285                      else if(par_speed>0){
 286                          CR=1;
 287                          fun_pwml(par_speed);out_pwml=0;
 288                          fun_pwmr(par_speed);out_pwmr=0;
 289                      }
 290                      else if(par_speed<0){
 291                          CR=1;
 292                          fun_pwml(cabs(par_speed));out_pwml=1;
 293                          fun_pwmr(cabs(par_speed));out_pwmr=1;
 294                      }
 295                      break;
 296                  default:
 297                      break;
 298              }
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 6   

 299          }//å®šæ—¶å™¨æ“ä½œå·¦å³è½®
 300          void fun_sz1(enum varENU_han par_model){
 301              if(str_begin.szzt==par_model)
 302                  return;
 303              if(par_model==han_s){//æ‰‹æŠ“æ¾
 304                  fun_motors(mot_sz,-100);
 305                  while(in_s==1);
 306              }
 307              else{//æ‰‹æŠ“ç´§
 308                  fun_motors(mot_sz,100);
 309                  while(in_j==1);
 310              }
 311              fun_delay(20,del_ms);
 312              fun_motors(mot_sz,0);
 313              str_begin.szzt=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 314          }//æ‰‹æŠ“å•æ­¥è¿åŠ¨
 315          void fun_py1(enum varENU_tra par_model){
 316              if(str_begin.pywz==par_model)
 317                  return;
 318              switch(par_model){
 319                  case tra_q://å‰å¹³ç§»(æ²¡æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 320                      fun_motors(mot_py,100);
 321                      while(in_qpy==1);
 322                      fun_delay(str_cod.py1bz,del_ms);
 323                      break;
 324                  case tra_kq:
 325                      switch(str_begin.pywz){
 326                          case tra_q:
 327                              fun_motors(mot_py,-100);
 328                              fun_delay(str_cod.py1qkq,del_ms);
 329                              break;
 330                          case tra_z:
 331                              fun_motors(mot_py,100);
 332                              fun_delay(str_cod.py1kqz,del_ms);
 333                              break;
 334                          case tra_kh:
 335                              fun_motors(mot_py,100);
 336                              fun_delay(str_cod.py1kqkh,del_ms);
 337                              break;
 338                          case tra_h:
 339                              fun_motors(mot_py,100);
 340                              fun_delay(str_cod.py1kqh,del_ms);
 341                              break;
 342                      }
 343                      break;
 344                  case tra_z:
 345                      switch(str_begin.pywz){
 346                          case tra_q:
 347                              fun_motors(mot_py,-100);
 348                              fun_delay(str_cod.py1qz,del_ms);
 349                              break;
 350                          case tra_kq:
 351                              fun_motors(mot_py,-100);
 352                              fun_delay(str_cod.py1kqz,del_ms);
 353                              break;
 354                          case tra_kh:
 355                              fun_motors(mot_py,100);
 356                              fun_delay(str_cod.py1zkh,del_ms);
 357                              break;
 358                          case tra_h:
 359                              fun_motors(mot_py,100);
 360                              fun_delay(str_cod.py1zh,del_ms);
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 7   

 361                              break;
 362                      }
 363                      break;
 364                  case tra_kh:
 365                      switch(str_begin.pywz){
 366                          case tra_q:
 367                              fun_motors(mot_py,-100);
 368                              fun_delay(str_cod.py1qkh,del_ms);
 369                              break;
 370                          case tra_kq:
 371                              fun_motors(mot_py,-100);
 372                              fun_delay(str_cod.py1kqkh,del_ms);
 373                              break;
 374                          case tra_z:
 375                              fun_motors(mot_py,-100);
 376                              fun_delay(str_cod.py1zkh,del_ms);
 377                              break;
 378                          case tra_h:
 379                              fun_motors(mot_py,100);
 380                              fun_delay(str_cod.py1khh,del_ms);
 381                              break;
 382                      }
 383                      break;
 384                  case tra_h://åå¹³ç§»(æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 385                      fun_motors(mot_py,-100);
 386                      while(in_hpy==1);
 387                      fun_delay(str_cod.py1bz,del_ms);
 388                      break;
 389                  default:
 390                      break;
 391              }
 392              fun_motors(mot_py,0);
 393              str_begin.pywz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 394          }//å¹³ç§»å•æ­¥è¿åŠ¨
 395          void fun_sj1(enum varENU_sjp par_model){
 396              if(str_begin.sjwz==par_model)
 397                 return;
 398              switch(par_model){
 399                  case sjp_1://å‡é™ä½ç½®1(æœ€ä¸Šä½)
 400                      fun_motors(mot_sj,100);
 401                      def_select(sel_58);
 402                      while(in_wz1==1);
 403                      fun_delay(str_cod.sj1bzw,del_ms);
 404                      break;
 405                  case sjp_12:
 406                      if(par_model>str_begin.sjwz){
 407                          fun_motors(mot_sj,-100);
 408                          fun_delay(str_cod.sj1zjw,del_ms);
 409                      }
 410                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 411                          fun_sj1(sjp_2);
 412                          fun_motors(mot_sj,100);
 413                          fun_delay(str_cod.sj1zjw,del_ms);
 414                      }
 415                      break;
 416                  case sjp_2://å‡é™ä½ç½®2
 417                      fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 418                      def_select(sel_58);
 419                      while(in_wz2==1);
 420                      fun_delay(str_cod.sj1bzw,del_ms);
 421                      break;
 422                  case sjp_23:
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 8   

 423                      if(par_model>str_begin.sjwz){
 424                          fun_sj1(sjp_2);
 425                          fun_motors(mot_sj,-100);
 426                          fun_delay(str_cod.sj1zjw,del_ms);
 427                      }
 428                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 429                          fun_sj1(sjp_3);
 430                          fun_motors(mot_sj,100);
 431                          fun_delay(str_cod.sj1zjw,del_ms);
 432                      }
 433                      break;
 434                  case sjp_3://å‡é™ä½ç½®3
 435                      fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 436                      def_select(sel_58);
 437                      while(in_wz3==1);
 438                      fun_delay(str_cod.sj1bzw,del_ms);
 439                      break;
 440                  case sjp_34:
 441                      if(par_model>str_begin.sjwz){
 442                          fun_sj1(sjp_3);
 443                          fun_motors(mot_sj,-100);
 444                          fun_delay(str_cod.sj1zjw,del_ms);
 445                      }
 446                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 447                          fun_sj1(sjp_4);
 448                          fun_motors(mot_sj,100);
 449                          fun_delay(str_cod.sj1zjw,del_ms);
 450                      }
 451                      break;
 452                  case sjp_4://å‡é™ä½ç½®4
 453                      fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 454                      def_select(sel_58);
 455                      while(in_wz4==1);
 456                      fun_delay(str_cod.sj1bzw,del_ms);
 457                      break;
 458                  case sjp_45:
 459                      if(par_model>str_begin.sjwz){
 460                          fun_sj1(sjp_4);
 461                          fun_motors(mot_sj,-100);
 462                          fun_delay(str_cod.sj1zjw,del_ms);
 463                      }
 464                      else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 465                          fun_motors(mot_sj,100);
 466                          fun_delay(str_cod.sj1zjw,del_ms);
 467                      }
 468                      break;
 469                  case sjp_5://å‡é™ä½ç½®5
 470                      fun_motors(mot_sj,-100);
 471                      def_select(sel_912);
 472                      while(in_wz5==1);
 473                      fun_delay(str_cod.sj1bzw,del_ms);
 474                      break;
 475                  default:
 476                      break;
 477              }
 478              fun_motors(mot_sj,0);
 479              str_begin.sjwz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 480          }//å‡é™å•æ­¥è¿åŠ¨
 481          void fun_hz1(enum varENU_dir par_model){
 482              if(str_begin.hzfx==par_model)
 483                  return;
 484              def_select(sel_912);
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 9   

 485              switch(par_model){
 486                  case dir_up://å›è½¬è‡³å‰æ–¹
 487                      switch(str_begin.hzfx){
 488                          case dir_down://ç°åœ¨åœ¨ä¸‹æ–¹
 489                              fun_motors(mot_hz,-100);
 490                              fun_delay(1,del_s);
 491                              while(in_hz==1);
 492                              while(in_hz==0);
 493                              while(in_hz==1);
 494                              fun_delay(str_cod.hz1bz,del_ms);
 495                              break;
 496                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 497                              fun_motors(mot_hz,100);
 498                              fun_delay(1,del_s);
 499                              while(in_hz==1);
 500                              fun_delay(str_cod.hz1bz,del_ms);
 501                              break;
 502                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 503                              fun_motors(mot_hz,-100);
 504                              fun_delay(1,del_s);
 505                              while(in_hz==1);
 506                              fun_delay(str_cod.hz1bz,del_ms);
 507                              break;
 508                          default:
 509                              break;
 510                      }
 511                      break;
 512                  case dir_down://è¦å»ä¸‹é¢
 513                      switch(str_begin.hzfx){
 514                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 515                              fun_motors(mot_hz,100);
 516                              fun_delay(1,del_s);
 517                              while(in_hz==1);
 518                              while(in_hz==0);
 519                              while(in_hz==1);
 520                              fun_delay(str_cod.hz1bz,del_ms);
 521                              break;
 522                          case dir_left://ç°åœ¨åœ¨å·¦é¢
 523                              fun_motors(mot_hz,-100);
 524                              fun_delay(1,del_s);
 525                              while(in_hz==1);
 526                              fun_delay(str_cod.hz1bz,del_ms);
 527                              break;
 528                              break;
 529                          case dir_right://ç°åœ¨åœ¨å³é¢
 530                              fun_motors(mot_hz,100);
 531                              fun_delay(1,del_s);
 532                              while(in_hz==1);
 533                              fun_delay(str_cod.hz1bz,del_ms);
 534                              break;
 535                          default:
 536                              break;
 537                      }
 538                      break;
 539                  case dir_left://è¦å»å·¦è¾¹
 540                      switch(str_begin.hzfx){
 541                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 542                              fun_motors(mot_hz,-100);
 543                              fun_delay(1,del_s);
 544                              while(in_hz==1);
 545                              fun_delay(str_cod.hz1bz,del_ms);
 546                              break;
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 10  

 547                              break;
 548                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 549                              fun_motors(mot_hz,100);
 550                              fun_delay(1,del_s);
 551                              while(in_hz==1);
 552                              fun_delay(str_cod.hz1bz,del_ms);
 553                              break;
 554                              break;
 555                          case dir_right://ç°åœ¨åœ¨å³é¢
 556                              fun_motors(mot_hz,-100);
 557                              fun_delay(1,del_s);
 558                              while(in_hz==1);
 559                              while(in_hz==0);
 560                              while(in_hz==1);
 561                              fun_delay(str_cod.hz1bz,del_ms);
 562                              break;
 563                          default:
 564                              break;
 565                      }
 566                      break;
 567                  case dir_right://è¦å»å³é¢
 568                      switch(str_begin.hzfx){
 569                          case dir_up://ç°åœ¨åœ¨å‰é¢
 570                              fun_motors(mot_hz,100);
 571                              fun_delay(1,del_s);
 572                              while(in_hz==1);
 573                              fun_delay(str_cod.hz1bz,del_ms);
 574                              break;
 575                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 576                              fun_motors(mot_hz,-100);
 577                              fun_delay(1,del_s);
 578                              while(in_hz==1);
 579                              fun_delay(str_cod.hz1bz,del_ms);
 580                              break;
 581                          case dir_left://ç°åœ¨åœ¨å·¦é¢
 582                              fun_motors(mot_hz,100);
 583                              fun_delay(1,del_s);
 584                              while(in_hz==1);
 585                              while(in_hz==0);
 586                              while(in_hz==1);
 587                              fun_delay(str_cod.hz1bz,del_ms);
 588                              break;
 589                          default:
 590                              break;
 591                      }
 592                      break;
 593                  default:
 594                      break;
 595              }
 596              fun_motors(mot_hz,0);
 597              str_begin.hzfx=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 598          }//å›è½¬å•æ­¥è¿åŠ¨
 599          void fun_pyhz2(enum varENU_tra par_pymodel,enum varENU_dir par_hzmodel){//å¹³ç§»å›è½¬åŒæ­¥è¿åŠ¨
 600              switch(par_hzmodel){
 601                  case dir_left://è¦å»å·¦è¾¹
 602                      switch(str_begin.hzfx){
 603                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 604                          
 605                              break;
 606                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 607                          
 608                              break;
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 11  

 609                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 610                          
 611                              break;
 612                          default:
 613                              break;
 614                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 615                      break;
 616                  case dir_right://è¦å»å³è¾¹
 617                      switch(str_begin.hzfx){
 618                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 619                          
 620                              break;
 621                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 622                          
 623                              break;
 624                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 625                          
 626                              break;
 627                          default:
 628                              break;
 629                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 630                      break;
 631                  case dir_up://è¦å»ä¸Šé¢
 632                      switch(str_begin.hzfx){
 633                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 634                          
 635                              break;
 636                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 637                          
 638                              break;
 639                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 640                          
 641                              break;
 642                          default:
 643                              break;
 644                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 645                      break;
 646                  case dir_down://è¦å»ä¸‹é¢
 647                      switch(str_begin.hzfx){
 648                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 649                          
 650                              break;
 651                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 652                          
 653                              break;
 654                          case dir_up://ç°åœ¨åœ¨ä¸‹é¢
 655                          
 656                              break;
 657                          default:
 658                              break;
 659                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 660                      break;
 661                  default:
 662                      break;
 663              }//è·å–ç°åœ¨è¦å»çš„å›è½¬ä½ç½®
 664              switch(par_pymodel){
 665                  case tra_q://è¦å»å‰é¢
 666                  
 667                      break;
 668                  case tra_kq://è¦å»é å‰
 669                  
 670                      break;
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 12  

 671                  case tra_z://è¦å»ä¸­é—´
 672                  
 673                      break;
 674                  case tra_kh://è¦å»é å
 675                  
 676                      break;
 677                  case tra_h://è¦å»åé¢
 678                  
 679                      break;
 680                  default:
 681                      break;
 682              }//è·å–ç°åœ¨å¹³ç§»æ‰€åœ¨çš„ä½ç½®
 683              switch(par_hzmodel){
 684                  case dir_left://è¦å»å·¦è¾¹
 685                      switch(str_begin.hzfx){
 686                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 687                          
 688                              break;
 689                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 690                          
 691                              break;
 692                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 693                          
 694                              break;
 695                          default:
 696                              break;
 697                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 698                      break;
 699                  case dir_right://è¦å»å³è¾¹
 700                      switch(str_begin.hzfx){
 701                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 702                          
 703                              break;
 704                          case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 705                          
 706                              break;
 707                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 708                          
 709                              break;
 710                          default:
 711                              break;
 712                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 713                      break;
 714                  case dir_up://è¦å»ä¸Šé¢
 715                      switch(str_begin.hzfx){
 716                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 717                          
 718                              break;
 719                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 720                          
 721                              break;
 722                          case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 723                          
 724                              break;
 725                          default:
 726                              break;
 727                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 728                      break;
 729                  case dir_down://è¦å»ä¸‹é¢
 730                      switch(str_begin.hzfx){
 731                          case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 732                          
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 13  

 733                              break;
 734                          case dir_right://ç°åœ¨åœ¨å³è¾¹
 735                          
 736                              break;
 737                          case dir_up://ç°åœ¨åœ¨ä¸‹é¢
 738                          
 739                              break;
 740                          default:
 741                              break;
 742                      }//è·å–ç°åœ¨å›è½¬æ‰€åœ¨çš„ä½ç½®
 743                      break;
 744                  default:
 745                      break;
 746              }//è·å–ç°åœ¨è¦å»çš„å›è½¬ä½ç½®
 747          }
 748          void fun_jtjp(){
 749              while(1){
 750                  if((!in_ls1&&!in_ls2&&in_ls4&&in_ls5&&!in_ls7&&!in_ls8)&&((in_ls3&&in_ls6)||(!in_ls3&&!in_ls6))){
 751                      fun_delay(10,del_ms);
 752                      fun_motors(mot_rl,0);
 753                      return;
 754                  }
 755                  if(in_ls2||in_ls1){
 756                      fun_motors(mot_l,16);
 757                      fun_motors(mot_r,-16);
 758                  }
 759                  else if(in_ls7||in_ls8){
 760                      fun_motors(mot_l,-16);
 761                      fun_motors(mot_r,16);
 762                  }
 763                  else{
 764                      if(!in_ls4){
 765                          fun_motors(mot_l,-12);
 766                          fun_motors(mot_r,12);
 767                      }
 768                      else if(!in_ls5){
 769                          fun_motors(mot_l,12);
 770                          fun_motors(mot_r,-12);
 771                      }
 772                      else{
 773                          if(in_ls6&&!in_ls3){
 774                              fun_motors(mot_l,-8);
 775                              fun_motors(mot_r,8);
 776                          }
 777                          if(in_ls3&&!in_ls6){
 778                              fun_motors(mot_l,8);
 779                              fun_motors(mot_r,-8);
 780                          }
 781                      }
 782                  }
 783              }
 784          }//é™æ€çº å
 785          void fun_timermove(){
 786              static uc loc_con=0;//éœ€è¦åˆ†æ­¥åšçš„åŠ¨ä½œéœ€è¦ç”¨åˆ°æ­¤é™æ€ç§æœ‰åˆ†æ­¥æ ‡å¿—ä½
 787              uc loc_sdl,loc_sdr;//å·¦è½®é€Ÿåº¦å’Œå³è½®é€Ÿåº¦çš„å±€éƒ¨å˜é‡
 788              switch(*str_tfl.run){//é€‰æ‹©è¿è¡Œæ–¹å¼
 789                  case def_end://è¿è¡Œç»“æŸ
 790                      fun_motorsrl(mot_rl,0);//å†æ¬¡åœæ­¢ç”µæœºè¿åŠ¨
 791                      str_tfl.doing=tf_false;//ç§»åŠ¨ç»“æŸ
 792                      memset(str_tfl.step,0,sizeof(str_tfl.step));//æ¸…ç©ºstepæ•°ç»„
 793                      str_tfl.run=str_tfl.step;//æŒ‡é’ˆæŒ‡å‘stepçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
 794                      break;
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 14  

 795                  case tfl_line://è¿è¡Œå·¡çº¿
 796                      if(*(str_tfl.run+1)){//å¦‚æœå‚æ•°ä¸ºé0æ•°
 797                          if((in_ls1||in_ls8)&&(in_ls2&&in_ls3&&in_ls4&&in_ls5&in_ls6&&in_ls7)){//å¦‚æœä¸­é—´6ä¸ªç
             -¯å…¨äº®,å·¦å³äº®ä»»æ„ä¸€ä¸ª
 798                              str_tfl.online=tf_ture;//æ ‡å¿—ä½è®°å½•åœ¨çº¿
 799                              fun_motorsrl(mot_rl,str_tfl.gospeed);//æŒ‰ç…§å¸¸è§„é€Ÿåº¦è¿‡çº¿
 800                          }
 801                          else if(str_tfl.online==tf_ture){//å¦‚æœæ ‡å¿—ä½è®°å½•åœ¨çº¿,è€Œä¸”ä¸ç¬¦åˆåœ¨çº¿ç‰¹å¾
 802                              str_tfl.online=tf_false;//æ ‡å¿—ä½è®°å½•ä¸åœ¨çº¿
 803                              (*(str_tfl.run+1))--;//å‚æ•°å€¼å‡1,è®°å½•å·²ç»èµ°äº†ä¸€æ¡çº¿
 804                          }
 805                          else{
 806                              loc_sdl=loc_sdr=str_tfl.gospeed;//å·¡çº¿é€Ÿåº¦ä¸ºstr_tfl.gospeed
 807                              if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
 808                                  loc_sdl*=0.5;//å·¦å‡é€Ÿ
 809                                  loc_sdr*=1.5;//å³åŠ é€Ÿ
 810                              }//å‘å·¦è½¬
 811                              if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
 812                                  loc_sdl*=1.5;//å·¦åŠ é€Ÿ
 813                                  loc_sdr*=0.5;//å³å‡é€Ÿ
 814                              }//å‘å³è½¬
 815                              if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
 816                                  loc_sdl*=0.7;//å·¦å‡é€Ÿ
 817                                  loc_sdr*=1.3;//å³åŠ é€Ÿ
 818                              }//å‘å·¦è½¬
 819                              if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
 820                                  loc_sdl*=1.3;//å·¦åŠ é€Ÿ
 821                                  loc_sdr*=0.7;//å³å‡é€Ÿ
 822                              }//å‘å³è½¬
 823                              if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
 824                                  loc_sdl*=0.9;//å·¦å‡é€Ÿ
 825                                  loc_sdr*=1.1;//å³åŠ é€Ÿ
 826                              }//å‘å·¦è½¬
 827                              if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
 828                                  loc_sdl*=1.1;//å·¦åŠ é€Ÿ
 829                                  loc_sdr*=0.9;//å³å‡é€Ÿ
 830                              }//å‘å³è½¬
 831                              fun_motorsrl(mot_r,loc_sdr);
 832                              fun_motorsrl(mot_l,loc_sdl);
 833                          }
 834                      }
 835                      else{//å¦‚æœçº¿èµ°å®Œäº†
 836                          str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 837                          fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœºè¿åŠ¨
 838                      }
 839                      break;
 840                  case tfl_turn://è¿è¡Œè½¬å¼¯
 841                      switch(loc_con){//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½
 842                          case 0://ç¬¬ä¸€æ­¥
 843                              switch(*(str_tfl.run+1)){//è·å–å‚æ•°
 844                                  case tur_r90://å³è½¬90
 845                                      fun_motorsrl(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
 846                                      fun_motorsrl(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
 847                                      str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
 848                                      break;
 849                                  case tur_l90://å·¦è½¬90
 850                                      fun_motorsrl(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
 851                                      fun_motorsrl(mot_r,str_tfl.turnspeed);//å³è½®å‘å‰
 852                                      str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
 853                                      break;
 854                                  case tur_r180://å³è½¬180
 855                                      fun_motorsrl(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 15  

 856                                      fun_motorsrl(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
 857                                      str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
 858                                      break;
 859                                  case tur_l180://å·¦è½¬180
 860                                      fun_motorsrl(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
 861                                      fun_motorsrl(mot_r,str_tfl.turnspeed);//å·¦è½®å‘å‰
 862                                      str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
 863                                      break;
 864                              }
 865                              loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 866                              break;
 867                          case 1://ç¬¬äºŒæ­¥
 868                              if(str_tfl.delay<=var_timer)//è®¡æ—¶æ—¶é—´åˆ°
 869                                  loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 870                              break;
 871                          case 2://ç¬¬ä¸‰æ­¥
 872                              if(in_ls4&&in_ls5){//å¦‚æœä¸­é—´ä¸¤ä¸ªç¯äº®
 873                                  fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœº
 874                                  str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 875                                  str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
 876                                  loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
 877                              }
 878                              break;
 879                      }
 880                      break;
 881                  case tfl_cache://è¿è¡Œå‰å†²
 882                      switch(loc_con){
 883                          case 0://ç¬¬ä¸€æ­¥
 884                              str_tfl.delay=var_timer+((*(str_tfl.run+1))*10);//å»¶æ—¶æ—¶é—´(æ¯«ç§’)ä¸ºå‚æ•°çš„10å€
             -
 885                              loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 886                              break;
 887                          case 1://ç¬¬äºŒæ­¥
 888                              if(str_tfl.delay<=var_timer){//è®¡æ—¶æ—¶é—´åˆ°
 889                                  fun_motorsrl(mot_rl,0);//åœæ­¢ç”µæœº
 890                                  str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 891                                  str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
 892                                  loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
 893                              }
 894                              else{
 895                                  loc_sdl=loc_sdr=str_tfl.cachespeed;//å‰å†²é€Ÿåº¦ä¸ºstr_tfl.cachespeed
 896                                  if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
 897                                      loc_sdl*=0.5;//å·¦å‡é€Ÿ
 898                                      loc_sdr*=1.5;//å³åŠ é€Ÿ
 899                                  }//å‘å·¦è½¬
 900                                  if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
 901                                      loc_sdl*=1.5;//å·¦åŠ é€Ÿ
 902                                      loc_sdr*=0.5;//å³å‡é€Ÿ
 903                                  }//å‘å³è½¬
 904                                  if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
 905                                      loc_sdl*=0.7;//å·¦å‡é€Ÿ
 906                                      loc_sdr*=1.3;//å³åŠ é€Ÿ
 907                                  }//å‘å·¦è½¬
 908                                  if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
 909                                      loc_sdl*=1.3;//å·¦åŠ é€Ÿ
 910                                      loc_sdr*=0.7;//å³å‡é€Ÿ
 911                                  }//å‘å³è½¬
 912                                  if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
 913                                      loc_sdl*=0.9;//å·¦å‡é€Ÿ
 914                                      loc_sdr*=1.1;//å³åŠ é€Ÿ
 915                                  }//å‘å·¦è½¬
 916                                  if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 16  

 917                                      loc_sdl*=1.1;//å·¦åŠ é€Ÿ
 918                                      loc_sdr*=0.9;//å³å‡é€Ÿ
 919                                  }//å‘å³è½¬
 920                                  fun_motorsrl(mot_r,loc_sdr);
 921                                  fun_motorsrl(mot_l,loc_sdl);
 922                              }
 923                              break;
 924                      }
 925                      break;
 926                  case tfl_start://è¿è¡Œå¸¦åŠ é€Ÿçš„å‰å†²
 927          
 928                      break;
 929                  case tfl_end://è¿è¡Œå¸¦å‡é€Ÿçš„å‰å†²
 930          
 931                      break;
 932              }
 933          }//å®šæ—¶å™¨ç§»åŠ¨
 934          void fun_folline(uc par_con,uc par_speed){
 935              uc loc_con=par_con;//å·¡çº¿æ¡æ•°æ ‡å¿—ä½
 936              uc loc_sdr,loc_sdl;//å·¦å³è½®é€Ÿåº¦
 937              uc loc_online;//åœ¨çº¿æ ‡å¿—ä½
 938              while(loc_con){
 939                  if((in_ls1||in_ls8)&&(in_ls2&&in_ls3&&in_ls4&&in_ls5&in_ls6&&in_ls7)){//å¦‚æœä¸­é—´6ä¸ªç¯å…¨äº®,
             -å·¦å³äº®ä»»æ„ä¸€ä¸ª
 940                      loc_online=tf_ture;//æ ‡å¿—ä½è®°å½•åœ¨çº¿
 941                      fun_motors(mot_rl,par_speed);//æŒ‰ç…§å¸¸è§„é€Ÿåº¦è¿‡çº¿
 942                  }
 943                  else if(loc_online==tf_ture){//å¦‚æœæ ‡å¿—ä½è®°å½•åœ¨çº¿,è€Œä¸”ä¸ç¬¦åˆåœ¨çº¿ç‰¹å¾
 944                      loc_online=tf_false;//æ ‡å¿—ä½è®°å½•ä¸åœ¨çº¿
 945                      loc_con--;//å‚æ•°å€¼å‡1,è®°å½•å·²ç»èµ°äº†ä¸€æ¡çº¿
 946                  }
 947                  else{
 948                      loc_sdr=loc_sdl=par_speed;
 949                      if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
 950                          loc_sdl*=0.5;//å·¦å‡é€Ÿ
 951                          loc_sdr*=1.5;//å³åŠ é€Ÿ
 952                      }//å‘å·¦è½¬
 953                      if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
 954                          loc_sdl*=1.5;//å·¦åŠ é€Ÿ
 955                          loc_sdr*=0.5;//å³å‡é€Ÿ
 956                      }//å‘å³è½¬
 957                      if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
 958                          loc_sdl*=0.7;//å·¦å‡é€Ÿ
 959                          loc_sdr*=1.3;//å³åŠ é€Ÿ
 960                      }//å‘å·¦è½¬
 961                      if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
 962                          loc_sdl*=1.3;//å·¦åŠ é€Ÿ
 963                          loc_sdr*=0.7;//å³å‡é€Ÿ
 964                      }//å‘å³è½¬
 965                      if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
 966                          loc_sdl*=0.9;//å·¦å‡é€Ÿ
 967                          loc_sdr*=1.1;//å³åŠ é€Ÿ
 968                      }//å‘å·¦è½¬
 969                      if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
 970                          loc_sdl*=1.1;//å·¦åŠ é€Ÿ
 971                          loc_sdr*=0.9;//å³å‡é€Ÿ
 972                      }//å‘å³è½¬
 973                      fun_motors(mot_r,loc_sdr);
 974                      fun_motors(mot_l,loc_sdl);
 975                      fun_delay(1,del_ms);
 976                  }
 977              }//å¦‚æœå·¡çº¿æ¡æ•°ä¸ä¸º0
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 17  

 978              fun_qc(65,40);
 979          }//ä¸»å‡½æ•°å·¡çº¿
 980          void fun_turn(enum varENU_tur par_model,uc par_speed){
 981              switch(par_model){//è·å–å‚æ•°
 982                  case tur_r90://å³è½¬90
 983                      fun_motors(mot_l,par_speed);//å·¦è½®å‘å‰
 984                      fun_motors(mot_r,-par_speed);//å³è½®å‘å
 985                      fun_delay(str_cod.turn90,del_ms);//è®¡æ—¶
 986                      break;
 987                  case tur_l90://å·¦è½¬90
 988                      fun_motors(mot_l,-par_speed);//å·¦è½®å‘å
 989                      fun_motors(mot_r,par_speed);//å³è½®å‘å‰
 990                      fun_delay(str_cod.turn90,del_ms);//è®¡æ—¶
 991                      break;
 992                  case tur_r180://å³è½¬180
 993                      fun_motors(mot_l,par_speed);//å·¦è½®å‘å‰
 994                      fun_motors(mot_r,-par_speed);//å³è½®å‘å
 995                      fun_delay(str_cod.turn180,del_ms);//è®¡æ—¶
 996                      break;
 997                  case tur_l180://å·¦è½¬180
 998                      fun_motors(mot_l,-par_speed);//å·¦è½®å‘å
 999                      fun_motors(mot_r,par_speed);//å·¦è½®å‘å‰
1000                      fun_delay(str_cod.turn180,del_ms);//è®¡æ—¶
1001                      break;
1002              }
1003              while(!in_ls4||!in_ls5);
1004              fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
1005          }//ä¸»å‡½æ•°è½¬å¼¯
1006          void fun_qc(uc par_time,uc par_speed){
1007              uc loc_sdr,loc_sdl;//å·¦å³è½®é€Ÿåº¦
1008              str_tfl.delay=var_timer+par_time*10;//å»¶æ—¶æ—¶é—´(æ¯«ç§’)ä¸ºå‚æ•°çš„10å€
1009              while(str_tfl.delay>var_timer){
1010                  loc_sdr=loc_sdl=par_speed;
1011                  if(in_ls1&&!in_ls8){//1äº®8ä¸äº®
1012                      loc_sdl*=0.5;//å·¦å‡é€Ÿ
1013                      loc_sdr*=1.5;//å³åŠ é€Ÿ
1014                  }//å‘å·¦è½¬
1015                  if(in_ls8&&!in_ls1){//8äº®1ä¸äº®
1016                      loc_sdl*=1.5;//å·¦åŠ é€Ÿ
1017                      loc_sdr*=0.5;//å³å‡é€Ÿ
1018                  }//å‘å³è½¬
1019                  if(in_ls2&&!in_ls7){//2äº®7ä¸äº®
1020                      loc_sdl*=0.7;//å·¦å‡é€Ÿ
1021                      loc_sdr*=1.3;//å³åŠ é€Ÿ
1022                  }//å‘å·¦è½¬
1023                  if(in_ls7&&!in_ls2){//7äº®2ä¸äº®
1024                      loc_sdl*=1.3;//å·¦åŠ é€Ÿ
1025                      loc_sdr*=0.7;//å³å‡é€Ÿ
1026                  }//å‘å³è½¬
1027                  if(in_ls3&&!in_ls6){//3äº®6ä¸äº®
1028                      loc_sdl*=0.9;//å·¦å‡é€Ÿ
1029                      loc_sdr*=1.1;//å³åŠ é€Ÿ
1030                  }//å‘å·¦è½¬
1031                  if(in_ls6&&!in_ls3){//6äº®3ä¸äº®
1032                      loc_sdl*=1.1;//å·¦åŠ é€Ÿ
1033                      loc_sdr*=0.9;//å³å‡é€Ÿ
1034                  }//å‘å³è½¬
1035                  fun_motors(mot_r,loc_sdr);
1036                  fun_motors(mot_l,loc_sdl);
1037                  fun_delay(1,del_ms);
1038              }
1039              fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 18  

1040          }//ä¸»å‡½æ•°å‰å†²
1041          void fun_stope2prom(){
1042              IAP_CONTR = 0;                  //å…³é—­IAPåŠŸèƒ½
1043              IAP_CMD = 0;                    //æ¸…é™¤å‘½ä»¤
1044              IAP_TRIG = 0;                   //æ¸…é™¤è§¦å‘å¯„å­˜å™¨
1045              IAP_ADDRH = 0x80;               //æ•°æ®æŒ‡é’ˆæŒ‡å‘éEEPROMåŒº
1046              IAP_ADDRL = 0;                  //æ¸…é™¤IAPåœ°å€
1047          }//å…³é—­EEPROMåŠŸèƒ½(IapIdle)
1048          uc fun_reade2prom(ui par_add){
1049              uc loc_dat;                     //æ•°æ®ç¼“å†²åŒº
1050              IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1051              IAP_CMD = 1;                    //è®¾ç½®EEPROMè¯»å‘½ä»¤
1052              IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1053              IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1054              IAP_TRIG = 0x5a;                //è§¦å‘
1055              IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1056              fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1057              loc_dat = IAP_DATA;             //è¯»å‡ºEEPROMä¸­çš„æ•°æ®
1058              fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1059              return loc_dat;                 //è¿”å›è¯»å–ç»“æœ
1060          }//è¯»å–EEPROMæ•°æ®
1061          void fun_writee2prom(ui par_add,uc par_dat){
1062              IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1063              IAP_CMD = 2;                    //è®¾ç½®EEPROMå†™å…¥å‘½ä»¤
1064              IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1065              IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1066              IAP_DATA = par_dat;             //å†™å…¥æ•°æ®
1067              IAP_TRIG = 0x5a;                //è§¦å‘
1068              IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1069              fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1070              fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1071          }//å†™EEPROMæ•°æ®
1072          void fun_cleane2prom(ui par_add){
1073              IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
1074              IAP_CMD = 3;                    //è®¾ç½®EEPROMæ“¦é™¤å‘½ä»¤
1075              IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
1076              IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
1077              IAP_TRIG = 0x5a;                //è§¦å‘
1078              IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
1079              fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
1080              fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
1081          }//æ¸…é™¤EEPROMæ•°æ®
1082          void fun_calibration(){
1083              // fun_sj1(sjp_1);//å‡åˆ°æœ€ä¸Šä½
1084              ul loc_time;
1085              fun_py1(tra_q);//ç§»åŠ¨åˆ°æœ€å‰ç«¯
1086              fun_py1(tra_h);//ç§»åŠ¨åˆ°æœ€åç«¯
1087              loc_time=var_timer;
1088              fun_py1(tra_q);//ç§»åŠ¨åˆ°å‰ç«¯å¹¶è®¡æ—¶
1089              fun_py1(tra_h);//ç§»åŠ¨åˆ°åç«¯
1090              loc_time=var_timer-loc_time;
1091              loc_time*=0.5;
1092              str_cod.py1zh=loc_time*0.5;//ä»ååˆ°ä¸­é—´
1093              str_cod.py1qz=loc_time*0.5;//ä»å‰åˆ°ä¸­é—´
1094              str_cod.py1qkh=loc_time*0.75;//ä»å‰åˆ°é å
1095              str_cod.py1kqh=loc_time*0.564;//ä»é å‰åˆ°å
1096              str_cod.py1qkq=loc_time*0.34;//ä»å‰åˆ°é å‰
1097              str_cod.py1khh=loc_time*0.2701;//ä»ååˆ°é å
1098              str_cod.py1kqz=loc_time*0.189;//ä»é å‰åˆ°ä¸­é—´
1099              str_cod.py1zkh=loc_time*0.20;//ä»é ååˆ°ä¸­é—´.
1100              str_cod.py1kqkh=loc_time*0.5;//ä»é å‰åˆ°é å
1101          }//è‡ªåŠ¨æ ¡å‡†å¹³ç§»å‚æ•°
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 19  

1102          void fun_port(){
1103              /*
1104              PCON|=0x80;     //ä½¿èƒ½æ³¢ç‰¹ç‡å€é€Ÿä½SMOD
1105              SCON=0x50;      //8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡
1106              AUXR|=0x04;     //ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨æ—¶é’Ÿä¸ºFosc,å³1T
1107              BRT=0xD9;       //è®¾å®šç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨é‡è£…å€¼
1108              AUXR|=0x01;     //ä¸²å£1é€‰æ‹©ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1109              AUXR|=0x10;     //å¯åŠ¨ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1110              TI=1;           //æ‰“å¼€ä¸²å£ä¼ è¾“åŠŸèƒ½
1111              */
1112              //38400bps@30.000MHz
1113              PCON |= 0x80;       //ä½¿èƒ½æ³¢ç‰¹ç‡å€é€Ÿä½SMOD
1114              SCON = 0x50;        //8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡
1115              AUXR |= 0x04;       //ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨æ—¶é’Ÿä¸ºFosc,å³1T
1116              BRT = 0xCF;     //è®¾å®šç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨é‡è£…å€¼
1117              AUXR |= 0x01;       //ä¸²å£1é€‰æ‹©ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1118              AUXR |= 0x10;       //å¯åŠ¨ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨
1119              TI=1;           //æ‰“å¼€ä¸²å£ä¼ è¾“åŠŸèƒ½
1120          }//ä¸²å£åˆå§‹åŒ–
1121          void fun_test(){
1122              fun_sz1(han_j);
1123              fun_delay(1,del_s);
1124              fun_sz1(han_s);
1125              fun_delay(1,del_s);
1126              fun_sz1(han_j);
1127              fun_delay(1,del_s);
1128              fun_sz1(han_s);
1129              fun_delay(1,del_s);
1130          
1131              str_begin.pywz=tra_h;
1132              fun_py1(tra_q);
1133              fun_delay(1,del_s);
1134              fun_py1(tra_h);
1135              fun_delay(1,del_s);
1136              fun_py1(tra_q);
1137              fun_delay(1,del_s);
1138              fun_py1(tra_h);
1139              fun_delay(1,del_s);
1140          
1141              fun_sj1(sjp_1);
1142              fun_delay(1,del_s);
1143              fun_sj1(sjp_2);
1144              fun_delay(1,del_s);
1145              fun_sj1(sjp_3);
1146              fun_delay(1,del_s);
1147              fun_sj1(sjp_4);
1148              fun_delay(1,del_s);
1149              fun_sj1(sjp_5);
1150              fun_delay(1,del_s);
1151              fun_sj1(sjp_4);
1152              fun_delay(1,del_s);
1153              fun_sj1(sjp_3);
1154              fun_delay(1,del_s);
1155              fun_sj1(sjp_2);
1156              fun_delay(1,del_s);
1157              fun_sj1(sjp_1);
1158          
1159              str_now.hzfx=str_begin.hzfx;
1160              str_begin.hzfx=dir_up;
1161              fun_hz1(dir_right);
1162              fun_delay(1,del_s);
1163              fun_hz1(dir_up);
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 20  

1164              fun_delay(1,del_s);
1165              fun_hz1(dir_right);
1166              fun_delay(1,del_s);
1167              fun_hz1(dir_up);
1168              fun_delay(1,del_s);
1169              str_begin.hzfx=str_now.hzfx;
1170          
1171              fun_motors(mot_rl,60);
1172              fun_delay(1,del_s);
1173              fun_motors(mot_rl,0);
1174              fun_delay(1,del_s);
1175          
1176              fun_motors(mot_rl,-60);
1177              fun_delay(1,del_s);
1178              fun_motors(mot_rl,0);
1179              fun_delay(1,del_s);
1180          
1181              fun_motors(mot_r,40);
1182              fun_motors(mot_l,-40);
1183              fun_delay(1,del_s);
1184              fun_motors(mot_rl,0);
1185              fun_delay(1,del_s);
1186          
1187              fun_motors(mot_r,-40);
1188              fun_motors(mot_l,40);
1189              fun_delay(1,del_s);
1190              fun_motors(mot_rl,0);
1191          }//æµ‹è¯•ç¨‹åº
1192          uc fun_min(uc par_num,...){
1193              va_list loc_argp;//ä¿å­˜å‚æ•°ç»“æ„
1194              uc loc_min=par_num;//ç°åœ¨çš„æœ€å°å€¼å°±æ˜¯ç¬¬ä¸€ä¸ª
1195              uc loc_shu;//å½“å‰å‚æ•°
1196              va_start(loc_argp,par_num);//loc_argpæŒ‡å‘ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œpar_numæ˜¯æœ€åä¸€ä¸ªç¡®å
             -®šçš„å‚æ•°
1197              loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
1198              do{
1199                  if(loc_shu<loc_min)
1200                      loc_min=loc_shu;
1201                  loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
1202              }while(loc_shu!=def_end);
1203              va_end(loc_argp);//ç»“æŸ
1204              return loc_min;//é€€å‡º
1205          }//æ±‚æœ€å°å€¼
1206          void fun_coordinate(){
1207              
1208          }//è‡ªåŠ¨å·¡çº¿ä¹‹åæ ‡
1209          void fun_zdzj(ul par_04,ul par_37){//ulå‹æ•°æ®,ä¸€æ¬¡è¾“å…¥æ‰€æœ‰ç»“æœ,æ— éœ€ç­‰å¾…
1210              xdata uc loc_data[8][5][2];//8ä¸ªæŠ“ä»¶åŒº(0~7),5ä¸ªé«˜åº¦(0~4),0ä¸ºç°åœ¨ä»¶åº/1ä¸ºæœ€ç»ˆä»¶åº
1211              xdata uc loc_high[8];//8ä¸ªé«˜åº¦,æ¯ä¸ªä¸º0-4(ä½ç½®1~ä½ç½®5),5è¡¨ç¤ºæ²¡æœ‰ä»¶
1212              memset(loc_data,0,sizeof(loc_data));//æ¸…ç©ºæ•°ç»„
1213              
1214              //å°†ç°æœ‰ä»¶åºå‚æ•°åˆ‡ç‰‡ä¼ é€’ç»™æ•°ç»„çš„å„ä¸ªå…ƒç´ 
1215              loc_data[0][2][0]=(par_04/10000000)%10;
1216              loc_data[0][3][0]=(par_04/1000000)%10;
1217              loc_data[0][4][0]=(par_04/100000)%10;
1218              loc_data[0][5][0]=(par_04/10000)%10;
1219              loc_data[4][2][0]=(par_04/1000)%10;
1220              loc_data[4][3][0]=(par_04/100)%10;
1221              loc_data[4][4][0]=(par_04/10)%10;
1222              loc_data[4][5][0]=par_04%10;
1223              //å°†æœ€ç»ˆä»¶åºå‚æ•°åˆ‡ç‰‡ä¼ é€’ç»™æ•°ç»„çš„å„ä¸ªå…ƒç´ 
1224              loc_data[3][2][0]=(par_37/10000000)%10;
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 21  

1225              loc_data[3][3][0]=(par_37/1000000)%10;
1226              loc_data[3][4][0]=(par_37/100000)%10;
1227              loc_data[3][5][0]=(par_37/10000)%10;
1228              loc_data[7][2][0]=(par_37/1000)%10;
1229              loc_data[7][3][0]=(par_37/100)%10;
1230              loc_data[7][4][0]=(par_37/10)%10;
1231              loc_data[7][5][0]=par_37%10;
1232          
1233              //å°†æ¬¡åºä¼ å…¥æ•°ç»„
1234              loc_data[3][2][1]=1;
1235              loc_data[3][3][1]=2;
1236              loc_data[3][4][1]=3;
1237              loc_data[3][5][1]=4;
1238              loc_data[7][2][1]=5;
1239              loc_data[7][3][1]=6;
1240              loc_data[7][4][1]=7;
1241              loc_data[7][5][1]=8;
1242          
1243              if(str_begin.hzfx==dir_up||str_begin.hzfx==dir_down)//å¦‚æœå›è½¬æ–¹å‘åœ¨ä¸Šä¸‹
1244                  fun_hz1(dir_right);//é‚£ä¹ˆå°±ç§»åˆ°å³è¾¹
1245              while(0){
1246                  if(str_begin.hzfx==dir_right){
1247                      if(loc_high[0]<5){
1248                          if((loc_data[0][loc_high[0]][0]==loc_data[3][1][1])||
1249                          (loc_data[0][loc_high[0]][0]==loc_data[3][2][1])||
1250                          (loc_data[0][loc_high[0]][0]==loc_data[3][3][1])||
1251                          (loc_data[0][loc_high[0]][0]==loc_data[3][4][1])){
1252                              if(loc_data[0][loc_high[0]][0]==loc_data[3][loc_high[3]][1]){
1253                                  MSG("0 --> 3")
1254                              }//0 --> 3
1255                              else{
1256                                  if(/*0 --> 1*/){
1257                                      /* code */
1258                                  }//0 --> 1
1259                                  else if(/*0 --> 2*/){
1260                                      /* code */
1261                                  }//0 --> 2
1262                              }//ä¸èƒ½ä¸€æ¬¡åˆ°ä½çš„è¯
1263                          }//å¦‚æœ0åŒºæœ€ä¸Šé¢çš„ä»¶åº”è¯¥æ”¾åœ¨3åŒº
1264                          else if((loc_data[0][loc_high[0]][0]==loc_data[7][1][1])||
1265                          (loc_data[0][loc_high[0]][0]==loc_data[7][2][1])||
1266                          (loc_data[0][loc_high[0]][0]==loc_data[7][3][1])||
1267                          (loc_data[0][loc_high[0]][0]==loc_data[7][4][1])){
1268                              if(loc_data[0][loc_high[0]][0]==loc_data[7][loc_high[7]][1]){
1269                                  MSG("0 --> 7")
1270                              }//0 --> 7
1271                              else{
1272                                  if(/*0 --> 5*/){
1273                                      /* code */
1274                                  }//0 --> 5
1275                                  else if(/*0 --> 6*/){
1276                                      /* code */
1277                                  }//0 --> 6
1278                              }//ä¸èƒ½ä¸€æ¬¡åˆ°ä½çš„è¯
1279                          }//å¦‚æœ0åŒºæœ€ä¸Šé¢çš„ä»¶åº”è¯¥æ”¾åœ¨7åŒº
1280                      }//å¦‚æœ0åŒºæœ‰ä»¶
1281                      if(loc_high[1]<5){
1282                          if(loc_data[1][loc_high[1]][0]==loc_data[3][loc_high[3]][1]){
1283                              MSG("1 --> 3")
1284                          }//1 --> 3
1285                          else if(loc_data[1][loc_high[1]][0]==loc_data[7][loc_high[7]][1]){
1286                              MSG("1 --> 7")
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 22  

1287                          }//1 --> 7
1288                      }//å¦‚æœ1åŒºæœ‰ä»¶
1289                      if(loc_high[2]<5){
1290                          if(loc_data[2][loc_high[2]][0]==loc_data[3][loc_high[3]][1]){
1291                              MSG("2 --> 3")
1292                          }//2 --> 3
1293                          else if(loc_data[2][loc_high[2]][0]==loc_data[7][loc_high[7]][1]){
1294                              MSG("2 --> 7")
1295                          }//2 --> 7
1296                      }//å¦‚æœ2åŒºæœ‰ä»¶
1297                  }//å¦‚æœåœ¨å³è¾¹
1298                  else{
1299                      if(loc_high[4]<5){
1300                          if(loc_data[4][loc_high[4]][0]==loc_data[7][loc_high[7]][1]){
1301                              MSG("4 --> 7")
1302                          }//4 --> 7
1303                          else if(loc_data[4][loc_high[4]][0]==loc_data[3][loc_high[3]][1]){
1304                              MSG("4 --> 3")
1305                          }//4 --> 3
1306                      }//å¦‚æœåŒº4æœ‰ä»¶
1307                      if(loc_high[5]<5){
1308                          if(loc_data[5][loc_high[5]][0]==loc_data[7][loc_high[7]][1]){
1309                              MSG("5 --> 7")
1310                          }//5 --> 7
1311                          else if(loc_data[5][loc_high[5]][0]==loc_data[3][loc_high[3]][1]){
1312                              MSG("5 --> 3")
1313                          }//5 --> 3
1314                      }//å¦‚æœåŒº5æœ‰ä»¶
1315                      if(loc_high[6]<5){
1316                          if(loc_data[6][loc_high[6]][0]==loc_data[7][loc_high[7]][1]){
1317                              MSG("6 --> 7")
1318                          }//6 --> 7
1319                          else if(loc_data[6][loc_high[6]][0]==loc_data[3][loc_high[3]][1]){
1320                              MSG("6 --> 3")
1321                          }//6 --> 3
1322                      }//å¦‚æœåŒº6æœ‰ä»¶
1323                  }//å¦‚æœåœ¨å·¦è¾¹
1324              }
1325          }//è‡ªåŠ¨æŠ“ä»¶
1326          void fun_zjzt(uc par_model){
1327              switch(par_model){
1328                  case 0:
1329                      fun_py1(tra_z);
1330                      fun_hz1(dir_left);
1331                      fun_py1(tra_h);
1332                      break;
1333                  case 1:
1334                      fun_py1(tra_z);
1335                      fun_hz1(dir_left);
1336                      fun_py1(tra_kh);
1337                      break;
1338                  case 2:
1339                      fun_py1(tra_z);
1340                      fun_hz1(dir_left);
1341                      fun_py1(tra_kq);
1342                      break;
1343                  case 3:
1344                      fun_py1(tra_z);
1345                      fun_hz1(dir_left);
1346                      fun_py1(tra_q);
1347                      break;
1348                  case 4:
C51 COMPILER V9.54   8023                                                                  09/17/2015 11:43:04 PAGE 23  

1349                      fun_py1(tra_z);
1350                      fun_hz1(dir_right);
1351                      fun_py1(tra_q);
1352                      break;
1353                  case 5:
1354                      fun_py1(tra_z);
1355                      fun_hz1(dir_right);
1356                      fun_py1(tra_kq);
1357                      break;
1358                  case 6:
1359                      fun_py1(tra_z);
1360                      fun_hz1(dir_right);
1361                      fun_py1(tra_kh);
1362                      break;
1363                  case 7:
1364                      fun_py1(tra_z);
1365                      fun_hz1(dir_right);
1366                      fun_py1(tra_h);
1367                      break;
1368              }
1369          }//æŠ“ä»¶çŠ¶æ€,0ä¸ºå·¦ä¸Šä½,3ä¸ºå·¦ä¸‹ä½,4ä¸ºå³ä¸Šä½,7ä¸ºå³ä¸‹ä½
1370          void fun_zhuajian(){
1371              fun_folline(2,70);
1372              fun_turn(tur_l90,40);
1373              fun_folline(1,40);
1374          }//ä»èµ·å§‹åŒºèµ°åˆ°æŠ“ä»¶åŒº
1375          void fun_back(){
1376              fun_motors(mot_rl,-20);
1377              fun_delay(1,del_s);
1378          
1379              fun_motors(mot_rl,-50);
1380              fun_delay(1,del_s);
1381          
1382              fun_motors(mot_r,-50);
1383              fun_motors(mot_l,-20);
1384              fun_delay(1,del_s);
1385          }//ä»æŠ“ä»¶åŒºå›åˆ°èµ·å§‹åŒº

C51 COMPILATION COMPLETE.  0 WARNING(S),  4 ERROR(S)
