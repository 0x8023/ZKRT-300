C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE 8023
OBJECT MODULE PLACED IN .\output\8023.obj
COMPILER INVOKED BY: D:\MyProgram\keil\C51\BIN\C51.EXE program\8023.c OPTIMIZE(8,SPEED) DEBUG OBJECTEXTEND PRINT(.\8023.
                    -lst) TABS(2) OBJECT(.\output\8023.obj)

line level    source

   1          #include "./output/8023.h"
   2          xdata struct str_state str_begin,str_now,str_next;//åˆ†åˆ«ä¸º:èµ·å§‹çŠ¶æ€/å½“å‰çŠ¶æ€/ç›®æ ‡çŠ¶æ€
   3          xdata struct str_parameter str_cod={
   4              /*ui str_cod.mlinerqd*/25000,//é»˜è®¤ä¸»å‡½æ•°å·¡çº¿è½¯èµ·åŠ¨è·¯ç¨‹ä¸º25000
   5              /*ui str_cod.mlineqc*/200,   //é»˜è®¤ä¸»å‡½æ•°å·¡çº¿å‰å†²æ—¶é—´ä¸º500æ¯«ç§’
   6          
   7              /*ui str_cod.sj1bzw*/58,     //å‡é™æ ‡å‡†ä½å»¶æ—¶
   8              /*ui str_cod.sj1zjw*/800,    //å‡é™ä¸­é—´ä½å»¶æ—¶
   9          
  10              /*ui str_cod.py1bz*/20,      //fun_py1æ ‡å‡†ä½å»¶æ—¶
  11              /*ui str_cod.py1qkq*/666,    //fun_py1å‰åˆ°é å‰å»¶æ—¶å‚æ•°
  12              /*ui str_cod.py1kqz*/684,    //fun_py1é å‰åˆ°ä¸­é—´å»¶æ—¶
  13              /*ui str_cod.py1zkh*/684,    //fun_py1ä¸­é—´åˆ°é åå»¶æ—¶
  14              /*ui str_cod.py1khh*/666,    //fun_py1é ååˆ°åå»¶æ—¶
  15              /*ui str_cod.py1qz*/500,     //fun_py1å‰åˆ°ä¸­é—´å»¶æ—¶
  16              /*ui str_cod.py1zh*/500,     //fun_py1ä¸­é—´åˆ°åå»¶æ—¶
  17              /*ui str_cod.py1kqkh*/1480,  //fun_py1é å‰åˆ°é åå»¶æ—¶
  18              /*ui str_cod.py1qkh*/2122,   //fun_py1å‰åˆ°é åå»¶æ—¶
  19              /*ui str_cod.py1kqh*/2122,   //fun_py1é å‰åˆ°åå»¶æ—¶
  20          
  21              /*ui str_cod.hz1bz*/20,      //fun_hz1æ ‡å‡†ä½å»¶æ—¶
  22          
  23              /*ui turn90;*/500,           //90åº¦è½¬å¼¯å±è”½å»¶æ—¶
  24              /*ui turn180;*/2000          //180åº¦è½¬å¼¯å±è”½å»¶æ—¶
  25          };
  26          xdata struct str_timerfolline str_tfl;
  27          ul var_timer=0;
  28          void fun_delay(ui par_value,enum varENU_del par_model){
  29   1          ui loc_con=par_value;
  30   1          switch(par_model){
  31   2              case del_us://å¾®ç§’çº§å»¶æ—¶
  32   2                  while(loc_con-->0){
  33   3                      _nop_();
  34   3                      _nop_();
  35   3                  }
  36   2                  return;
  37   2              case del_ms://æ¯«ç§’çº§å»¶æ—¶
  38   2                  while(loc_con-->0){
  39   3                      uc loc_i, loc_j;
  40   3                      _nop_();
  41   3                      _nop_();
  42   3                      loc_i=12;
  43   3                      loc_j=168;
  44   3                      do{
  45   4                          while(--loc_j);
  46   4                      }while(--loc_i);
  47   3                  }
  48   2                  return;
  49   2              case del_s://ç§’çº§å»¶æ—¶
  50   2                  while(loc_con-->0){
  51   3                      uc loc_i, loc_j, loc_k;
  52   3                      loc_i=46;
  53   3                      loc_j=153;
  54   3                      loc_k=245;
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 2   

  55   3                      do{
  56   4                          do{
  57   5                              while(--loc_k);
  58   5                          }while(--loc_j);
  59   4                      }while(--loc_i);
  60   3                  }
  61   2                  return;
  62   2              default:return;
  63   2          }
  64   1      }//å»¶æ—¶
  65          void fun_timer0init(){
  66   1          AUXR|=0x80;   //å®šæ—¶å™¨æ—¶é’Ÿ1Tæ¨¡å¼
  67   1          TMOD&=0xF0;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  68   1          TMOD|=0x01;   //å®šæ—¶å™¨æ¨¡å¼:16ä½
  69   1          TL0=0x20;     //å®šæ—¶åˆå€¼:1ms
  70   1          TH0=0xD1;     //å®šæ—¶åˆå€¼:1ms
  71   1          TF0=0;        //æ¸…é™¤TF0æ ‡å¿—
  72   1          ET0=1;
  73   1          EA=1;         //å¼€å¯æ€»ä¸­æ–­
  74   1      }//1æ¯«ç§’å®šæ—¶å™¨0åˆå§‹åŒ–
  75          void fun_timer1init(){
  76   1          AUXR&=0xBF;     //å®šæ—¶å™¨æ—¶é’Ÿ12Tæ¨¡å¼
  77   1          TMOD&=0x0F;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  78   1          TMOD|=0x10;     //å®šæ—¶å™¨æ¨¡å¼:16ä½
  79   1          TL1=0xE0;       //å®šæ—¶åˆå€¼:20ms
  80   1          TH1=0xB1;       //å®šæ—¶åˆå€¼:20ms
  81   1          TF1=0;          //æ¸…é™¤TF1æ ‡å¿—
  82   1          ET1=1;
  83   1          EA=1;           //å¼€å¯æ€»ä¸­æ–­
  84   1      }//20æ¯«ç§’å®šæ—¶å™¨1åˆå§‹åŒ–
  85          void fun_timer0(){
  86   1          TL0=0x20;
  87   1          TH0=0xD1;//å®šæ—¶å™¨åˆå€¼æ¢å¤è‡³1ms
  88   1          var_timer++;//å…¨å±€è®¡æ—¶å™¨å¼€å§‹è®¡æ—¶
  89   1          if(str_tfl.doing==tf_ture)//å¦‚æœæ­£åœ¨ç§»åŠ¨
  90   1              fun_timermove();//å®šæ—¶å™¨ç§»åŠ¨
  91   1      }//1æ¯«ç§’å®šæ—¶å™¨0å¤„ç†å‡½æ•°
  92          void fun_timer1(){
  93   1          TL1=0xE0;
  94   1          TH1=0xB1;
  95   1          if((*str_tfl.run==tfl_line)||(*str_tfl.run==tfl_cache))//å¦‚æœå°è½¦åœ¨å‰å†²çŠ¶æ€æˆ–å·¡çº¿çŠ¶æ€
  96   1              if(str_tfl.online==tf_false)//å¦‚æœå°è½¦ä¸åœ¨çº¿
  97   1                  fun_dtjp();//å¯åŠ¨åŠ¨æ€çº å
  98   1      }//20æ¯«ç§’å®šæ—¶å™¨1å¤„ç†å‡½æ•°
  99          void fun_wait(){
 100   1          while(in_start==1);
 101   1          fun_delay(20,del_ms);
 102   1          while(in_start==0);
 103   1          fun_delay(256,del_ms);
 104   1      }//ç­‰å¾…æŒ‰é”®
 105          void fun_initialization(){
 106   1          CLK_DIV=0x00;//ä¸åˆ†é¢‘
 107   1      
 108   1          P0M1=0xff;//P0ç”¨äºè¾“å…¥
 109   1          P0M0=0x00;//P0ä¸èƒ½è¾“å‡º
 110   1          
 111   1          P1M1=0x00;//P1å£0-1åŒå‘ï¼Œ2ä¸­æ–­è¾“å…¥ï¼Œ3-6è¾“å…¥ï¼Œ7è¾“å‡º
 112   1          P1M0=0xfc;//P1å£2-7è¾“å‡º
 113   1      
 114   1          P2M1=0xf0;//P2å£4-7è¾“å…¥
 115   1          P2M0=0x0f;//P2å£0-3è¾“å‡º
 116   1      
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 3   

 117   1          //PS_2=1;//æ‰‹æŠ“æ¾ä¼ æ„Ÿå™¨ç½®1 $?$
 118   1          //PS_11=1;//å‡é™ä½ç½®3ä¼ æ„Ÿå™¨ç½®1 $?$
 119   1      
 120   1          out_en1=1;//ç”µæœº1/3ä½¿èƒ½ $?$
 121   1          out_en2=1;//ç”µæœº2/4ä½¿èƒ½ $?$
 122   1          //out_motorselect=1;//ç”µæœºç‰‡é€‰ä¸º1 $?$
 123   1          //fun_delay(del_ms,1);//å»¶æ—¶1æ¯«ç§’ $?$
 124   1          out_motorselect=0;//ç”µæœºç‰‡é€‰ä¸º0 $?$
 125   1          //PS_5=PS_1;// $?$
 126   1      
 127   1          fun_pwminit();//PWMçš„åˆå§‹åŒ–è®¾ç½®
 128   1          fun_timer0init();//åˆå§‹åŒ–å®šæ—¶å™¨0
 129   1          fun_timer1init();//åˆå§‹åŒ–å®šæ—¶å™¨1
 130   1          fun_port();//åˆå§‹åŒ–ä¸²å£
 131   1          in_start=1;//æŒ‰é”®ç½®1
 132   1      
 133   1          fun_wait();
 134   1      }//åˆå§‹åŒ–
 135          void fun_pwminit(){
 136   1          CCON=0x00;//PACå¯„å­˜æ§åˆ¶å™¨
 137   1          CH=0;//é‡ç½®PACè®¡æ—¶å™¨
 138   1          CL=0;
 139   1          CMOD=0x08;//ä¸åˆ†é¢‘
 140   1      }//PWMåˆå§‹åŒ–
 141          void fun_pwmr(uc par_value){
 142   1          CCAP0H=CCAP0L=par_value*2.55;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 143   1          CCAPM0=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 144   1          PCA_PWM0=0x00;
 145   1      }//å³è·¯PWMè¾“å‡º
 146          void fun_pwml(uc par_value){
 147   1          CCAP1H=CCAP1L=par_value*2.55;//æ§åˆ¶è¾“å‡ºçš„å ç©ºæ¯”
 148   1          CCAPM1=0X42;//8ä½PWMè¾“å‡ºï¼Œæ— ä¸­æ–­
 149   1          PCA_PWM1=0x00;
 150   1      }//å·¦è·¯PWMè¾“å‡º
 151          void fun_motors(enum varENU_mot par_model,char par_speed) reentrant{
 152   1          if(par_speed>100)
 153   1              par_speed=100;
 154   1          else if(par_speed<-100)
 155   1              par_speed=-100;//é€Ÿåº¦æœ€å¤š100,æœ€å°‘-100
 156   1          switch(par_model){
 157   2              case mot_l://å·¦è½®ç”µæœº
 158   2                  if(str_begin.leftsd==par_speed)
 159   2                      return;
 160   2                  else
 161   2                      str_begin.leftsd=par_speed;
 162   2                  if(par_speed==0){
 163   3                      fun_pwml(0);out_pwml=0;
 164   3                  }
 165   2                  else if(par_speed>0){
 166   3                      CR=1;fun_pwml(par_speed);out_pwml=0;
 167   3                  }
 168   2                  else if(par_speed<0){
 169   3                      CR=1;fun_pwml(cabs(par_speed));out_pwml=1;
 170   3                  }
 171   2                  break;
 172   2              case mot_r://å³è½®ç”µæœº
 173   2                  if(str_begin.rightsd==par_speed)
 174   2                      return;
 175   2                  else
 176   2                      str_begin.rightsd=par_speed;
 177   2                  if(par_speed==0){
 178   3                      fun_pwmr(0);out_pwmr=0;
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 4   

 179   3                  }
 180   2                  else if(par_speed>0){
 181   3                      CR=1;fun_pwmr(par_speed);out_pwmr=0;
 182   3                  }
 183   2                  else if(par_speed<0){
 184   3                      CR=1;fun_pwmr(cabs(par_speed));out_pwmr=1;
 185   3                  }
 186   2                  break;
 187   2              case mot_rl://å·¦å³è½®åŒæ­¥
 188   2                  if((str_begin.leftsd==par_speed)&&(str_begin.rightsd==par_speed))
 189   2                      return;
 190   2                  else
 191   2                      str_begin.leftsd=str_begin.rightsd=par_speed;
 192   2                  if(par_speed==0){
 193   3                      CR=0;
 194   3                      fun_pwmr(0);out_pwmr=0;
 195   3                      fun_pwml(0);out_pwml=0;
 196   3                  }
 197   2                  else if(par_speed>0){
 198   3                      CR=1;
 199   3                      fun_pwml(par_speed);out_pwml=0;
 200   3                      fun_pwmr(par_speed);out_pwmr=0;
 201   3                  }
 202   2                  else if(par_speed<0){
 203   3                      CR=1;
 204   3                      fun_pwml(cabs(par_speed));out_pwml=1;
 205   3                      fun_pwmr(cabs(par_speed));out_pwmr=1;
 206   3                  }
 207   2                  break;
 208   2              case mot_sz://æ­£è½¬ä¸ºæŠ“ç´§ï¼Œåè½¬ä¸ºæ¾å¼€
 209   2                  if(str_begin.szsd==par_speed)
 210   2                      return;
 211   2                  else
 212   2                      str_begin.szsd=par_speed;
 213   2                  if(par_speed==0){
 214   3                      out_motorselect=1;out_dir1=0;out_en1=1;
 215   3                  }
 216   2                  else if(par_speed>0){
 217   3                      out_motorselect=1;out_dir1=1;out_en1=0;
 218   3                  }
 219   2                  else if(par_speed<0){
 220   3                      out_motorselect=1;out_dir1=0;out_en1=0;
 221   3                  }
 222   2                  break;
 223   2              case mot_py://æ­£è½¬æ˜¯å‘æ— ç”µæœºä¸€æ–¹è½¬,åè½¬ä¸ºå‘æœ‰ç”µæœºä¸€æ–¹è½¬
 224   2                  if(str_begin.pysd==par_speed)
 225   2                      return;
 226   2                  else
 227   2                      str_begin.pysd=par_speed;
 228   2                  if(par_speed==0){
 229   3                      out_motorselect=1;out_dir2=0;out_en2=1;
 230   3                  }
 231   2                  else if(par_speed>0){
 232   3                      out_motorselect=1;out_dir2=1;out_en2=0;
 233   3                  }
 234   2                  else if(par_speed<0){
 235   3                      out_motorselect=1;out_dir2=0;out_en2=0;
 236   3                  }
 237   2                  break;
 238   2              case mot_sj://å‘ä¸Šä¸ºæ­£è½¬,å‘ä¸‹ä¸ºåè½¬
 239   2                  if(str_begin.sjsd==par_speed)
 240   2                      return;
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 5   

 241   2                  else
 242   2                      str_begin.sjsd=par_speed;
 243   2                  if(par_speed==0){
 244   3                      out_motorselect=0;out_dir1=0;out_en1=1;
 245   3                  }
 246   2                  else if(par_speed>0){
 247   3                      out_motorselect=0;out_dir1=0;out_en1=0;
 248   3                  }
 249   2                  else if(par_speed<0){
 250   3                      out_motorselect=0;out_dir1=1;out_en1=0;
 251   3                  }
 252   2                  break;
 253   2              case mot_hz://é¡ºæ—¶é’ˆä¸ºæ­£è½¬,é€†æ—¶é’ˆä¸ºåè½¬
 254   2                  if(str_begin.hzsd==par_speed)
 255   2                      return;
 256   2                  else
 257   2                      str_begin.hzsd=par_speed;
 258   2                  if(par_speed==0){
 259   3                      out_motorselect=0;out_dir2=0;out_en2=1;
 260   3                  }
 261   2                  else if(par_speed>0){
 262   3                      out_motorselect=0;out_dir2=0;out_en2=0;
 263   3                  }
 264   2                  else if(par_speed<0){
 265   3                      out_motorselect=0;out_dir2=1;out_en2=0;
 266   3                  }
 267   2                  break;
 268   2              default:
 269   2                  break;
 270   2          }
 271   1      }//æ“ä½œç”µæœº(å¯é‡å…¥)
 272          void fun_sz1(enum varENU_han par_model){
 273   1          if(str_begin.szzt==par_model)
 274   1              return;
 275   1          if(par_model==han_s){//æ‰‹æŠ“æ¾
 276   2              fun_motors(mot_sz,-100);
 277   2              while(in_s==1);
 278   2          }
 279   1          else{//æ‰‹æŠ“ç´§
 280   2              fun_motors(mot_sz,100);
 281   2              while(in_j==1);
 282   2          }
 283   1          fun_delay(20,del_ms);
 284   1          fun_motors(mot_sz,0);
 285   1          str_begin.szzt=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 286   1      }//æ‰‹æŠ“å•æ­¥è¿åŠ¨
 287          void fun_py1(enum varENU_tra par_model){
 288   1          if(str_begin.pywz==par_model)
 289   1              return;
 290   1          switch(par_model){
 291   2              case tra_q://å‰å¹³ç§»(æ²¡æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 292   2                  fun_motors(mot_py,100);
 293   2                  while(in_qpy==1);
 294   2                  fun_delay(str_cod.py1bz,del_ms);
 295   2                  break;
 296   2              case tra_kq:
 297   2                  switch(str_begin.pywz){
 298   3                      case tra_q:
 299   3                          fun_motors(mot_py,-100);
 300   3                          fun_delay(str_cod.py1qkq,del_ms);
 301   3                          break;
 302   3                      case tra_z:
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 6   

 303   3                          fun_motors(mot_py,100);
 304   3                          fun_delay(str_cod.py1kqz,del_ms);
 305   3                          break;
 306   3                      case tra_kh:
 307   3                          fun_motors(mot_py,100);
 308   3                          fun_delay(str_cod.py1kqkh,del_ms);
 309   3                          break;
 310   3                      case tra_h:
 311   3                          fun_motors(mot_py,100);
 312   3                          fun_delay(str_cod.py1kqh,del_ms);
 313   3                          break;
 314   3                  }
 315   2                  break;
 316   2              case tra_z:
 317   2                  switch(str_begin.pywz){
 318   3                      case tra_q:
 319   3                          fun_motors(mot_py,-100);
 320   3                          fun_delay(str_cod.py1qz,del_ms);
 321   3                          break;
 322   3                      case tra_kq:
 323   3                          fun_motors(mot_py,-100);
 324   3                          fun_delay(str_cod.py1kqz,del_ms);
 325   3                          break;
 326   3                      case tra_kh:
 327   3                          fun_motors(mot_py,100);
 328   3                          fun_delay(str_cod.py1zkh,del_ms);
 329   3                          break;
 330   3                      case tra_h:
 331   3                          fun_motors(mot_py,100);
 332   3                          fun_delay(str_cod.py1zh,del_ms);
 333   3                          break;
 334   3                  }
 335   2                  break;
 336   2              case tra_kh:
 337   2                  switch(str_begin.pywz){
 338   3                      case tra_q:
 339   3                          fun_motors(mot_py,-100);
 340   3                          fun_delay(str_cod.py1qkh,del_ms);
 341   3                          break;
 342   3                      case tra_kq:
 343   3                          fun_motors(mot_py,-100);
 344   3                          fun_delay(str_cod.py1kqkh,del_ms);
 345   3                          break;
 346   3                      case tra_z:
 347   3                          fun_motors(mot_py,-100);
 348   3                          fun_delay(str_cod.py1zkh,del_ms);
 349   3                          break;
 350   3                      case tra_h:
 351   3                          fun_motors(mot_py,100);
 352   3                          fun_delay(str_cod.py1khh,del_ms);
 353   3                          break;
 354   3                  }
 355   2                  break;
 356   2              case tra_h://åå¹³ç§»(æœ‰ç”µæœºçš„å‘¢ä¸ªæ–¹å‘)
 357   2                  fun_motors(mot_py,-100);
 358   2                  while(in_hpy==1);
 359   2                  fun_delay(str_cod.py1bz,del_ms);
 360   2                  break;
 361   2              default:
 362   2                  break;
 363   2          }
 364   1          fun_motors(mot_py,0);
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 7   

 365   1          str_begin.pywz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 366   1      }//å¹³ç§»å•æ­¥è¿åŠ¨
 367          void fun_sj1(enum varENU_sjp par_model){
 368   1          if(str_begin.sjwz==par_model)
 369   1             return;
 370   1          switch(par_model){
 371   2              case sjp_1://å‡é™ä½ç½®1(æœ€ä¸Šä½)
 372   2                  fun_motors(mot_sj,100);
 373   2                  def_select(sel_58);
 374   2                  while(in_wz1==1);
 375   2                  fun_delay(str_cod.sj1bzw,del_ms);
 376   2                  break;
 377   2              case sjp_12:
 378   2                  if(par_model>str_begin.sjwz){
 379   3                      fun_motors(mot_sj,-100);
 380   3                      fun_delay(str_cod.sj1zjw,del_ms);
 381   3                  }
 382   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 383   3                      fun_sj1(sjp_2);
 384   3                      fun_motors(mot_sj,100);
 385   3                      fun_delay(str_cod.sj1zjw,del_ms);
 386   3                  }
 387   2                  break;
 388   2              case sjp_2://å‡é™ä½ç½®2
 389   2                  fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 390   2                  def_select(sel_58);
 391   2                  while(in_wz2==1);
 392   2                  fun_delay(str_cod.sj1bzw,del_ms);
 393   2                  break;
 394   2              case sjp_23:
 395   2                  if(par_model>str_begin.sjwz){
 396   3                      fun_sj1(sjp_2);
 397   3                      fun_motors(mot_sj,-100);
 398   3                      fun_delay(str_cod.sj1zjw,del_ms);
 399   3                  }
 400   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 401   3                      fun_sj1(sjp_3);
 402   3                      fun_motors(mot_sj,100);
 403   3                      fun_delay(str_cod.sj1zjw,del_ms);
 404   3                  }
 405   2                  break;
 406   2              case sjp_3://å‡é™ä½ç½®3
 407   2                  fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 408   2                  def_select(sel_58);
 409   2                  while(in_wz3==1);
 410   2                  fun_delay(str_cod.sj1bzw,del_ms);
 411   2                  break;
 412   2              case sjp_34:
 413   2                  if(par_model>str_begin.sjwz){
 414   3                      fun_sj1(sjp_3);
 415   3                      fun_motors(mot_sj,-100);
 416   3                      fun_delay(str_cod.sj1zjw,del_ms);
 417   3                  }
 418   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 419   3                      fun_sj1(sjp_4);
 420   3                      fun_motors(mot_sj,100);
 421   3                      fun_delay(str_cod.sj1zjw,del_ms);
 422   3                  }
 423   2                  break;
 424   2              case sjp_4://å‡é™ä½ç½®4
 425   2                  fun_motors(mot_sj,par_model<str_begin.sjwz?100:-100);
 426   2                  def_select(sel_58);
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 8   

 427   2                  while(in_wz4==1);
 428   2                  fun_delay(str_cod.sj1bzw,del_ms);
 429   2                  break;
 430   2              case sjp_45:
 431   2                  if(par_model>str_begin.sjwz){
 432   3                      fun_sj1(sjp_4);
 433   3                      fun_motors(mot_sj,-100);
 434   3                      fun_delay(str_cod.sj1zjw,del_ms);
 435   3                  }
 436   2                  else{//è¦å»çš„åœ°æ–¹åœ¨ä¸Šé¢ï¼Œå‘ä¸Šèµ°
 437   3                      fun_motors(mot_sj,100);
 438   3                      fun_delay(str_cod.sj1zjw,del_ms);
 439   3                  }
 440   2                  break;
 441   2              case sjp_5://å‡é™ä½ç½®5
 442   2                  fun_motors(mot_sj,-100);
 443   2                  def_select(sel_912);
 444   2                  while(in_wz5==1);
 445   2                  fun_delay(str_cod.sj1bzw,del_ms);
 446   2                  break;
 447   2              default:
 448   2                  break;
 449   2          }
 450   1          fun_motors(mot_sj,0);
 451   1          str_begin.sjwz=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 452   1      }//å‡é™å•æ­¥è¿åŠ¨
 453          void fun_hz1(enum varENU_dir par_model){
 454   1          if(str_begin.hzfx==par_model)
 455   1              return;
 456   1          def_select(sel_912);
 457   1          switch(par_model){
 458   2              case dir_up://å›è½¬è‡³å‰æ–¹
 459   2                  switch(str_begin.hzfx){
 460   3                      case dir_down://ç°åœ¨åœ¨ä¸‹æ–¹
 461   3                          fun_motors(mot_hz,-100);
 462   3                          fun_delay(1,del_s);
 463   3                          while(in_hz==1);
 464   3                          while(in_hz==0);
 465   3                          while(in_hz==1);
 466   3                          fun_delay(str_cod.hz1bz,del_ms);
 467   3                          break;
 468   3                      case dir_left://ç°åœ¨åœ¨å·¦è¾¹
 469   3                          fun_motors(mot_hz,100);
 470   3                          fun_delay(1,del_s);
 471   3                          while(in_hz==1);
 472   3                          fun_delay(str_cod.hz1bz,del_ms);
 473   3                          break;
 474   3                      case dir_right://ç°åœ¨åœ¨å³è¾¹
 475   3                          fun_motors(mot_hz,-100);
 476   3                          fun_delay(1,del_s);
 477   3                          while(in_hz==1);
 478   3                          fun_delay(str_cod.hz1bz,del_ms);
 479   3                          break;
 480   3                      default:
 481   3                          break;
 482   3                  }
 483   2                  break;
 484   2              case dir_down://è¦å»ä¸‹é¢
 485   2                  switch(str_begin.hzfx){
 486   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 487   3                          fun_motors(mot_hz,100);
 488   3                          fun_delay(1,del_s);
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 9   

 489   3                          while(in_hz==1);
 490   3                          while(in_hz==0);
 491   3                          while(in_hz==1);
 492   3                          fun_delay(str_cod.hz1bz,del_ms);
 493   3                          break;
 494   3                      case dir_left://ç°åœ¨åœ¨å·¦é¢
 495   3                          fun_motors(mot_hz,-100);
 496   3                          fun_delay(1,del_s);
 497   3                          while(in_hz==1);
 498   3                          fun_delay(str_cod.hz1bz,del_ms);
 499   3                          break;
 500   3                          break;
 501   3                      case dir_right://ç°åœ¨åœ¨å³é¢
 502   3                          fun_motors(mot_hz,100);
 503   3                          fun_delay(1,del_s);
 504   3                          while(in_hz==1);
 505   3                          fun_delay(str_cod.hz1bz,del_ms);
 506   3                          break;
 507   3                      default:
 508   3                          break;
 509   3                  }
 510   2                  break;
 511   2              case dir_left://è¦å»å·¦è¾¹
 512   2                  switch(str_begin.hzfx){
 513   3                      case dir_up://ç°åœ¨åœ¨ä¸Šé¢
 514   3                          fun_motors(mot_hz,-100);
 515   3                          fun_delay(1,del_s);
 516   3                          while(in_hz==1);
 517   3                          fun_delay(str_cod.hz1bz,del_ms);
 518   3                          break;
 519   3                          break;
 520   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 521   3                          fun_motors(mot_hz,100);
 522   3                          fun_delay(1,del_s);
 523   3                          while(in_hz==1);
 524   3                          fun_delay(str_cod.hz1bz,del_ms);
 525   3                          break;
 526   3                          break;
 527   3                      case dir_right://ç°åœ¨åœ¨å³é¢
 528   3                          fun_motors(mot_hz,-100);
 529   3                          fun_delay(1,del_s);
 530   3                          while(in_hz==1);
 531   3                          while(in_hz==0);
 532   3                          while(in_hz==1);
 533   3                          fun_delay(str_cod.hz1bz,del_ms);
 534   3                          break;
 535   3                      default:
 536   3                          break;
 537   3                  }
 538   2                  break;
 539   2              case dir_right://è¦å»å³é¢
 540   2                  switch(str_begin.hzfx){
 541   3                      case dir_up://ç°åœ¨åœ¨å‰é¢
 542   3                          fun_motors(mot_hz,100);
 543   3                          fun_delay(1,del_s);
 544   3                          while(in_hz==1);
 545   3                          fun_delay(str_cod.hz1bz,del_ms);
 546   3                          break;
 547   3                      case dir_down://ç°åœ¨åœ¨ä¸‹é¢
 548   3                          fun_motors(mot_hz,-100);
 549   3                          fun_delay(1,del_s);
 550   3                          while(in_hz==1);
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 10  

 551   3                          fun_delay(str_cod.hz1bz,del_ms);
 552   3                          break;
 553   3                      case dir_left://ç°åœ¨åœ¨å·¦é¢
 554   3                          fun_motors(mot_hz,100);
 555   3                          fun_delay(1,del_s);
 556   3                          while(in_hz==1);
 557   3                          while(in_hz==0);
 558   3                          while(in_hz==1);
 559   3                          fun_delay(str_cod.hz1bz,del_ms);
 560   3                          break;
 561   3                      default:
 562   3                          break;
 563   3                  }
 564   2                  break;
 565   2              default:
 566   2                  break;
 567   2          }
 568   1          fun_motors(mot_hz,0);
 569   1          str_begin.hzfx=par_model;//å­˜å‚¨è¿è¡Œç»“æœ
 570   1      }//å›è½¬å•æ­¥è¿åŠ¨
 571          
 572          //void fun_pyhz2(enum varENU_tra par_pymodel,enum varENU_dir par_hzmodel){//å¹³ç§»å›è½¬åŒæ­¥è¿åŠ¨
 573          //    switch(){
 574          //        ;
 575          //    }
 576          //}
 577          
 578          void fun_dtjp(){
 579   1          uc loc_sdl=str_tfl.gospeed,loc_sdr=str_tfl.gospeed;
 580   1          if(in_ls1&&!in_ls8){
 581   2              loc_sdl*=0.5;
 582   2              loc_sdr*=1.5;
 583   2          }
 584   1          if(in_ls8&&!in_ls1){
 585   2              loc_sdl*=1.5;
 586   2              loc_sdr*=0.5;
 587   2          }
 588   1          if(in_ls2&&!in_ls7){
 589   2              loc_sdl*=0.7;
 590   2              loc_sdr*=1.3;
 591   2          }
 592   1          if(in_ls7&&!in_ls2){
 593   2              loc_sdl*=1.3;
 594   2              loc_sdr*=0.7;
 595   2          }
 596   1          if(in_ls3&&!in_ls6){
 597   2              loc_sdl*=0.9;
 598   2              loc_sdr*=1.1;
 599   2          }
 600   1          if(in_ls6&&!in_ls3){
 601   2              loc_sdl*=1.1;
 602   2              loc_sdr*=0.9;
 603   2          }
 604   1          fun_motors(mot_r,loc_sdl);
 605   1          fun_motors(mot_l,loc_sdr);
 606   1      }//åŠ¨æ€çº å
 607          void fun_jtjp(){
 608   1          while(1){
 609   2              if((!in_ls1&&!in_ls2&&in_ls4&&in_ls5&&!in_ls7&&!in_ls8)&&((in_ls3&&in_ls6)||(!in_ls3&&!in_ls6))){
 610   3                  fun_delay(10,del_ms);
 611   3                  fun_motors(mot_rl,0);
 612   3                  return;
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 11  

 613   3              }
 614   2              if(in_ls2||in_ls1){
 615   3                  fun_motors(mot_l,16);
 616   3                  fun_motors(mot_r,-16);
 617   3              }
 618   2              else if(in_ls7||in_ls8){
 619   3                  fun_motors(mot_l,-16);
 620   3                  fun_motors(mot_r,16);
 621   3              }
 622   2              else{
 623   3                  if(!in_ls4){
 624   4                      fun_motors(mot_l,-12);
 625   4                      fun_motors(mot_r,12);
 626   4                  }
 627   3                  else if(!in_ls5){
 628   4                      fun_motors(mot_l,12);
 629   4                      fun_motors(mot_r,-12);
 630   4                  }
 631   3                  else{
 632   4                      if(in_ls6&&!in_ls3){
 633   5                          fun_motors(mot_l,-8);
 634   5                          fun_motors(mot_r,8);
 635   5                      }
 636   4                      if(in_ls3&&!in_ls6){
 637   5                          fun_motors(mot_l,8);
 638   5                          fun_motors(mot_r,-8);
 639   5                      }
 640   4                  }
 641   3              }
 642   2          }
 643   1      }//é™æ€çº å
 644          void fun_timermove(){
 645   1          static uc loc_con=0;//éœ€è¦åˆ†æ­¥åšçš„åŠ¨ä½œéœ€è¦ç”¨åˆ°æ­¤é™æ€ç§æœ‰åˆ†æ­¥æ ‡å¿—ä½
 646   1          switch(*str_tfl.run){//é€‰æ‹©è¿è¡Œæ–¹å¼
 647   2              case def_end://è¿è¡Œç»“æŸ
 648   2                  fun_motors(mot_rl,0);//å†æ¬¡åœæ­¢ç”µæœºè¿åŠ¨
 649   2                  str_tfl.doing=tf_false;//ç§»åŠ¨ç»“æŸ
 650   2                  memset(str_tfl.step,0,sizeof(str_tfl.step));//æ¸…ç©ºstepæ•°ç»„
 651   2                  str_tfl.run=str_tfl.step;//æŒ‡é’ˆæŒ‡å‘stepçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
 652   2                  break;
 653   2              case tfl_line://è¿è¡Œå·¡çº¿
 654   2                  if(*(str_tfl.run+1)){//å¦‚æœå‚æ•°ä¸ºé0æ•°
 655   3                      if((in_ls1||in_ls8)&&(in_ls2&&in_ls3&&in_ls4&&in_ls5&in_ls6&&in_ls7)){//å¦‚æœä¸­é—´6ä¸ªç
             -¯å…¨äº®,å·¦å³äº®ä»»æ„ä¸€ä¸ª
 656   4                          str_tfl.online=tf_ture;//æ ‡å¿—ä½è®°å½•åœ¨çº¿
 657   4                          //fun_motors(mot_rl,gospeed);//æŒ‰ç…§å¸¸è§„é€Ÿåº¦è¿‡çº¿
 658   4                      }
 659   3                      else if(str_tfl.online==tf_ture){//å¦‚æœæ ‡å¿—ä½è®°å½•åœ¨çº¿,è€Œä¸”ä¸ç¬¦åˆåœ¨çº¿ç‰¹å¾
 660   4                          str_tfl.online=tf_false;//æ ‡å¿—ä½è®°å½•ä¸åœ¨çº¿
 661   4                          (*(str_tfl.run+1))--;//å‚æ•°å€¼å‡1,è®°å½•å·²ç»èµ°äº†ä¸€æ¡çº¿
 662   4                      }
 663   3                  }
 664   2                  else{//å¦‚æœçº¿èµ°å®Œäº†
 665   3                      str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 666   3                      fun_motors(mot_rl,0);//åœæ­¢ç”µæœºè¿åŠ¨
 667   3                  }
 668   2                  break;
 669   2              case tfl_turn://è¿è¡Œè½¬å¼¯
 670   2                  switch(loc_con){//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½
 671   3                      case 0://ç¬¬ä¸€æ­¥
 672   3                          switch(*(str_tfl.run+1)){//è·å–å‚æ•°
 673   4                              case tur_r90://å³è½¬90
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 12  

 674   4                                  fun_motors(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
 675   4                                  fun_motors(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
 676   4                                  str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
 677   4                                  break;
 678   4                              case tur_l90://å·¦è½¬90
 679   4                                  fun_motors(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
 680   4                                  fun_motors(mot_r,str_tfl.turnspeed);//å³è½®å‘å‰
 681   4                                  str_tfl.delay=var_timer+str_cod.turn90;//è®¡æ—¶
 682   4                                  break;
 683   4                              case tur_r180://å³è½¬180
 684   4                                  fun_motors(mot_l,str_tfl.turnspeed);//å·¦è½®å‘å‰
 685   4                                  fun_motors(mot_r,-str_tfl.turnspeed);//å³è½®å‘å
 686   4                                  str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
 687   4                                  break;
 688   4                              case tur_l180://å·¦è½¬180
 689   4                                  fun_motors(mot_l,-str_tfl.turnspeed);//å·¦è½®å‘å
 690   4                                  fun_motors(mot_r,str_tfl.turnspeed);//å·¦è½®å‘å‰
 691   4                                  str_tfl.delay=var_timer+str_cod.turn180;//è®¡æ—¶
 692   4                                  break;
 693   4                          }
 694   3                          loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 695   3                          break;
 696   3                      case 1://ç¬¬äºŒæ­¥
 697   3                          if(str_tfl.delay>=var_timer)//è®¡æ—¶æ—¶é—´åˆ°
 698   3                              loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 699   3                          break;
 700   3                      case 2://ç¬¬ä¸‰æ­¥
 701   3                          if(in_ls4&&in_ls5){//å¦‚æœä¸­é—´ä¸¤ä¸ªç¯äº®
 702   4                              fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
 703   4                              str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 704   4                              str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
 705   4                              loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
 706   4                          }
 707   3                          break;
 708   3                  }
 709   2                  break;
 710   2              case tfl_cache://è¿è¡Œå‰å†²
 711   2                  switch(loc_con){
 712   3                      case 0://ç¬¬ä¸€æ­¥
 713   3                          str_tfl.delay=var_timer+(*(str_tfl.run+1)*10);//å»¶æ—¶æ—¶é—´(æ¯«ç§’)ä¸ºå‚æ•°çš„10å€
 714   3                          loc_con++;//æ‰§è¡Œä¸‹ä¸€æ­¥
 715   3                          break;
 716   3                      case 1://ç¬¬äºŒæ­¥
 717   3                          if(str_tfl.delay<=var_timer){//è®¡æ—¶æ—¶é—´åˆ°
 718   4                              fun_motors(mot_rl,0);//åœæ­¢ç”µæœº
 719   4                              str_tfl.run+=2;//æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ç»„è¿‡ç¨‹
 720   4                              str_tfl.delay=0;//å»¶æ—¶è®¡æ•°å™¨å½’é›¶
 721   4                              loc_con=0;//åˆ†æ­¥è¿è¡Œæ ‡å¿—ä½å½’é›¶
 722   4                          }
 723   3                          break;
 724   3                  }
 725   2                  break;
 726   2              case tfl_start://è¿è¡Œå¸¦åŠ é€Ÿçš„å‰å†²
 727   2      
 728   2                  break;
 729   2              case tfl_end://è¿è¡Œå¸¦å‡é€Ÿçš„å‰å†²
 730   2      
 731   2                  break;
 732   2          }
 733   1      }//å®šæ—¶å™¨ç§»åŠ¨
 734          void fun_stope2prom(){
 735   1          IAP_CONTR = 0;                  //å…³é—­IAPåŠŸèƒ½
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 13  

 736   1          IAP_CMD = 0;                    //æ¸…é™¤å‘½ä»¤
 737   1          IAP_TRIG = 0;                   //æ¸…é™¤è§¦å‘å¯„å­˜å™¨
 738   1          IAP_ADDRH = 0x80;               //æ•°æ®æŒ‡é’ˆæŒ‡å‘éEEPROMåŒº
 739   1          IAP_ADDRL = 0;                  //æ¸…é™¤IAPåœ°å€
 740   1      }//å…³é—­EEPROMåŠŸèƒ½(IapIdle)
 741          uc fun_reade2prom(ui par_add){
 742   1          uc loc_dat;                     //æ•°æ®ç¼“å†²åŒº
 743   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
 744   1          IAP_CMD = 1;                    //è®¾ç½®EEPROMè¯»å‘½ä»¤
 745   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
 746   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
 747   1          IAP_TRIG = 0x5a;                //è§¦å‘
 748   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
 749   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
 750   1          loc_dat = IAP_DATA;             //è¯»å‡ºEEPROMä¸­çš„æ•°æ®
 751   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
 752   1          return loc_dat;                 //è¿”å›è¯»å–ç»“æœ
 753   1      }//è¯»å–EEPROMæ•°æ®
 754          void fun_writee2prom(ui par_add,uc par_dat){
 755   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
 756   1          IAP_CMD = 2;                    //è®¾ç½®EEPROMå†™å…¥å‘½ä»¤
 757   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
 758   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
 759   1          IAP_DATA = par_dat;             //å†™å…¥æ•°æ®
 760   1          IAP_TRIG = 0x5a;                //è§¦å‘
 761   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
 762   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
 763   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
 764   1      }//å†™EEPROMæ•°æ®
 765          void fun_cleane2prom(ui par_add){
 766   1          IAP_CONTR = 0x83;               //æ‰“å¼€EEPROMåŠŸèƒ½,è®¾ç½®ç­‰å¾…æ—¶é—´
 767   1          IAP_CMD = 3;                    //è®¾ç½®EEPROMæ“¦é™¤å‘½ä»¤
 768   1          IAP_ADDRL = par_add;            //è®¾ç½®EEPROMåœ°å€ä½å…«ä½
 769   1          IAP_ADDRH = par_add >> 8;       //è®¾ç½®EEPROMåœ°å€é«˜å…«ä½
 770   1          IAP_TRIG = 0x5a;                //è§¦å‘
 771   1          IAP_TRIG = 0xa5;                //å†æ¬¡è§¦å‘
 772   1          fun_delay(10,del_us);           //ç¨ç­‰ä¸€ä¼šå„¿
 773   1          fun_stope2prom();               //å…³é—­EEPROMåŠŸèƒ½
 774   1      }//æ¸…é™¤EEPROMæ•°æ®
 775          void fun_calibration(){
 776   1          // fun_sj1(sjp_1);//å‡åˆ°æœ€ä¸Šä½
 777   1          ul loc_time;
 778   1          fun_py1(tra_q);//ç§»åŠ¨åˆ°æœ€å‰ç«¯
 779   1          fun_py1(tra_h);//ç§»åŠ¨åˆ°æœ€åç«¯
 780   1          loc_time=var_timer;
 781   1          fun_py1(tra_q);//ç§»åŠ¨åˆ°å‰ç«¯å¹¶è®¡æ—¶
 782   1          fun_py1(tra_h);//ç§»åŠ¨åˆ°åç«¯
 783   1          loc_time=var_timer-loc_time;
 784   1          loc_time*=0.39;
 785   1          str_cod.py1zh=str_cod.py1qz=loc_time*0.5;
 786   1          str_cod.py1qkh=str_cod.py1kqh=loc_time*0.75;
 787   1          str_cod.py1qkq=str_cod.py1khh=loc_time*0.25;
 788   1          str_cod.py1kqz=str_cod.py1zkh=loc_time*0.25;
 789   1          str_cod.py1kqkh=loc_time*0.5;
 790   1      }//è‡ªåŠ¨æ ¡å‡†å¹³ç§»å‚æ•°
 791          void fun_port(){
 792   1          PCON|=0x80;     //ä½¿èƒ½æ³¢ç‰¹ç‡å€é€Ÿä½SMOD
 793   1          SCON=0x50;      //8ä½æ•°æ®,å¯å˜æ³¢ç‰¹ç‡
 794   1          AUXR|=0x04;     //ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨æ—¶é’Ÿä¸ºFosc,å³1T
 795   1          BRT=0xD9;       //è®¾å®šç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨é‡è£…å€¼
 796   1          AUXR|=0x01;     //ä¸²å£1é€‰æ‹©ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨ä¸ºæ³¢ç‰¹ç‡å‘ç”Ÿå™¨
 797   1          AUXR|=0x10;     //å¯åŠ¨ç‹¬ç«‹æ³¢ç‰¹ç‡å‘ç”Ÿå™¨
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 14  

 798   1          TI=1;           //æ‰“å¼€ä¸²å£ä¼ è¾“åŠŸèƒ½
 799   1      }//ä¸²å£åˆå§‹åŒ–
 800          void fun_test(){
 801   1          fun_sz1(han_j);
 802   1          fun_delay(1,del_s);
 803   1          fun_sz1(han_s);
 804   1          fun_delay(1,del_s);
 805   1          fun_sz1(han_j);
 806   1          fun_delay(1,del_s);
 807   1          fun_sz1(han_s);
 808   1          fun_delay(1,del_s);
 809   1      
 810   1          str_begin.pywz=tra_h;
 811   1          fun_py1(tra_q);
 812   1          fun_delay(1,del_s);
 813   1          fun_py1(tra_h);
 814   1          fun_delay(1,del_s);
 815   1          fun_py1(tra_q);
 816   1          fun_delay(1,del_s);
 817   1          fun_py1(tra_h);
 818   1          fun_delay(1,del_s);
 819   1      
 820   1          fun_sj1(sjp_1);
 821   1          fun_delay(1,del_s);
 822   1          fun_sj1(sjp_2);
 823   1          fun_delay(1,del_s);
 824   1          fun_sj1(sjp_3);
 825   1          fun_delay(1,del_s);
 826   1          fun_sj1(sjp_4);
 827   1          fun_delay(1,del_s);
 828   1          fun_sj1(sjp_5);
 829   1          fun_delay(1,del_s);
 830   1          fun_sj1(sjp_4);
 831   1          fun_delay(1,del_s);
 832   1          fun_sj1(sjp_3);
 833   1          fun_delay(1,del_s);
 834   1          fun_sj1(sjp_2);
 835   1          fun_delay(1,del_s);
 836   1          fun_sj1(sjp_1);
 837   1      
 838   1          str_now.hzfx=str_begin.hzfx;
 839   1          str_begin.hzfx=dir_up;
 840   1          fun_hz1(dir_right);
 841   1          fun_delay(1,del_s);
 842   1          fun_hz1(dir_up);
 843   1          fun_delay(1,del_s);
 844   1          fun_hz1(dir_right);
 845   1          fun_delay(1,del_s);
 846   1          fun_hz1(dir_up);
 847   1          fun_delay(1,del_s);
 848   1          str_begin.hzfx=str_now.hzfx;
 849   1      
 850   1          fun_motors(mot_rl,60);
 851   1          fun_delay(1,del_s);
 852   1          fun_motors(mot_rl,0);
 853   1          fun_delay(1,del_s);
 854   1      
 855   1          fun_motors(mot_rl,-60);
 856   1          fun_delay(1,del_s);
 857   1          fun_motors(mot_rl,0);
 858   1          fun_delay(1,del_s);
 859   1      
C51 COMPILER V9.54   8023                                                                  09/07/2015 15:45:14 PAGE 15  

 860   1          fun_motors(mot_r,40);
 861   1          fun_motors(mot_l,-40);
 862   1          fun_delay(1,del_s);
 863   1          fun_motors(mot_rl,0);
 864   1          fun_delay(1,del_s);
 865   1      
 866   1          fun_motors(mot_r,-40);
 867   1          fun_motors(mot_l,40);
 868   1          fun_delay(1,del_s);
 869   1          fun_motors(mot_rl,0);
 870   1      }//æµ‹è¯•ç¨‹åº
 871          uc fun_min(uc par_num,...){
 872   1          va_list loc_argp;//ä¿å­˜å‚æ•°ç»“æ„
 873   1          uc loc_min=par_num;//ç°åœ¨çš„æœ€å°å€¼å°±æ˜¯ç¬¬ä¸€ä¸ª
 874   1          uc loc_shu;//å½“å‰å‚æ•°
 875   1          va_start(loc_argp,par_num);//loc_argpæŒ‡å‘ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œpar_numæ˜¯æœ€åä¸€ä¸ªç¡®å
             -®šçš„å‚æ•°
 876   1          loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
 877   1          do{
 878   2              if(loc_shu<loc_min)
 879   2                  loc_min=loc_shu;
 880   2              loc_shu=va_arg(loc_argp,uc);//å–å‡ºä¸‹ä¸€ä¸ªå‚æ•°
 881   2          }while(loc_shu!=def_end);
 882   1          va_end(loc_argp);//ç»“æŸ
 883   1          return loc_min;//é€€å‡º
 884   1      }//æ±‚æœ€å°å€¼
 885          void fun_coordinate(){
 886   1          
 887   1      }//è‡ªåŠ¨å·¡çº¿ä¹‹åæ ‡


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3710    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    115    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5      32
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
